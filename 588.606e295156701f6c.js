"use strict";var sP=Object.defineProperty,nP=(et,J,N)=>J in et?sP(et,J,{enumerable:!0,configurable:!0,writable:!0,value:N}):et[J]=N,R=(et,J,N)=>(nP(et,"symbol"!=typeof J?J+"":J,N),N),gb=(et,J,N)=>{if(!J.has(et))throw TypeError("Cannot "+N)},r=(et,J,N)=>(gb(et,J,"read from private field"),N?N.call(et):J.get(et)),f=(et,J,N)=>{if(J.has(et))throw TypeError("Cannot add the same private member more than once");J instanceof WeakSet?J.add(et):J.set(et,N)},m=(et,J,N,q)=>(gb(et,J,"write to private field"),q?q.call(et,N):J.set(et,N),N),ee=(et,J,N,q)=>({set _(Ri){m(et,J,Ri,N)},get _(){return r(et,J,q)}}),p=(et,J,N)=>(gb(et,J,"access private method"),N);(self.webpackChunkproject=self.webpackChunkproject||[]).push([[588],{564:(et,J,N)=>{N.d(J,{t:()=>q});const q=[{filePath:"",text:"",imageUrl:"./assets/images/empty-doc.png"},{filePath:"[21577285 - International Journal of Athletic Therapy and Training] High-Volt Pulsed Current_ Treatment of Skin Wounds and Musculoskeletal Injuries.pdf",text:"Draper, D.O., Knight, K.L., and Rigby, J.H. (2012) \u2018High-Volt Pulsed Current: Treatment of Skin Wounds and Musculoskeletal Injuries\u2019, *International Journal of Athletic Therapy and Training*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"A critical review of the evidence for a pain-spasm-pain cycle in spinal disorders.pdf",text:"Roland, M.O. (1986) \u2018A critical review of the evidence for a pain-spasm-pain cycle in spinal disorders\u2019, *Clinical Biomechanics*,",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"a muscle contusion injury model biomechanics physiology and histology.pdf",text:"J.J., Jokl, P., Heinen, G.T., Connell, M.D., and Panjabi, M.M. (1994) \u2018A Muscle Contusion Injury Model: Biomechanics, Physiology, and Histology\u2019, *The American Journal of Sports Medicine*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"a pain in the back or is it something else.pdf",text:"Quiney, L. (2020) \u2018A pain in the back\u2026 or is it something else?\u2019, *Equine Health*, 52(2), pp. 16-19.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"A preliminary model study of the equine back including activity of longissimus.pdf",text:"Peham, C., Licka, T., Girtler, D., and Scheidl, M. (2001) \u2018A Preliminary Model Study of the Equine Back Including Activity of the Longissimus Dorsi Muscle\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Alterations in thoraculumbosacral movemeny when pain causing lameness has been improved by diagnostic analgesia.pdf",text:"Greve, L., Dyson, S., and Pfau, T. (2017) \u2018Alterations in thoracolumbosacral movement when pain causing lameness has been improved by diagnostic analgesia\u2019, *The Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"an introduction to back pathology in the horse.pdf",text:"Henson, F.M.D. (2020) \u2018An introduction to back pathology in the horse\u2019, *UK-VET Equine*, 4(4), pp. 112-119.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Anatomy of the Thoracolumbar Vertebral region.pdf",text:"Haussler, K.K. (1999) \u2018Anatomy of the Thoracolumbar Vertebral Region\u2019, *Veterinary Clinics of North America: Equine Practice*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Assessment of back pain in horses.pdf",text:"Cauvin, E. (1997) \u2018Assessment of back pain in horses\u2019, *In Practice*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"back and pelvis.pdf",text:"Haussler, K.K., and Jeffcott, L.B. (2010) \u2018Back and pelvis\u2019, in A. Barr and J. Tack (eds) *Equine Veterinary Journal Supplement*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Back pain a significant cause of poor performance in show jumping horses.pdf",text:"Sardari, K. (2008) \u2018Back pain: A significant cause of poor performance in show jumping horses\u2019, *Iranian Journal of Veterinary Surgery*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Back pain in horses Epaxial Musculature.pdf",text:"McGowan, C., Stubbs, N., Hodges, P., and Jeffcott, L. (2007) \u2018Back pain in horses: Epaxial Musculature\u2019, *Rural Industries Research and Development Corporation*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Back pain in horses.pdf",text:"Henson, F.M.D., and Jeffcott, L.B. (2010) \u2018Back Pain in Horses: A Comprehensive Study\u2019, *Veterinary Clinics of North America: Equine Practice*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Back problems in the equine athlete 2 Range of con.pdf",text:"Jeffcott, L.B. (1993) \u2018Back problems in the equine athlete 2: Range of conditions and lines of therapy\u2019, *Pferdeheilkunde Equine Medicine*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Biology and management of muscle disorders and diseases.pdf",text:"Martens, A. (2011) \u2018Biology and Management of Muscle Disorders and Diseases\u2019, in *Veterinary Medicine: A Textbook of the Diseases of Cattle, Horses, Sheep, Pigs and Goats*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Chiropractic Evaluation and Management.pdf",text:"Haussler, K.K. (1999) \u2018Chiropractic Evaluation and Management\u2019, *Veterinary Clinics of North America: Equine Practice*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Clinical investigation of back disorders in horse a retrospective study.pdf",text:"Mayaki, A.M., Intan-Shameha, A.R., Noraniza, M.A., Mazlina, M., Adamu, L., and Abdullah, R. (2019) \u2018Clinical investigation of back disorders in horses: A retrospective study (2002-2017)\u2019, *Veterinary World*",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Clinical perspectives on equine back kinematics.pdf",text:"Henson, F.M.D., and Jeffcott, L.B. (2010) \u2018Clinical Perspectives on Equine Back Kinematics\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Clinical utility of ozone therapy for musculoskeletal disorders.pdf",text:"Seyam, O., Smith, N.L., Reid, I., Gandhi, J., Jiang, W., and Khan, S.A. (2018) \u2018Clinical utility of ozone therapy for musculoskeletal disorders\u2019, *Medical Gas Research*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Current state of myopathies affecting athletic horses.pdf",text:"McKenzie, E. (2017) \u2018Current state of myopathies affecting athletic horses\u2019, *Comparative Exercise Physiology*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Diagnosis and management of sacroilliac joint injuries.pdf",text:"Dyson, S.J. (2004) \u2018Diagnosis and Management of Sacroiliac Joint Injuries in Horses\u2019, *Clinical Techniques in Equine Practice*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Effects of a bio-electromagnetic energy regualtion blanket on thoracolumbar epaxial muscle pain in horses.pdf",text:"Burch, R.M., Allen, A.K., and Williams, G.M. (2015) \u2018Effects of a Bio-Electromagnetic Energy Regulation Blanket on Thoracolumbar Epaxial Muscle Pain in Horses\u2019, *Journal of Equine Veterinary Science*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Electrophysical therapies for the equine athlete.pdf",text:"Dyson, S.J., and Pilsworth, R.C. (2004) \u2018Electrophysical Therapies for the Equine Athlete\u2019, *Equine Veterinary Education*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Epaxial musculature motor control and its relationship with back pain in the horse.pdf",text:"Stubbs, N.C. (2011) \u2018Epaxial Musculature, Motor Control, and Its Relationship With Back Pain in the Horse: Objective Clinical Physical Therapy, Pathological, and Imaging Studies\u2019, *AAEP Proceedings*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Epigetic Alterations in Sports Related Injuries.pdf",text:"Jones, L.C., and Rivera, C. (2016) \u2018Epigenetic Alterations in Sports-Related Injuries: Implications for Rehabilitation\u2019, *Journal of Orthopaedic Research*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Equine back disorders 1  Clinical presentation  investigation and diagnosis.pdf",text:"Jeffcott, L.B. (1980) \u2018Equine Back Disorders: 1. Clinical Presentation, Investigation and Diagnosis\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Equine back rehad.pdf",text:"Bystrom, A. (2017) \u2018Equine Back Rehabilitation: Techniques and Therapies for Enhancing Recovery\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Equine cervical pain and dysfunction pathalogy diagnosis and treatment.pdf",text:"Adams, S.B., and Fessler, J.F. (1998) \u2018Equine Cervical Pain and Dysfunction: Pathology, Diagnosis, and Treatment\u2019, *Veterinary Clinics of North America: Equine Practice*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Evaluation of the force acting on the back of the horse with an English.pdf",text:"Winkelmayr, B., Peham, C., Fruhwirth, B., Licka, T., and Scheidl, M. (2006) \u2018Evaluation of the Force Acting on the Back of the Horse with an English Saddle and a Side Saddle at Walk, Trot, and Canter\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Functional Electrical Stimulation and teh effects on equine multifidil asymmetry.pdf",text:"McGowan, C.M., Goff, L., and Stubbs, N.C. (2012) \u2018Functional Electrical Stimulation and the Effects on Equine Multifidil Asymmetry\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"historical perspective and clnical indications.pdf",text:"Ryan, S.D. (2009) \u2018Historical Perspective and Clinical Indications for Chiropractic in Equine Practice\u2019, *Journal of Equine Veterinary Science*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Introduction to Equine biologic and regenrative therapies.pdf",text:"Ross, M.W., and Dyson, S.J. (2015) \u2018Introduction to Equine Biologic and Regenerative Therapies\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"investigating back pain in horses.pdf",text:"Gerdes, C. (2019) \u2018Investigating Back Pain in Horses\u2019, *Veterinary Ireland Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Investigation of pelvic problems in horses.pdf",text:"Dyson, S.J. (2009) \u2018Investigation of Pelvic Problems in Horses\u2019, *Equine Veterinary Education*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Kinematics of the equine thoracolumbar spine.pdf`",text:"Gomez Alvarez, C.B., Rhodin, M., Bobbert, M.F., and Weeren, P.R. (2007) \u2018Kinematics of the Equine Thoracolumbar Spine: Are There Implications for Equine Back Pain?\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"kissing spines diagnosis and treatments.pdf",text:"Jacklin, B. (2014) \u2018Kissing Spines: Diagnosis and Treatments\u2019, *Equine Health*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Masterbinder.pdf",text:" A compilation.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Multimodal therapy for treatment of euine back pain a report of 15 cases.pdf",text:"Melo, U.P., and Ferreira, C. (2021) \u2018Multimodal Therapy for Treatment of Equine Back Pain: A Report of 15 Cases\u2019, *Brazilian Journal of Veterinary Medicine*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Muscle disorders of equine athletes.pdf",text:"McGowan, C.M., and Goff, L. (2012) \u2018Muscle Disorders of Equine Athletes\u2019, *Veterinary Clinics of North America: Equine Practice*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Muscle injuries biology and treatment.pdf",text:"McGowan, C.M. (2008) \u2018Muscle Injuries: Biology and Treatment\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Muscle injuries.pdf",text:"Crisco, J.J., Heinen, G.T., and Jokl, P. (1997) \u2018Muscle Injuries in Equine Athletes\u2019, *Journal of Sports Medicine*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Muscle Injury Pathophysiology Diagnosis and Treatment.pdf",text:"Soderberg, G.L. (2010) \u2018Muscle Injury: Pathophysiology, Diagnosis, and Treatment\u2019, *Journal of Rehabilitation Research and Development*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Neck back and pelvic pain in horses.pdf",text:"Dyson, S.J. (2003) \u2018Neck, Back, and Pelvic Pain in Horses\u2019, *Equine Veterinary Education*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Osseous Spinal Patholog.pdf",text:"Haussler, K.K. (2008) \u2018Osseous Spinal Pathology in Equine Athletes: Diagnosis and Management\u2019, *Veterinary Clinics of North America: Equine Practice*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Physical Examination of Horses with back pain.pdf",text:"Martin, B.B., and Klide, A.M. (1999) \u2018Physical Examination of Horses with Back Pain\u2019, *Veterinary Clinics of North America: Equine Practice*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Poor performance in warmblood horse cause and diagnostic approach.pdf",text:"Verwilghen, D., and Rombauts, L. (2016) \u2018Poor Performance in Warmblood Horses: Causes and Diagnostic Approach\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Range of back movement at trot in horses without back pain.pdf",text:"Licka, T., Peham, C., and Zohmann, E. (2001) \u2018Range of Back Movement at Trot in Horses Without Back Pain\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Sacroiliac Joint Morphology  Influence of Age  Bodyweight and Previous Back Pain.pdf",text:"Audig\xe9, L., and Haussler, K.K. (2010) \u2018Sacroiliac Joint Morphology: Influence of Age, Bodyweight, and Previous Back Pain\u2019, *Journal of Equine Veterinary Science*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"spinal biomechanics and functional anatomy.pdf",text:"Jeffcott, L.B. (1980) \u2018Spinal Biomechanics and Functional Anatomy in the Horse\u2019, *Equine Veterinary Journal*.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"spinal biomechanics and functional anatomy.pdf",text:"Carter, S.L. and Norton, B.J. (2018) \u2018Spinal Biomechanics and Functional Anatomy\u2019, Veterinary Clinics of North America: Equine Practice,.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Structural and biomechanical aspects of equine sacroilliac joint function and their relationship to clnical disease.pdf",text:"Rogers, T.L. and Graham, E.M. (2019) \u2018Structural and Biomechanical Aspects of Equine Sacroiliac Joint Function and Their Relationship to Clinical Disease\u2019, Journal of Biomechanics.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"The biomechanical interaction between vertebral column and limbs in the horse - a kinematical study.pdf",text:"Green, S.J. (2016) \u2018The Biomechanical Interaction Between Vertebral Column and Limbs in the Horse: A Kinematical Study\u2019, Equine Veterinary Journal.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"The biomechanics of Euine locomotion.pdf",text:"Gregory, B. (2017) \u2018The Biomechanics of Equine Locomotion\u2019, Journal of Equine Veterinary Science.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"The Diagnosis of Diseases of the Horse s Back.pdf",text:"Harrison, P.R. (2020) \u2018The Diagnosis of Diseases of the Horse\u2019s Back\u2019, Equine Veterinary Education.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"The effect of anabolic steroids and corticosteroids on healing of muscle contusion injury.pdf",text:"Ferguson, J.M. (2018) \u2018The Effect of Anabolic Steroids and Corticosteroids on Healing of Muscle Contusion Injury\u2019, Journal of Equine Veterinary Science.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"The effect of pulsed electromagnetic field therapy on surface temprature of horses backs.pdf",text:"Rindler, N., Biermann, N.M., Westermann, S., and Buchner, H.H.F. (2014) \u2018The Effect of Pulsed Electromagnetic Field Therapy on Surface Temperature of Horses\u2019 Backs\u2019, Wiener Tier\xe4rztliche Monatsschrift \u2013 Veterinary Medicine Austria.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"The use of ozone theraphy in veternirary science medicine.pdf",text:"Lawrence, T.M. (2019) \u2018The Use of Ozone Therapy in Veterinary Science Medicine\u2019, Veterinary Clinics of North America: Equine Practice.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Therapuetic modality rehabilitation of teh injured athlete.pdf",text:"Jackson, L.P. (2021) \u2018Therapeutic Modality Rehabilitation of the Injured Athlete\u2019, Journal of Equine Veterinary Science.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Therapuetic use of ultra sound lasers and electromagnetics.pdf",text:"Ball, M.A. (2016) \u2018Therapeutic Use of Ultrasound, Lasers, and Electromagnetics\u2019, Veterinary Clinics of North America: Equine Practice.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Thermographic Diagnsotics in Equine Back Pain.pdf",text:"Harper, G.S. and Miller, R.W. (2017) \u2018Thermographic Diagnostics in Equine Back Pain\u2019, Equine Veterinary Journal.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Thermography and ultrsonography in back pain diagnosis of equine athletes.pdf",text:"Fonseca, B.P.A., Alves, A.L.G., Nicoletti, J.L.M., Thomassian, A., Hussni, C.A., and Mikail, S. (2006) \u2018Thermography and Ultrasonography in Back Pain Diagnosis of Equine Athletes\u2019, Journal of Equine Veterinary Science.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Treatment of equine back pain by Marcus J Head - British Veterinary Nursing AssociationBritish Veterinary Nursing Association.pdf",text:"Head, M.J. (2022) \u2018Treatment of Equine Back Pain\u2019, Veterinary Nursing Journal.",imageUrl:"./assets/images/empty-pdf.png"},{filePath:"Two multicenter surveys on euine back-pain 10 years apart.pdf",text:"Dyson, S.J., and Murray, R.C. (2017) \u2018Two Multicenter Surveys on Equine Back-Pain 10 Years Apart\u2019, Equine Veterinary Journal.",imageUrl:"./assets/images/empty-pdf.png"}]},7834:(et,J,N)=>{N.d(J,{r:()=>ti});var q=N(4650),Ri=N(5643),nt=N(4956),rt=N(6895);let ti=(()=>{class ei{constructor(vs){this.activeModal=vs}close(){this.activeModal.close()}}return ei.\u0275fac=function(vs){return new(vs||ei)(q.Y36(Ri.Kz))},ei.\u0275cmp=q.Xpm({type:ei,selectors:[["app-pdf-viewer"]],inputs:{pdfSrc:"pdfSrc",fileName:"fileName"},decls:7,vars:9,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title",3,"title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[2,"width","100%","height","500px",3,"src","render-text","original-size"]],template:function(vs,ws){1&vs&&(q.TgZ(0,"div",0)(1,"h4",1),q._uU(2),q.ALo(3,"slice"),q.qZA(),q.TgZ(4,"button",2),q.NdJ("click",function(){return ws.close()}),q.qZA()(),q.TgZ(5,"div",3),q._UZ(6,"pdf-viewer",4),q.qZA()),2&vs&&(q.xp6(1),q.Q6J("title",ws.fileName),q.xp6(1),q.hij(" ",ws.fileName.length>35?q.Dn7(3,5,ws.fileName,0,35)+"...":ws.fileName," "),q.xp6(4),q.Q6J("src",ws.pdfSrc)("render-text",!0)("original-size",!1))},dependencies:[nt.rQ,rt.OU]}),ei})()},2271:(et,J,N)=>{N.d(J,{m:()=>rt});var q=N(4956),Ri=N(6895),nt=N(4650);let rt=(()=>{class ti{}return ti.\u0275fac=function(st){return new(st||ti)},ti.\u0275mod=nt.oAB({type:ti}),ti.\u0275inj=nt.cJS({imports:[Ri.ez,q.xC]}),ti})()},4956:(et,H,N)=>{var Ia,kg,rh,mb,ah,Un,zn,ri,Ui,qt,lf,Wn,Lt,Xt,Ms,Cl,Ls,Sl,Da,Rg,ks,Pl,hf,zy,oh,bb,Rs,Tl,Gn,ou,$n,lu,lh,_b,qn,hu,Kn,Xn,He,Yn,hh,ch,cf,Wy,df,Gy,uf,$y,Oa,Ig,ff,qy,dh,Ab,uh,Jn,Qn,pf,Ky,gf,Xy,mf,Yy,bf,fh,_f,xe,ph,yb,kt,Is,gh,Rt,Af,Zy,Fa,fe,Et,Nt,Na,zi,Ba,Ve,Ds,Ha,tr,ai,je,er,mh,bh,Va,_h,oi,Os,ja,Fs,li,yf,Ns,Ah,Bs,ir,yh,vh,It,Q,Wi,sr,wh,Eh,Hs,hi,Gi,xh,Ua,Dg,Ch,vb,vf,Jy,wf,Qy,za,Og,Ef,tv,xf,ev,Cf,iv,Sh,wb,Sf,sv,Ph,Eb,Th,xb,Pf,nv,Bt,ie,ci,Ln,Tf,rv,Mf,av,Mh,Cb,Lf,ov,nr,cu,Lh,Sb,Dt,di,Ue,ui,pe,Wa,fi,ae,$i,rr,pi,Ga,Fg,$a,Ng,ar,We,ht,qa,or,Ht,lr,Vs,kh,hr,js,Rh,cr,qi,gi,Ka,Xa,Ce,Ih,Rf,Dh,Pb,Oh,Tb,Fh,Mb,If,lv,Df,hv,Nh,Lb,Bh,kb,Hh,Rb,Of,cv,Vh,Ib,Ff,dv,Nf,uv,Bf,fv,jh,Db,dr,du,ur,fr,Ot,Hf,pv,Uh,Ya,zh,Ob,Wh,Fb,Gh,$h,Vf,gv,jf,mv,Za,Bg,pr,qh,Kh,Xh,Yh,Ja,Us,it,Qa,to,Zh,Nb,zs,oe,Jh,Qh,gr,Ki,tc,ec,mr,eo,io,Ws,so,ic,no,br,sc,nc,_r,Ar,Gs,ro,Uf,bv,zf,_v,rc,Bb,ao,Hg,Wf,Av,Gf,yv,$f,$s,Xi,qs,Ml,oo,Vg,yr,qf,Kf,vr,wr,hb,lo,jg,ho,Ug,Yi,mi,co,uo,bi,Er,uu,$e,ac,Hb,Ks,Xs,xr,Cr,po,go,oc,Vb,Zi,Ea,Xf,vv,Yf,wv,mo,Zf,Jf,bo,Sr,dt,Ji,_o,lc,hc,Ao,Qi,qe,ts,cc,es,dc,Pr,Tr,yo,zg,uc,jb,Qf,Ev,tp,xv,ep,Cv,ip,Sv,vo,Wg,wo,Gg,fc,Ub,pc,gc,mc,bc,_c,Ac,yc,zb,vc,Mr,Lr,sp,Pv,wc,Wb,Ke,ge,Ec,kr,me,Eo,np,Tv,rp,Mv,ap,Lv,xo,$g,Co,qg,So,Kg,op,kv,xc,Gb,lp,Rv,Cc,Ys,Xe,hp,Iv,Po,Xg,cp,Dv,dp,Ov,Sc,$b,Pc,To,_i,is,Mo,Lo,Ai,X,Rr,Ir,Tc,Mc,ko,Ro,Zs,Lc,up,fp,kc,qb,Do,Dr,ss,Rc,be,Ic,ft,Or,fu,Fr,pu,pp,Fv,Dc,Oc,Ye,Nr,Oo,Ct,Fc,Fo,Nc,Bc,Ze,No,Hc,Kb,Vc,Xb,gp,Nv,ns,xa,mp,Bv,yi,kn,Bo,jc,Js,Br,Ho,Se,Uc,zc,Hr,Je,Zt,_e,Vo,Vr,St,jo,vi,Wc,Gc,Yb,$c,Zb,bp,Hv,_p,Vv,Ap,jv,qc,Jb,jr,gu,Qs,Ll,yp,Uv,Uo,Yg,Ur,mu,vp,zv,wp,Wv,Ep,Gv,xp,$v,zr,Wr,wi,as,Pe,Gr,$r,qr,os,zo,Kr,Xr,tn,Cp,qv,Sp,Kv,Pp,Xv,Tp,Yv,Kc,Qb,Mp,Zv,Xc,t_,Lp,Jv,kp,Qv,Rp,t0,Ip,e0,Dp,i0,ls,Ca,Yc,e_,Zc,i_,Jc,s_,Wo,Zg,Go,Jg,en,kl,Qc,n_,$o,Qg,Op,s0,td,r_,Fp,n0,Np,r0,ed,a_,qo,tm,Yr,bu,gt,jt,sn,hs,nn,Ko,Ei,cs,xi,Te,id,Zr,_u,Jr,Au,Xo,em,sd,o_,Bp,a0,nd,l_,rd,h_,Yo,im,Hp,o0,Qr,Zo,Ci,rn,ds,Ae,an,Jo,Qo,Jt,us,F,on,Vp,l0,ad,c_,od,d_,ld,u_,tl,sm,Si,hd,Pt,ln,cd,f_,dd,p_,jp,h0,hn,ta,cn,el,ea,Ft,il,ia,Up,c0,ud,g_,fd,m_,zp,d0,Wp,u0,pd,b_,Gp,f0,$p,p0,sl,nm,sa,yu,dn,Rl,qp,g0,gd,__,md,A_,nl,rm,Kp,m0,bd,y_,_d,v_,na,vu,Xp,b0,Ad,un,yd,w_,fb,rl,vd,al,ol,le,Qp,_0,tg,A0,ig,y0,sg,v0,ng,w0,rg,E0,wd,E_,fn,Qe,ys,hl,am,cl,om,ra,wu,dl,lm,Ed,x_,ag,x0,og,C0,xd,C_,lg,S0,hg,P0,Cd,Sd,Pd,Td,ul,pn,pb,Pi,Me,Md,S_,Ld,P_,ps,Le,gs,mn,fl,hm,kd,T_,bn,Id,Dd,aa,Ti,he,_n,cg,T0,dg,M0,ug,L0,oa,Fd,la,Nd,An,yn,Bd,ha,pl,gl,ms,ca,vn,wn,Il,ml,cm,da,Eu,Hd,M_,Vd,L_,jd,k_,Ud,R_,zd,I_,fg,k0,pg,R0,Wd,D_,Mi,ua,Gd,fa,pa,$d,Qt,bs,bl,Tt,ke,gg,I0,_l,dm,qd,O_,mg,D0,ga,xu,_s,ma,Kd,F_,En,Xd,Yd,Li,ye,ba,Zd,Jd,Qd,tu,eu,iu,xn,_a,Cn,Aa,Al,Sn,yl,su,vl,ya,Pn,wl,bg,O0,_g,F0,Ag,N0,va,Cu,El,um,yg,B0,nu,N_,vg,H0,ki,Rn,ru,B_,wg,V0,Eg,j0,xg,U0,au,H_,Cg,z0,xl,fm;N.d(H,{rQ:()=>jn,xC:()=>Ra});var q={};N.r(q),N.d(q,{AbortException:()=>$E,AnnotationEditorLayer:()=>qE,AnnotationEditorParamsType:()=>KE,AnnotationEditorType:()=>BA,AnnotationEditorUIManager:()=>XE,AnnotationLayer:()=>YE,AnnotationMode:()=>ZE,CMapCompressionType:()=>JE,ColorPicker:()=>QE,DOMSVGFactory:()=>tx,DrawLayer:()=>ex,FeatureTest:()=>ix,GlobalWorkerOptions:()=>HA,ImageKind:()=>sx,InvalidPDFException:()=>nx,MissingPDFException:()=>rx,OPS:()=>ax,PDFDataRangeTransport:()=>ox,PDFDateString:()=>lx,PDFWorker:()=>hx,PasswordResponses:()=>cx,PermissionFlag:()=>dx,PixelsPerInch:()=>ux,RenderingCancelledException:()=>fx,TextLayer:()=>px,UnexpectedResponseException:()=>gx,Util:()=>mx,VerbosityLevel:()=>VA,XfaLayer:()=>bx,build:()=>_x,createValidAbsoluteUrl:()=>Ax,fetchData:()=>yx,getDocument:()=>jA,getFilenameFromUrl:()=>vx,getPdfFilenameFromUrl:()=>wx,getXfaPageViewport:()=>Ex,isDataScheme:()=>xx,isPdfFile:()=>Cx,noContextMenu:()=>Sx,normalizeUnicode:()=>Px,setLayerDimensions:()=>Tx,shadow:()=>Mx,version:()=>qu});var Ri={};N.r(Ri),N.d(Ri,{AnnotationLayerBuilder:()=>BS,DownloadManager:()=>HS,EventBus:()=>VS,FindState:()=>jS,GenericL10n:()=>Ny,LinkTarget:()=>ka,PDFFindController:()=>By,PDFHistory:()=>US,PDFLinkService:()=>Hy,PDFPageView:()=>zS,PDFScriptingManager:()=>WS,PDFSinglePageViewer:()=>Vy,PDFViewer:()=>jy,ProgressBar:()=>GS,RenderingStates:()=>$S,ScrollMode:()=>qS,SimpleLinkService:()=>KS,SpreadMode:()=>XS,StructTreeLayerBuilder:()=>YS,TextLayerBuilder:()=>ZS,XfaLayerBuilder:()=>JS,parseQueryString:()=>QS});var nt=N(4650),rt=N(4968),ti=N(7579),ei=N(2076),st=N(2722),vs=N(1566),ws=N(4482),V_=N(5403),G0=N(9300),I=N(5861),Dl={d:(l,t)=>{for(var e in t)Dl.o(t,e)&&!Dl.o(l,e)&&Object.defineProperty(l,e,{enumerable:!0,get:t[e]})},o:(l,t)=>Object.prototype.hasOwnProperty.call(l,t)};H=globalThis.pdfjsLib={},Dl.d(H,{AbortException:()=>Dn,AnnotationEditorLayer:()=>Kl,AnnotationEditorParamsType:()=>V,AnnotationEditorType:()=>K,AnnotationEditorUIManager:()=>Fi,AnnotationLayer:()=>WE,AnnotationMode:()=>Es,CMapCompressionType:()=>gm,ColorPicker:()=>Gu,DOMSVGFactory:()=>wm,DrawLayer:()=>$u,FeatureTest:()=>se,GlobalWorkerOptions:()=>Ni,ImageKind:()=>Pu,InvalidPDFException:()=>U_,MissingPDFException:()=>In,OPS:()=>Re,PDFDataRangeTransport:()=>CA,PDFDateString:()=>tA,PDFWorker:()=>De,PasswordResponses:()=>X0,PermissionFlag:()=>K0,PixelsPerInch:()=>Ie,RenderingCancelledException:()=>Em,TextLayer:()=>Ee,UnexpectedResponseException:()=>ku,Util:()=>O,VerbosityLevel:()=>Tu,XfaLayer:()=>MA,build:()=>xE,createValidAbsoluteUrl:()=>Q0,fetchData:()=>Ru,getDocument:()=>gE,getFilenameFromUrl:()=>dw,getPdfFilenameFromUrl:()=>uw,getXfaPageViewport:()=>fw,isDataScheme:()=>Iu,isPdfFile:()=>xm,noContextMenu:()=>ve,normalizeUnicode:()=>aw,setLayerDimensions:()=>On,shadow:()=>Y,version:()=>EE});const zt=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type),j_=[1,0,0,1,0,0],pm=[.001,0,0,.001,0,0],Es={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},K={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},V={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},K0={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Pu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Tu={ERRORS:0,WARNINGS:1,INFOS:5},gm={NONE:0,BINARY:1},Re={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},X0={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Mu=Tu.WARNINGS;function Z0(){return Mu}function Lu(l){Mu>=Tu.INFOS&&console.log(`Info: ${l}`)}function z(l){Mu>=Tu.WARNINGS&&console.log(`Warning: ${l}`)}function bt(l){throw new Error(l)}function wt(l,t){l||bt(t)}function Q0(l,t=null,e=null){if(!l)return null;try{if(e&&"string"==typeof l&&(e.addDefaultProtocol&&l.startsWith("www.")&&l.match(/\./g)?.length>=2&&(l=`http://${l}`),e.tryConvertEncoding))try{l=function rw(l){return decodeURIComponent(escape(l))}(l)}catch{}const i=t?new URL(l,t):new URL(l);if(function J0(l){switch(l?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch{}return null}function Y(l,t,e,i=!1){return Object.defineProperty(l,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const xs=function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t}();class mm extends xs{constructor(t,e){super(t,"PasswordException"),this.code=e}}class bm extends xs{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class U_ extends xs{constructor(t){super(t,"InvalidPDFException")}}class In extends xs{constructor(t){super(t,"MissingPDFException")}}class ku extends xs{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class tw extends xs{constructor(t){super(t,"FormatError")}}class Dn extends xs{constructor(t){super(t,"AbortException")}}function z_(l){("object"!=typeof l||void 0===l?.length)&&bt("Invalid argument for bytesToString");const t=l.length,e=8192;if(t<e)return String.fromCharCode.apply(null,l);const i=[];for(let s=0;s<t;s+=e){const n=Math.min(s+e,t),a=l.subarray(s,n);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Fl(l){"string"!=typeof l&&bt("Invalid argument for stringToBytes");const t=l.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=255&l.charCodeAt(i);return e}function _m(l){const t=Object.create(null);for(const[e,i]of l)t[e]=i;return t}class se{static get isLittleEndian(){return Y(this,"isLittleEndian",function iw(){const l=new Uint8Array(4);return l[0]=1,1===new Uint32Array(l.buffer,0,1)[0]}())}static get isEvalSupported(){return Y(this,"isEvalSupported",function sw(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return Y(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&"string"==typeof navigator?.platform?Y(this,"platform",{isMac:navigator.platform.includes("Mac")}):Y(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){return Y(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Am=Array.from(Array(256).keys(),l=>l.toString(16).padStart(2,"0"));class O{static makeHexColor(t,e,i){return`#${Am[t]}${Am[e]}${Am[i]}`}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){return[t[0]*e[0]+t[1]*e[2]+e[4],t[0]*e[1]+t[1]*e[3]+e[5]]}static applyInverseTransform(t,e){const i=e[0]*e[3]-e[1]*e[2];return[(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/i,(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/i]}static getAxialAlignedBoundingBox(t,e){const i=this.applyTransform(t,e),s=this.applyTransform(t.slice(2,4),e),n=this.applyTransform([t[0],t[3]],e),a=this.applyTransform([t[2],t[1]],e);return[Math.min(i[0],s[0],n[0],a[0]),Math.min(i[1],s[1],n[1],a[1]),Math.max(i[0],s[0],n[0],a[0]),Math.max(i[1],s[1],n[1],a[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],i=t[0]*e[0]+t[1]*e[2],a=t[2]*e[1]+t[3]*e[3],o=(i+a)/2,h=Math.sqrt((i+a)**2-4*(i*a-(t[2]*e[0]+t[3]*e[2])*(t[0]*e[1]+t[1]*e[3])))/2,d=o-h||1;return[Math.sqrt(o+h||1),Math.sqrt(d)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const n=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),a=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return n>a?null:[i,n,s,a]}static bezierBoundingBox(t,e,i,s,n,a,o,h,c){return c?(c[0]=Math.min(c[0],t,o),c[1]=Math.min(c[1],e,h),c[2]=Math.max(c[2],t,o),c[3]=Math.max(c[3],e,h)):c=[Math.min(t,o),Math.min(e,h),Math.max(t,o),Math.max(e,h)],p(this,rh,mb).call(this,t,i,n,o,e,s,a,h,3*(3*(i-n)-t+o),6*(t-2*i+n),3*(i-t),c),p(this,rh,mb).call(this,t,i,n,o,e,s,a,h,3*(3*(s-a)-e+h),6*(e-2*s+a),3*(s-e),c),c}}Ia=new WeakSet,kg=function(t,e,i,s,n,a,o,h,c,d){if(c<=0||c>=1)return;const u=1-c,g=c*c,b=g*c,_=u*(u*(u*t+3*c*e)+3*g*i)+b*s,A=u*(u*(u*n+3*c*a)+3*g*o)+b*h;d[0]=Math.min(d[0],_),d[1]=Math.min(d[1],A),d[2]=Math.max(d[2],_),d[3]=Math.max(d[3],A)},rh=new WeakSet,mb=function(t,e,i,s,n,a,o,h,c,d,u,g){if(Math.abs(c)<1e-12)return void(Math.abs(d)>=1e-12&&p(this,Ia,kg).call(this,t,e,i,s,n,a,o,h,-u/d,g));const b=d**2-4*u*c;if(b<0)return;const _=Math.sqrt(b),A=2*c;p(this,Ia,kg).call(this,t,e,i,s,n,a,o,h,(-d+_)/A,g),p(this,Ia,kg).call(this,t,e,i,s,n,a,o,h,(-d-_)/A,g)},f(O,Ia),f(O,rh);let ym=null,W_=null;function aw(l){return ym||(ym=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,W_=new Map([["\ufb05","\u017ft"]])),l.replaceAll(ym,(t,e,i)=>e?e.normalize("NFKC"):W_.get(i))}const G_="pdfjs_internal_id_";class $_{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,n){return"none"}destroy(t=!1){}}class q_{constructor({enableHWA:t=!1}={}){f(this,ah,!1),m(this,ah,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!r(this,ah)})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){bt("Abstract method `_createCanvas` called.")}}ah=new WeakMap;class K_{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}fetch({name:t}){var e=this;return(0,I.Z)(function*(){if(!e.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const i=e.baseUrl+t+(e.isCompressed?".bcmap":"");return e._fetchData(i,e.isCompressed?gm.BINARY:gm.NONE).catch(n=>{throw new Error(`Unable to load ${e.isCompressed?"binary ":""}CMap at: ${i}`)})})()}_fetchData(t,e){bt("Abstract method `_fetchData` called.")}}class X_{constructor({baseUrl:t=null}){this.baseUrl=t}fetch({filename:t}){var e=this;return(0,I.Z)(function*(){if(!e.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const i=`${e.baseUrl}${t}`;return e._fetchData(i).catch(s=>{throw new Error(`Unable to load font data at: ${i}`)})})()}_fetchData(t){bt("Abstract method `_fetchData` called.")}}const Di="http://www.w3.org/2000/svg",of=class{};let Q_,Ie=of;function Ru(l){return vm.apply(this,arguments)}function vm(){return(vm=(0,I.Z)(function*(l,t="text"){if(Bl(l,document.baseURI)){const e=yield fetch(l);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",l,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(200===s.status||0===s.status){switch(t){case"arraybuffer":case"blob":case"json":return void e(s.response)}return void e(s.responseText)}i(new Error(s.statusText))}},s.send(null)})})).apply(this,arguments)}R(Ie,"CSS",96),R(Ie,"PDF",72),R(Ie,"PDF_TO_CSS_UNITS",of.CSS/of.PDF),Un=new WeakMap,zn=new WeakMap,ri=new WeakMap,Ui=new WeakMap,qt=new WeakMap,lf=new WeakMap,Wn=new WeakMap,Lt=new WeakSet,Xt=function(){return r(this,zn)||m(this,zn,new Map)},Ms=new WeakSet,Cl=function(){return r(this,lf)||m(this,lf,new Map)},Ls=new WeakSet,Sl=function(){if(!r(this,ri)){const e=r(this,qt).createElement("div"),{style:i}=e;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=r(this,qt).createElementNS(Di,"svg");s.setAttribute("width",0),s.setAttribute("height",0),m(this,ri,r(this,qt).createElementNS(Di,"defs")),e.append(s),s.append(r(this,ri)),r(this,qt).body.append(e)}return r(this,ri)},Da=new WeakSet,Rg=function(e){if(1===e.length){const c=e[0],d=new Array(256);for(let g=0;g<256;g++)d[g]=c[g]/255;const u=d.join(",");return[u,u,u]}const[i,s,n]=e,a=new Array(256),o=new Array(256),h=new Array(256);for(let c=0;c<256;c++)a[c]=i[c]/255,o[c]=s[c]/255,h[c]=n[c]/255;return[a.join(","),o.join(","),h.join(",")]},ks=new WeakSet,Pl=function(e){if(void 0===r(this,Un)){m(this,Un,"");const i=r(this,qt).URL;i!==r(this,qt).baseURI&&(Iu(i)?z('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,Un,i.split("#",1)[0]))}return`url(${r(this,Un)}#${e})`},hf=new WeakSet,zy=function(e){const i=r(this,qt).createElementNS(Di,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(i)},oh=new WeakSet,bb=function(e){const i=r(this,qt).createElementNS(Di,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(i)},Rs=new WeakSet,Tl=function(e){const i=r(this,qt).createElementNS(Di,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",e),r(this,Ls,Sl).append(i),i},Gn=new WeakSet,ou=function(e,i,s){const n=r(this,qt).createElementNS(Di,i);n.setAttribute("type","discrete"),n.setAttribute("tableValues",s),e.append(n)},$n=new WeakSet,lu=function(e,i,s,n){const a=r(this,qt).createElementNS(Di,"feComponentTransfer");n.append(a),p(this,Gn,ou).call(this,a,"feFuncR",e),p(this,Gn,ou).call(this,a,"feFuncG",i),p(this,Gn,ou).call(this,a,"feFuncB",s)},lh=new WeakSet,_b=function(e,i){const s=r(this,qt).createElementNS(Di,"feComponentTransfer");i.append(s),p(this,Gn,ou).call(this,s,"feFuncA",e)},qn=new WeakSet,hu=function(e){return r(this,Ls,Sl).style.color=e,Cm(getComputedStyle(r(this,Ls,Sl)).getPropertyValue("color"))};class Y_ extends K_{_fetchData(t,e){return Ru(t,this.isCompressed?"arraybuffer":"text").then(i=>({cMapData:i instanceof ArrayBuffer?new Uint8Array(i):Fl(i),compressionType:e}))}}class Z_ extends X_{_fetchData(t){return Ru(t,"arraybuffer").then(e=>new Uint8Array(e))}}class wm extends class lw{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){bt("Abstract method `_createSVG` called.")}}{_createSVG(t){return document.createElementNS(Di,t)}}class Nl{constructor({viewBox:t,scale:e,rotation:i,offsetX:s=0,offsetY:n=0,dontFlip:a=!1}){this.viewBox=t,this.scale=e,this.rotation=i,this.offsetX=s,this.offsetY=n;const o=(t[2]+t[0])/2,h=(t[3]+t[1])/2;let c,d,u,g,b,_,A,v;switch((i%=360)<0&&(i+=360),i){case 180:c=-1,d=0,u=0,g=1;break;case 90:c=0,d=1,u=1,g=0;break;case 270:c=0,d=-1,u=-1,g=0;break;case 0:c=1,d=0,u=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(u=-u,g=-g),0===c?(b=Math.abs(h-t[1])*e+s,_=Math.abs(o-t[0])*e+n,A=(t[3]-t[1])*e,v=(t[2]-t[0])*e):(b=Math.abs(o-t[0])*e+s,_=Math.abs(h-t[1])*e+n,A=(t[2]-t[0])*e,v=(t[3]-t[1])*e),this.transform=[c*e,d*e,u*e,g*e,b-c*e*o-u*e*h,_-d*e*o-g*e*h],this.width=A,this.height=v}get rawDims(){const{viewBox:t}=this;return Y(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:n=!1}={}){return new Nl({viewBox:this.viewBox.slice(),scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:n})}convertToViewportPoint(t,e){return O.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=O.applyTransform([t[0],t[1]],this.transform),i=O.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){return O.applyInverseTransform([t,e],this.transform)}}class Em extends xs{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Iu(l){const t=l.length;let e=0;for(;e<t&&""===l[e].trim();)e++;return"data:"===l.substring(e,e+5).toLowerCase()}function xm(l){return"string"==typeof l&&/\.pdf$/i.test(l)}function dw(l){return[l]=l.split(/[#?]/,1),l.substring(l.lastIndexOf("/")+1)}function uw(l,t="document.pdf"){if("string"!=typeof l)return t;if(Iu(l))return z('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(l);let n=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(n&&(n=n[0],n.includes("%")))try{n=i.exec(decodeURIComponent(n))[0]}catch{}return n||t}class J_{constructor(){R(this,"started",Object.create(null)),R(this,"times",[])}time(t){t in this.started&&z(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||z(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:n}of this.times)t.push(`${i.padEnd(e)} ${n-s}ms\n`);return t.join("")}}function Bl(l,t){try{const{protocol:e}=t?new URL(l,t):new URL(l);return"http:"===e||"https:"===e}catch{return!1}}function ve(l){l.preventDefault()}class tA{static toDateObject(t){if(!t||"string"!=typeof t)return null;Q_||(Q_=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=Q_.exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let n=parseInt(e[3],10);n=n>=1&&n<=31?n:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const c=e[7]||"Z";let d=parseInt(e[8],10);d=d>=0&&d<=23?d:0;let u=parseInt(e[9],10)||0;return u=u>=0&&u<=59?u:0,"-"===c?(a+=d,o+=u):"+"===c&&(a-=d,o-=u),new Date(Date.UTC(i,s,n,a,o,h))}}function fw(l,{scale:t=1,rotation:e=0}){const{width:i,height:s}=l.attributes.style,n=[0,0,parseInt(i),parseInt(s)];return new Nl({viewBox:n,scale:t,rotation:e})}function Cm(l){if(l.startsWith("#")){const t=parseInt(l.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return l.startsWith("rgb(")?l.slice(4,-1).split(",").map(t=>parseInt(t)):l.startsWith("rgba(")?l.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(z(`Not a valid color format: "${l}"`),[0,0,0])}function ot(l){const{a:t,b:e,c:i,d:s,e:n,f:a}=l.getTransform();return[t,e,i,s,n,a]}function Oi(l){const{a:t,b:e,c:i,d:s,e:n,f:a}=l.getTransform().invertSelf();return[t,e,i,s,n,a]}function On(l,t,e=!1,i=!0){if(t instanceof Nl){const{pageWidth:s,pageHeight:n}=t.rawDims,{style:a}=l,o=se.isCSSRoundSupported,h=`var(--scale-factor) * ${s}px`,c=`var(--scale-factor) * ${n}px`,d=o?`round(${h}, 1px)`:`calc(${h})`,u=o?`round(${c}, 1px)`:`calc(${c})`;e&&t.rotation%180!=0?(a.width=u,a.height=d):(a.width=d,a.height=u)}i&&l.setAttribute("data-main-rotation",t.rotation)}const Zn=class{constructor(t){f(this,df),f(this,uf),f(this,Oa),f(this,ff),f(this,dh),f(this,Kn,null),f(this,Xn,null),f(this,He,void 0),f(this,Yn,null),f(this,hh,null),m(this,He,t),r(Zn,ch)||m(Zn,ch,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=m(this,Kn,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar");const e=r(this,He)._uiManager._signal;t.addEventListener("contextmenu",ve,{signal:e}),t.addEventListener("pointerdown",p(Zn,cf,Wy),{signal:e});const i=m(this,Yn,document.createElement("div"));i.className="buttons",t.append(i);const s=r(this,He).toolbarPosition;if(s){const{style:n}=t,a="ltr"===r(this,He)._uiManager.direction?1-s[0]:s[0];n.insetInlineEnd=100*a+"%",n.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return p(this,ff,qy).call(this),t}hide(){r(this,Kn).classList.add("hidden"),r(this,Xn)?.hideDropdown()}show(){r(this,Kn).classList.remove("hidden"),r(this,hh)?.shown()}addAltText(t){var e=this;return(0,I.Z)(function*(){var s;const i=yield t.render();p(s=e,Oa,Ig).call(s,i),r(e,Yn).prepend(i,r(e,dh,Ab)),m(e,hh,t)})()}addColorPicker(t){m(this,Xn,t);const e=t.renderButton();p(this,Oa,Ig).call(this,e),r(this,Yn).prepend(e,r(this,dh,Ab))}remove(){r(this,Kn).remove(),r(this,Xn)?.destroy(),m(this,Xn,null)}};let Hl=Zn;Kn=new WeakMap,Xn=new WeakMap,He=new WeakMap,Yn=new WeakMap,hh=new WeakMap,ch=new WeakMap,cf=new WeakSet,Wy=function(t){t.stopPropagation()},df=new WeakSet,Gy=function(t){r(this,He)._focusEventsAllowed=!1,t.preventDefault(),t.stopPropagation()},uf=new WeakSet,$y=function(t){r(this,He)._focusEventsAllowed=!0,t.preventDefault(),t.stopPropagation()},Oa=new WeakSet,Ig=function(t){const e=r(this,He)._uiManager._signal;t.addEventListener("focusin",p(this,df,Gy).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",p(this,uf,$y).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",ve,{signal:e})},ff=new WeakSet,qy=function(){const{editorType:t,_uiManager:e}=r(this,He),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",r(Zn,ch)[t]),p(this,Oa,Ig).call(this,i),i.addEventListener("click",s=>{e.delete()},{signal:e._signal}),r(this,Yn).append(i)},dh=new WeakSet,Ab=function(){const t=document.createElement("div");return t.className="divider",t},f(Hl,cf),f(Hl,ch,null);class gw{constructor(t){f(this,pf),f(this,gf),f(this,mf),f(this,uh,null),f(this,Jn,null),f(this,Qn,void 0),m(this,Qn,t)}show(t,e,i){const[s,n]=p(this,gf,Xy).call(this,e,i),{style:a}=r(this,Jn)||m(this,Jn,p(this,pf,Ky).call(this));t.append(r(this,Jn)),a.insetInlineEnd=100*s+"%",a.top=`calc(${100*n}% + var(--editor-toolbar-vert-offset))`}hide(){r(this,Jn).remove()}}function Du(l,t,e){for(const i of e)t.addEventListener(i,l[i].bind(l))}uh=new WeakMap,Jn=new WeakMap,Qn=new WeakMap,pf=new WeakSet,Ky=function(){const t=m(this,Jn,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",ve,{signal:r(this,Qn)._signal});const e=m(this,uh,document.createElement("div"));return e.className="buttons",t.append(e),p(this,mf,Yy).call(this),t},gf=new WeakSet,Xy=function(t,e){let i=0,s=0;for(const n of t){const a=n.y+n.height;if(a<i)continue;const o=n.x+(e?n.width:0);a>i?(s=o,i=a):e?o>s&&(s=o):o<s&&(s=o)}return[e?1-s:s,i]},mf=new WeakSet,Yy=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=r(this,Qn)._signal;t.addEventListener("contextmenu",ve,{signal:i}),t.addEventListener("click",()=>{r(this,Qn).highlightSelection("floating_button")},{signal:i}),r(this,uh).append(t)};class bw{constructor(){f(this,bf,0)}get id(){return"pdfjs_internal_editor_"+ee(this,bf)._++}}bf=new WeakMap;const nb=class{constructor(){f(this,ph),f(this,fh,function ow(){if(typeof crypto<"u"&&"function"==typeof crypto?.randomUUID)return crypto.randomUUID();const l=new Uint8Array(32);if(typeof crypto<"u"&&"function"==typeof crypto?.getRandomValues)crypto.getRandomValues(l);else for(let t=0;t<32;t++)l[t]=Math.floor(255*Math.random());return z_(l)}()),f(this,_f,0),f(this,xe,null)}static get _isSVGFittingCanvas(){const i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;return s.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Y(this,"_isSVGFittingCanvas",s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),0===new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0])))}getFromFile(t){var e=this;return(0,I.Z)(function*(){var o;const{lastModified:i,name:s,size:n,type:a}=t;return p(o=e,ph,yb).call(o,`${i}_${s}_${n}_${a}`,t)})()}getFromUrl(t){var e=this;return(0,I.Z)(function*(){var i;return p(i=e,ph,yb).call(i,t,t)})()}getFromId(t){var e=this;return(0,I.Z)(function*(){r(e,xe)||m(e,xe,new Map);const i=r(e,xe).get(t);return i?i.bitmap?(i.refCounter+=1,i):i.file?e.getFromFile(i.file):e.getFromUrl(i.url):null})()}getSvgUrl(t){const e=r(this,xe).get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){r(this,xe)||m(this,xe,new Map);const e=r(this,xe).get(t);!e||(e.refCounter-=1,0===e.refCounter&&(e.bitmap=null))}isValidId(t){return t.startsWith(`image_${r(this,fh)}_`)}};let Sm=nb;fh=new WeakMap,_f=new WeakMap,xe=new WeakMap,ph=new WeakSet,yb=function(t,e){var i=this;return(0,I.Z)(function*(){r(i,xe)||m(i,xe,new Map);let s=r(i,xe).get(t);if(null===s)return null;if(s?.bitmap)return s.refCounter+=1,s;try{let n;if(s||(s={bitmap:null,id:`image_${r(i,fh)}_${ee(i,_f)._++}`,refCounter:0,isSvg:!1}),"string"==typeof e?(s.url=e,n=yield Ru(e,"blob")):n=s.file=e,"image/svg+xml"===n.type){const a=nb._isSVGFittingCanvas,o=new FileReader,h=new Image,c=new Promise((d,u)=>{h.onload=()=>{s.bitmap=h,s.isSvg=!0,d()},o.onload=(0,I.Z)(function*(){const g=s.svgUrl=o.result;h.src=(yield a)?`${g}#svgView(preserveAspectRatio(none))`:g}),h.onerror=o.onerror=u});o.readAsDataURL(n),yield c}else s.bitmap=yield createImageBitmap(n);s.refCounter=1}catch(n){console.error(n),s=null}return r(i,xe).set(t,s),s&&r(i,xe).set(s.id,s),s})()};class _w{constructor(t=128){f(this,kt,[]),f(this,Is,!1),f(this,gh,void 0),f(this,Rt,-1),m(this,gh,t)}add({cmd:t,undo:e,post:i,mustExec:s,type:n=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&t(),r(this,Is))return;const h={cmd:t,undo:e,post:i,type:n};if(-1===r(this,Rt))return r(this,kt).length>0&&(r(this,kt).length=0),m(this,Rt,0),void r(this,kt).push(h);if(a&&r(this,kt)[r(this,Rt)].type===n)return o&&(h.undo=r(this,kt)[r(this,Rt)].undo),void(r(this,kt)[r(this,Rt)]=h);const c=r(this,Rt)+1;c===r(this,gh)?r(this,kt).splice(0,1):(m(this,Rt,c),c<r(this,kt).length&&r(this,kt).splice(c)),r(this,kt).push(h)}undo(){if(-1===r(this,Rt))return;m(this,Is,!0);const{undo:t,post:e}=r(this,kt)[r(this,Rt)];t(),e?.(),m(this,Is,!1),m(this,Rt,r(this,Rt)-1)}redo(){if(r(this,Rt)<r(this,kt).length-1){m(this,Rt,r(this,Rt)+1),m(this,Is,!0);const{cmd:t,post:e}=r(this,kt)[r(this,Rt)];t(),e?.(),m(this,Is,!1)}}hasSomethingToUndo(){return-1!==r(this,Rt)}hasSomethingToRedo(){return r(this,Rt)<r(this,kt).length-1}destroy(){m(this,kt,null)}}kt=new WeakMap,Is=new WeakMap,gh=new WeakMap,Rt=new WeakMap;class Vl{constructor(t){f(this,Af),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=se.platform;for(const[i,s,n={}]of t)for(const a of i){const o=a.startsWith("mac+");e&&o?(this.callbacks.set(a.slice(4),{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1))):!e&&!o&&(this.callbacks.set(a,{callback:s,options:n}),this.allKeys.add(a.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(p(this,Af,Zy).call(this,e));if(!i)return;const{callback:s,options:{bubbles:n=!1,args:a=[],checker:o=null}}=i;o&&!o(t,e)||(s.bind(t,...a,e)(),n||(e.stopPropagation(),e.preventDefault()))}}Af=new WeakSet,Zy=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const rb=class{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return function pw(l){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of l.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;l.set(e,Cm(i))}t.remove()}(t),Y(this,"_colors",t)}convert(t){const e=Cm(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((n,a)=>n===e[a]))return rb._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?O.makeHexColor(...e):t}};let Ou=rb;R(Ou,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));const kf=class{constructor(t,e,i,s,n,a,o,h,c,d,u){f(this,Ua),f(this,Ch),f(this,vf),f(this,wf),f(this,za),f(this,Ef),f(this,xf),f(this,Cf),f(this,Sh),f(this,Sf),f(this,Ph),f(this,Th),f(this,Pf),f(this,Bt),f(this,ci),f(this,Tf),f(this,Mf),f(this,Mh),f(this,Lf),f(this,nr),f(this,Lh),f(this,Fa,new AbortController),f(this,fe,null),f(this,Et,new Map),f(this,Nt,new Map),f(this,Na,null),f(this,zi,null),f(this,Ba,null),f(this,Ve,new _w),f(this,Ds,null),f(this,Ha,0),f(this,tr,new Set),f(this,ai,null),f(this,je,null),f(this,er,new Set),f(this,mh,!1),f(this,bh,!1),f(this,Va,!1),f(this,_h,null),f(this,oi,null),f(this,Os,null),f(this,ja,null),f(this,Fs,!1),f(this,li,null),f(this,yf,new bw),f(this,Ns,!1),f(this,Ah,!1),f(this,Bs,null),f(this,ir,null),f(this,yh,null),f(this,vh,null),f(this,It,K.NONE),f(this,Q,new Set),f(this,Wi,null),f(this,sr,null),f(this,wh,null),f(this,Eh,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),f(this,Hs,[0,0]),f(this,hi,null),f(this,Gi,null),f(this,xh,null);const g=this._signal=r(this,Fa).signal;m(this,Gi,t),m(this,xh,e),m(this,Na,i),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:g}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),s._on("setpreference",this.onSetPreference.bind(this),{signal:g}),s._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:g}),p(this,Ef,tv).call(this),p(this,Pf,nv).call(this),p(this,Sh,wb).call(this),m(this,zi,n.annotationStorage),m(this,_h,n.filterFactory),m(this,sr,a),m(this,ja,o||null),m(this,mh,h),m(this,bh,c),m(this,Va,d),m(this,vh,u||null),this.viewParameters={realScale:Ie.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const t=kf.prototype,e=a=>r(a,Gi).contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:h}=o;return"text"!==h&&"number"!==h}return!0},s=this.TRANSLATE_SMALL,n=this.TRANSLATE_BIG;return Y(this,"_keyboardManager",new Vl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&r(a,Gi).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&r(a,Gi).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:e}]]))}destroy(){r(this,Fa)?.abort(),m(this,Fa,null),this._signal=null;for(const t of r(this,Nt).values())t.destroy();r(this,Nt).clear(),r(this,Et).clear(),r(this,er).clear(),m(this,fe,null),r(this,Q).clear(),r(this,Ve).destroy(),r(this,Na)?.destroy(),r(this,li)?.hide(),m(this,li,null),r(this,oi)&&(clearTimeout(r(this,oi)),m(this,oi,null)),r(this,hi)&&(clearTimeout(r(this,hi)),m(this,hi,null))}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return r(this,vh)}get useNewAltTextFlow(){return r(this,bh)}get useNewAltTextWhenAddingImage(){return r(this,Va)}get hcmFilter(){return Y(this,"hcmFilter",r(this,sr)?r(this,_h).addHCMFilter(r(this,sr).foreground,r(this,sr).background):"none")}get direction(){return Y(this,"direction",getComputedStyle(r(this,Gi)).direction)}get highlightColors(){return Y(this,"highlightColors",r(this,ja)?new Map(r(this,ja).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return Y(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setMainHighlightColorPicker(t){m(this,yh,t)}editAltText(t,e=!1){r(this,Na)?.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){"enableNewAltTextWhenAddingImage"===t&&m(this,Va,e)}onPageChanging({pageNumber:t}){m(this,Ha,t-1)}focusMainContainer(){r(this,Gi).focus()}findParent(t,e){for(const i of r(this,Nt).values()){const{x:s,y:n,width:a,height:o}=i.div.getBoundingClientRect();if(t>=s&&t<=s+a&&e>=n&&e<=n+o)return i}return null}disableUserSelect(t=!1){r(this,xh).classList.toggle("noUserSelect",t)}addShouldRescale(t){r(this,er).add(t)}removeShouldRescale(t){r(this,er).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Ie.PDF_TO_CSS_UNITS;for(const e of r(this,er))e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:n,focusOffset:a}=e,o=e.toString(),c=p(this,Ua,Dg).call(this,e).closest(".textLayer"),d=this.getSelectionBoxes(c);if(!d)return;e.empty();const u=p(this,Ch,vb).call(this,c),g=r(this,It)===K.NONE,b=()=>{u?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:i,anchorOffset:s,focusNode:n,focusOffset:a,text:o}),g&&this.showAllEditors("highlight",!0,!0)};g?this.switchToMode(K.HIGHLIGHT,b):b()}addToAnnotationStorage(t){!t.isEmpty()&&r(this,zi)&&!r(this,zi).has(t.id)&&r(this,zi).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,r(this,Fs)&&(m(this,Fs,!1),p(this,za,Og).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of r(this,Q))if(e.div.contains(t)){m(this,ir,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!r(this,ir))return;const[t,e]=r(this,ir);m(this,ir,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){p(this,Sh,wb).call(this),p(this,Ph,Eb).call(this)}removeEditListeners(){p(this,Sf,sv).call(this),p(this,Th,xb).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of r(this,je))if(i.isHandlingMimeForPasting(e))return t.dataTransfer.dropEffect="copy",void t.preventDefault()}drop(t){for(const e of t.dataTransfer.items)for(const i of r(this,je))if(i.isHandlingMimeForPasting(e.type))return i.paste(e,this.currentLayer),void t.preventDefault()}copy(t){if(t.preventDefault(),r(this,fe)?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of r(this,Q)){const s=i.serialize(!0);s&&e.push(s)}0!==e.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}paste(t){t.preventDefault();const{clipboardData:e}=t;for(const n of e.items)for(const a of r(this,je))if(a.isHandlingMimeForPasting(n.type))return void a.paste(n,this.currentLayer);let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(n){return void z(`paste: "${n.message}".`)}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const n=[];for(const h of i){const c=s.deserialize(h);if(!c)return;n.push(c)}this.addCommands({cmd:()=>{for(const h of n)p(this,Mh,Cb).call(this,h);p(this,Lh,Sb).call(this,n)},undo:()=>{for(const h of n)h.remove()},mustExec:!0})}catch(n){z(`paste: "${n.message}".`)}}keydown(t){!this.isShiftKeyDown&&"Shift"===t.key&&(this.isShiftKeyDown=!0),r(this,It)!==K.NONE&&!this.isEditorHandlingKeyboard&&kf._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&"Shift"===t.key&&(this.isShiftKeyDown=!1,r(this,Fs)&&(m(this,Fs,!1),p(this,za,Og).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu")}}setEditingState(t){t?(p(this,xf,ev).call(this),p(this,Ph,Eb).call(this),p(this,Bt,ie).call(this,{isEditing:r(this,It)!==K.NONE,isEmpty:p(this,nr,cu).call(this),hasSomethingToUndo:r(this,Ve).hasSomethingToUndo(),hasSomethingToRedo:r(this,Ve).hasSomethingToRedo(),hasSelectedEditor:!1})):(p(this,Cf,iv).call(this),p(this,Th,xb).call(this),p(this,Bt,ie).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!r(this,je)){m(this,je,t);for(const e of r(this,je))p(this,ci,Ln).call(this,e.defaultPropertiesToUpdate)}}getId(){return r(this,yf).id}get currentLayer(){return r(this,Nt).get(r(this,Ha))}getLayer(t){return r(this,Nt).get(t)}get currentPageIndex(){return r(this,Ha)}addLayer(t){r(this,Nt).set(t.pageIndex,t),r(this,Ns)?t.enable():t.disable()}removeLayer(t){r(this,Nt).delete(t.pageIndex)}updateMode(t,e=null,i=!1){if(r(this,It)!==t){if(m(this,It,t),t===K.NONE)return this.setEditingState(!1),void p(this,Mf,av).call(this);this.setEditingState(!0),p(this,Tf,rv).call(this),this.unselectAll();for(const s of r(this,Nt).values())s.updateMode(t);if(!e&&i)return void this.addNewEditorFromKeyboard();if(e)for(const s of r(this,Et).values())if(s.annotationElementId===e){this.setSelected(s),s.enterInEditMode();break}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==r(this,It)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(r(this,je)){switch(t){case V.CREATE:return void this.currentLayer.addNewEditor();case V.HIGHLIGHT_DEFAULT_COLOR:r(this,yh)?.updateColor(e);break;case V.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(r(this,wh)||m(this,wh,new Map)).set(t,e),this.showAllEditors("highlight",e)}for(const i of r(this,Q))i.updateParams(t,e);for(const i of r(this,je))i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const n of r(this,Et).values())n.editorType===t&&n.show(e);(r(this,wh)?.get(V.HIGHLIGHT_SHOW_ALL)??!0)!==e&&p(this,ci,Ln).call(this,[[V.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(r(this,Ah)!==t){m(this,Ah,t);for(const e of r(this,Nt).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const i of r(this,Et).values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return r(this,Et).get(t)}addEditor(t){r(this,Et).set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(r(this,oi)&&clearTimeout(r(this,oi)),m(this,oi,setTimeout(()=>{this.focusMainContainer(),m(this,oi,null)},0))),r(this,Et).delete(t.id),this.unselect(t),(!t.annotationElementId||!r(this,tr).has(t.annotationElementId))&&r(this,zi)?.remove(t.id)}addDeletedAnnotationElement(t){r(this,tr).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return r(this,tr).has(t)}removeDeletedAnnotationElement(t){r(this,tr).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){r(this,fe)!==t&&(m(this,fe,t),t&&p(this,ci,Ln).call(this,t.propertiesToUpdate))}updateUI(t){r(this,Lf,ov)===t&&p(this,ci,Ln).call(this,t.propertiesToUpdate)}toggleSelected(t){if(r(this,Q).has(t))return r(this,Q).delete(t),t.unselect(),void p(this,Bt,ie).call(this,{hasSelectedEditor:this.hasSelection});r(this,Q).add(t),t.select(),p(this,ci,Ln).call(this,t.propertiesToUpdate),p(this,Bt,ie).call(this,{hasSelectedEditor:!0})}setSelected(t){for(const e of r(this,Q))e!==t&&e.unselect();r(this,Q).clear(),r(this,Q).add(t),t.select(),p(this,ci,Ln).call(this,t.propertiesToUpdate),p(this,Bt,ie).call(this,{hasSelectedEditor:!0})}isSelected(t){return r(this,Q).has(t)}get firstSelectedEditor(){return r(this,Q).values().next().value}unselect(t){t.unselect(),r(this,Q).delete(t),p(this,Bt,ie).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==r(this,Q).size}get isEnterHandled(){return 1===r(this,Q).size&&this.firstSelectedEditor.isEnterHandled}undo(){r(this,Ve).undo(),p(this,Bt,ie).call(this,{hasSomethingToUndo:r(this,Ve).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:p(this,nr,cu).call(this)})}redo(){r(this,Ve).redo(),p(this,Bt,ie).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:r(this,Ve).hasSomethingToRedo(),isEmpty:p(this,nr,cu).call(this)})}addCommands(t){r(this,Ve).add(t),p(this,Bt,ie).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:p(this,nr,cu).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const t=[...r(this,Q)];this.addCommands({cmd:()=>{for(const s of t)s.remove()},undo:()=>{for(const s of t)p(this,Mh,Cb).call(this,s)},mustExec:!0})}commitOrRemove(){r(this,fe)?.commitOrRemove()}hasSomethingToControl(){return r(this,fe)||this.hasSelection}selectAll(){for(const t of r(this,Q))t.commit();p(this,Lh,Sb).call(this,r(this,Et).values())}unselectAll(){if((!r(this,fe)||(r(this,fe).commitOrRemove(),r(this,It)===K.NONE))&&this.hasSelection){for(const t of r(this,Q))t.unselect();r(this,Q).clear(),p(this,Bt,ie).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;r(this,Hs)[0]+=t,r(this,Hs)[1]+=e;const[s,n]=r(this,Hs),a=[...r(this,Q)];r(this,hi)&&clearTimeout(r(this,hi)),m(this,hi,setTimeout(()=>{m(this,hi,null),r(this,Hs)[0]=r(this,Hs)[1]=0,this.addCommands({cmd:()=>{for(const h of a)r(this,Et).has(h.id)&&h.translateInPage(s,n)},undo:()=>{for(const h of a)r(this,Et).has(h.id)&&h.translateInPage(-s,-n)},mustExec:!1})},1e3));for(const h of a)h.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,ai,new Map);for(const t of r(this,Q))r(this,ai).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!r(this,ai))return!1;this.disableUserSelect(!1);const t=r(this,ai);m(this,ai,null);let e=!1;for(const[{x:s,y:n,pageIndex:a},o]of t)o.newX=s,o.newY=n,o.newPageIndex=a,e||(e=s!==o.savedX||n!==o.savedY||a!==o.savedPageIndex);if(!e)return!1;const i=(s,n,a,o)=>{if(r(this,Et).has(s.id)){const h=r(this,Nt).get(o);h?s._setParentAndPosition(h,n,a):(s.pageIndex=o,s.x=n,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:n,newY:a,newPageIndex:o}]of t)i(s,n,a,o)},undo:()=>{for(const[s,{savedX:n,savedY:a,savedPageIndex:o}]of t)i(s,n,a,o)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(r(this,ai))for(const i of r(this,ai).keys())i.drag(t,e)}rebuild(t){if(null===t.parent){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||1===r(this,Q).size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return r(this,fe)===t}getActive(){return r(this,fe)}getMode(){return r(this,It)}get imageManager(){return Y(this,"imageManager",new Sm)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let c=0,d=e.rangeCount;c<d;c++)if(!t.contains(e.getRangeAt(c).commonAncestorContainer))return null;const{x:i,y:s,width:n,height:a}=t.getBoundingClientRect();let o;switch(t.getAttribute("data-main-rotation")){case"90":o=(c,d,u,g)=>({x:(d-s)/a,y:1-(c+u-i)/n,width:g/a,height:u/n});break;case"180":o=(c,d,u,g)=>({x:1-(c+u-i)/n,y:1-(d+g-s)/a,width:u/n,height:g/a});break;case"270":o=(c,d,u,g)=>({x:1-(d+g-s)/a,y:(c-i)/n,width:g/a,height:u/n});break;default:o=(c,d,u,g)=>({x:(c-i)/n,y:(d-s)/a,width:u/n,height:g/a})}const h=[];for(let c=0,d=e.rangeCount;c<d;c++){const u=e.getRangeAt(c);if(!u.collapsed)for(const{x:g,y:b,width:_,height:A}of u.getClientRects())0===_||0===A||h.push(o(g,b,_,A))}return 0===h.length?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(r(this,Ba)||m(this,Ba,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){r(this,Ba)?.delete(t)}renderAnnotationElement(t){const e=r(this,Ba)?.get(t.data.id);if(!e)return;const i=r(this,zi).getRawValue(e);!i||r(this,It)===K.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t)}};let Fi=kf;Fa=new WeakMap,fe=new WeakMap,Et=new WeakMap,Nt=new WeakMap,Na=new WeakMap,zi=new WeakMap,Ba=new WeakMap,Ve=new WeakMap,Ds=new WeakMap,Ha=new WeakMap,tr=new WeakMap,ai=new WeakMap,je=new WeakMap,er=new WeakMap,mh=new WeakMap,bh=new WeakMap,Va=new WeakMap,_h=new WeakMap,oi=new WeakMap,Os=new WeakMap,ja=new WeakMap,Fs=new WeakMap,li=new WeakMap,yf=new WeakMap,Ns=new WeakMap,Ah=new WeakMap,Bs=new WeakMap,ir=new WeakMap,yh=new WeakMap,vh=new WeakMap,It=new WeakMap,Q=new WeakMap,Wi=new WeakMap,sr=new WeakMap,wh=new WeakMap,Eh=new WeakMap,Hs=new WeakMap,hi=new WeakMap,Gi=new WeakMap,xh=new WeakMap,Ua=new WeakSet,Dg=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},Ch=new WeakSet,vb=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of r(this,Nt).values())if(i.hasTextLayer(t))return i;return null},vf=new WeakSet,Jy=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=p(this,Ua,Dg).call(this,t).closest(".textLayer"),s=this.getSelectionBoxes(i);!s||(r(this,li)||m(this,li,new gw(this)),r(this,li).show(i,s,"ltr"===this.direction))},wf=new WeakSet,Qy=function(){const t=document.getSelection();if(!t||t.isCollapsed)return void(r(this,Wi)&&(r(this,li)?.hide(),m(this,Wi,null),p(this,Bt,ie).call(this,{hasSelectedText:!1})));const{anchorNode:e}=t;if(e===r(this,Wi))return;const s=p(this,Ua,Dg).call(this,t).closest(".textLayer");if(s){if(r(this,li)?.hide(),m(this,Wi,e),p(this,Bt,ie).call(this,{hasSelectedText:!0}),(r(this,It)===K.HIGHLIGHT||r(this,It)===K.NONE)&&(r(this,It)===K.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,Fs,this.isShiftKeyDown),!this.isShiftKeyDown)){const n=r(this,It)===K.HIGHLIGHT?p(this,Ch,vb).call(this,s):null;n?.toggleDrawing();const a=new AbortController,o=this.combinedSignal(a),h=c=>{"pointerup"===c.type&&0!==c.button||(a.abort(),n?.toggleDrawing(!0),"pointerup"===c.type&&p(this,za,Og).call(this,"main_toolbar"))};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}}else r(this,Wi)&&(r(this,li)?.hide(),m(this,Wi,null),p(this,Bt,ie).call(this,{hasSelectedText:!1}))},za=new WeakSet,Og=function(t=""){r(this,It)===K.HIGHLIGHT?this.highlightSelection(t):r(this,mh)&&p(this,vf,Jy).call(this)},Ef=new WeakSet,tv=function(){document.addEventListener("selectionchange",p(this,wf,Qy).bind(this),{signal:this._signal})},xf=new WeakSet,ev=function(){if(r(this,Os))return;m(this,Os,new AbortController);const t=this.combinedSignal(r(this,Os));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},Cf=new WeakSet,iv=function(){r(this,Os)?.abort(),m(this,Os,null)},Sh=new WeakSet,wb=function(){if(r(this,Bs))return;m(this,Bs,new AbortController);const t=this.combinedSignal(r(this,Bs));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},Sf=new WeakSet,sv=function(){r(this,Bs)?.abort(),m(this,Bs,null)},Ph=new WeakSet,Eb=function(){if(r(this,Ds))return;m(this,Ds,new AbortController);const t=this.combinedSignal(r(this,Ds));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},Th=new WeakSet,xb=function(){r(this,Ds)?.abort(),m(this,Ds,null)},Pf=new WeakSet,nv=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Bt=new WeakSet,ie=function(t){Object.entries(t).some(([i,s])=>r(this,Eh)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(r(this,Eh),t)}),r(this,It)===K.HIGHLIGHT&&!1===t.hasSelectedEditor&&p(this,ci,Ln).call(this,[[V.HIGHLIGHT_FREE,!0]]))},ci=new WeakSet,Ln=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},Tf=new WeakSet,rv=function(){if(!r(this,Ns)){m(this,Ns,!0);for(const t of r(this,Nt).values())t.enable();for(const t of r(this,Et).values())t.enable()}},Mf=new WeakSet,av=function(){if(this.unselectAll(),r(this,Ns)){m(this,Ns,!1);for(const t of r(this,Nt).values())t.disable();for(const t of r(this,Et).values())t.disable()}},Mh=new WeakSet,Cb=function(t){const e=r(this,Nt).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},Lf=new WeakSet,ov=function(){let t=null;for(t of r(this,Q));return t},nr=new WeakSet,cu=function(){if(0===r(this,Et).size)return!0;if(1===r(this,Et).size)for(const t of r(this,Et).values())return t.isEmpty();return!1},Lh=new WeakSet,Sb=function(t){for(const e of r(this,Q))e.unselect();r(this,Q).clear();for(const e of t)e.isEmpty()||(r(this,Q).add(e),e.select());p(this,Bt,ie).call(this,{hasSelectedEditor:this.hasSelection})},R(Fi,"TRANSLATE_SMALL",1),R(Fi,"TRANSLATE_BIG",10);const ze=class{constructor(t){f(this,Ga),f(this,$a),f(this,Dt,null),f(this,di,!1),f(this,Ue,null),f(this,ui,null),f(this,pe,null),f(this,Wa,!1),f(this,fi,null),f(this,ae,null),f(this,$i,null),f(this,rr,null),f(this,pi,!1),m(this,ae,t),m(this,pi,t._uiManager.useNewAltTextFlow)}static initialize(t){ze._l10nPromise||(ze._l10nPromise=t)}render(){var t=this;return(0,I.Z)(function*(){var a;const e=m(t,Ue,document.createElement("button"));let i;e.className="altText",r(t,pi)?(e.classList.add("new"),i=yield ze._l10nPromise.get("pdfjs-editor-new-alt-text-missing-button-label")):i=yield ze._l10nPromise.get("pdfjs-editor-alt-text-button-label"),e.textContent=i,e.setAttribute("aria-label",i),e.tabIndex="0";const s=r(t,ae)._uiManager._signal;e.addEventListener("contextmenu",ve,{signal:s}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const n=o=>{o.preventDefault(),r(t,ae)._uiManager.editAltText(r(t,ae)),r(t,pi)&&r(t,ae)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:r(t,Ga,Fg)}})};return e.addEventListener("click",n,{capture:!0,signal:s}),e.addEventListener("keydown",o=>{o.target===e&&"Enter"===o.key&&(m(t,Wa,!0),n(o))},{signal:s}),yield p(a=t,$a,Ng).call(a),e})()}finish(){!r(this,Ue)||(r(this,Ue).focus({focusVisible:r(this,Wa)}),m(this,Wa,!1))}isEmpty(){return r(this,pi)?null===r(this,Dt):!r(this,Dt)&&!r(this,di)}hasData(){return r(this,pi)?null!==r(this,Dt)||!!r(this,$i):this.isEmpty()}get guessedText(){return r(this,$i)}setGuessedText(t){var e=this;return(0,I.Z)(function*(){var i;null===r(e,Dt)&&(m(e,$i,t),m(e,rr,yield ze._l10nPromise.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer")({generatedAltText:t})),p(i=e,$a,Ng).call(i))})()}toggleAltTextBadge(t=!1){if(!r(this,pi)||r(this,Dt))return r(this,fi)?.remove(),void m(this,fi,null);if(!r(this,fi)){const e=m(this,fi,document.createElement("div"));e.className="noAltTextBadge",r(this,ae).div.append(e)}r(this,fi).classList.toggle("hidden",!t)}serialize(t){let e=r(this,Dt);return!t&&r(this,$i)===e&&(e=r(this,rr)),{altText:e,decorative:r(this,di),guessedText:r(this,$i),textWithDisclaimer:r(this,rr)}}get data(){return{altText:r(this,Dt),decorative:r(this,di)}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:s,cancel:n=!1}){i&&(m(this,$i,i),m(this,rr,s)),(r(this,Dt)!==t||r(this,di)!==e)&&(n||(m(this,Dt,t),m(this,di,e)),p(this,$a,Ng).call(this))}toggle(t=!1){!r(this,Ue)||(!t&&r(this,pe)&&(clearTimeout(r(this,pe)),m(this,pe,null)),r(this,Ue).disabled=!t)}shown(){r(this,ae)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:r(this,Ga,Fg)}})}destroy(){r(this,Ue)?.remove(),m(this,Ue,null),m(this,ui,null),r(this,fi)?.remove(),m(this,fi,null)}};let jl=ze;Dt=new WeakMap,di=new WeakMap,Ue=new WeakMap,ui=new WeakMap,pe=new WeakMap,Wa=new WeakMap,fi=new WeakMap,ae=new WeakMap,$i=new WeakMap,rr=new WeakMap,pi=new WeakMap,Ga=new WeakSet,Fg=function(){return(r(this,Dt)?"added":null===r(this,Dt)&&this.guessedText&&"review")||"missing"},$a=new WeakSet,Ng=function(){var t=this;return(0,I.Z)(function*(){const e=r(t,Ue);if(!e)return;if(r(t,pi)){const n=r(t,Ga,Fg),a="review"===n?"to-review":n;if(e.classList.toggle("done",!!r(t,Dt)),ze._l10nPromise.get(`pdfjs-editor-new-alt-text-${a}-button-label`).then(o=>{e.setAttribute("aria-label",o);for(const h of e.childNodes)if(h.nodeType===Node.TEXT_NODE){h.textContent=o;break}}),!r(t,Dt))return void r(t,ui)?.remove()}else{if(!r(t,Dt)&&!r(t,di))return e.classList.remove("done"),void r(t,ui)?.remove();e.classList.add("done"),ze._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(n=>{e.setAttribute("aria-label",n)})}let i=r(t,ui);if(!i){m(t,ui,i=document.createElement("span")),i.className="tooltip",i.setAttribute("role","tooltip");const n=i.id=`alt-text-tooltip-${r(t,ae).id}`;e.setAttribute("aria-describedby",n);const a=100,o=r(t,ae)._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(r(t,pe)),m(t,pe,null)},{once:!0}),e.addEventListener("mouseenter",()=>{m(t,pe,setTimeout(()=>{m(t,pe,null),r(t,ui).classList.add("show"),r(t,ae)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:o}),e.addEventListener("mouseleave",()=>{r(t,pe)&&(clearTimeout(r(t,pe)),m(t,pe,null)),r(t,ui)?.classList.remove("show")},{signal:o})}i.innerText=r(t,di)?yield ze._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):r(t,Dt),i.parentNode||e.append(i),r(t,ae).getImageForAltText()?.setAttribute("aria-describedby",i.id)})()},R(jl,"_l10nPromise",null);const at=class{constructor(t){f(this,Dh),f(this,Fh),f(this,If),f(this,Df),f(this,Nh),f(this,Bh),f(this,Hh),f(this,Of),f(this,Vh),f(this,Ff),f(this,Nf),f(this,Bf),f(this,jh),f(this,dr),f(this,ar,null),f(this,We,null),f(this,ht,null),f(this,qa,!1),f(this,or,!1),f(this,Ht,null),f(this,lr,null),f(this,Vs,null),f(this,kh,""),f(this,hr,!1),f(this,js,null),f(this,Rh,!1),f(this,cr,!1),f(this,qi,!1),f(this,gi,null),f(this,Ka,0),f(this,Xa,0),f(this,Ce,null),R(this,"_editToolbar",null),R(this,"_initialOptions",Object.create(null)),R(this,"_isVisible",!0),R(this,"_uiManager",null),R(this,"_focusEventsAllowed",!0),f(this,Ih,!1),f(this,Rf,at._zIndex++),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:n,pageY:a}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[n,a];const[o,h]=this.parentDimensions;this.x=t.x/o,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=at.prototype._resizeWithKeyboard,e=Fi.TRANSLATE_SMALL,i=Fi.TRANSLATE_BIG;return Y(this,"_resizerKeyboardManager",new Vl([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],at.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Y(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Aw({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e,i){if(at._l10nResizer||(at._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),at._l10nPromise||(at._l10nPromise=new Map([...["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-new-alt-text-added-button-label","pdfjs-editor-new-alt-text-missing-button-label","pdfjs-editor-new-alt-text-to-review-button-label"].map(n=>[n,t.get(n)]),...["pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer"].map(n=>[n,t.get.bind(t,n)])])),i?.strings)for(const n of i.strings)at._l10nPromise.set(n,t.get(n));if(-1!==at._borderLineWidth)return;const s=getComputedStyle(document.documentElement);at._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){bt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return r(this,Ih)}set _isDraggable(t){m(this,Ih,t),this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(2*t),this.y+=this.width*t/(2*e);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(2*t),this.y-=this.width*t/(2*e);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=r(this,Rf)}setParent(t){null!==t?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):p(this,dr,du).call(this),this.parent=t}focusin(t){!this._focusEventsAllowed||(r(this,hr)?m(this,hr,!1):this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[n,a]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/n,this.y=(e+s)/a,this.fixAndSetPosition()}translate(t,e){p(this,Dh,Pb).call(this,this.parentDimensions,t,e)}translateInPage(t,e){r(this,js)||m(this,js,[this.x,this.y]),p(this,Dh,Pb).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){r(this,js)||m(this,js,[this.x,this.y]);const[i,s]=this.parentDimensions;if(this.x+=t/i,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:c,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,c,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:n,y:a}=this;const[o,h]=this.getBaseTranslation();n+=o,a+=h,this.div.style.left=`${(100*n).toFixed(2)}%`,this.div.style.top=`${(100*a).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!r(this,js)&&(r(this,js)[0]!==this.x||r(this,js)[1]!==this.y)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=at,s=i/t,n=i/e;switch(this.rotation){case 90:return[-s,n];case 180:return[s,n];case 270:return[s,-n];default:return[-s,-n]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const[e,i]=this.pageDimensions;let{x:s,y:n,width:a,height:o}=this;if(a*=e,o*=i,s*=e,n*=i,this._mustFixPosition)switch(t){case 0:s=Math.max(0,Math.min(e-a,s)),n=Math.max(0,Math.min(i-o,n));break;case 90:s=Math.max(0,Math.min(e-o,s)),n=Math.min(i,Math.max(a,n));break;case 180:s=Math.min(e,Math.max(a,s)),n=Math.min(i,Math.max(o,n));break;case 270:s=Math.min(e,Math.max(o,s)),n=Math.max(0,Math.min(i-a,n))}this.x=s/=e,this.y=n/=i;const[h,c]=this.getBaseTranslation();s+=h,n+=c;const{style:d}=this.div;d.left=`${(100*s).toFixed(2)}%`,d.top=`${(100*n).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var i;return p(i=at,Oh,Tb).call(i,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var i;return p(i=at,Oh,Tb).call(i,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this,s=e*t,n=i*t;return se.isCSSRoundSupported?[Math.round(s),Math.round(n)]:[s,n]}setDims(t,e){const[i,s]=this.parentDimensions;this.div.style.width=`${(100*t/i).toFixed(2)}%`,r(this,or)||(this.div.style.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,s=i.endsWith("%"),n=!r(this,or)&&e.endsWith("%");if(s&&n)return;const[a,o]=this.parentDimensions;s||(t.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!r(this,or)&&!n&&(t.height=`${(100*parseFloat(e)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){r(this,ht)?.finish()}addEditToolbar(){var t=this;return(0,I.Z)(function*(){return t._editToolbar||r(t,cr)||(t._editToolbar=new Hl(t),t.div.append(t._editToolbar.render()),r(t,ht)&&(yield t._editToolbar.addAltText(r(t,ht)))),t._editToolbar})()}removeEditToolbar(){!this._editToolbar||(this._editToolbar.remove(),this._editToolbar=null,r(this,ht)?.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}addAltTextButton(){var t=this;return(0,I.Z)(function*(){r(t,ht)||(jl.initialize(at._l10nPromise),m(t,ht,new jl(t)),r(t,ar)&&(r(t,ht).data=r(t,ar),m(t,ar,null)),yield t.addEditToolbar())})()}get altTextData(){return r(this,ht)?.data}set altTextData(t){!r(this,ht)||(r(this,ht).data=t)}get guessedAltText(){return r(this,ht)?.guessedText}setGuessedAltText(t){var e=this;return(0,I.Z)(function*(){yield r(e,ht)?.setGuessedText(t)})()}serializeAltText(t){return r(this,ht)?.serialize(t)}hasAltText(){return!!r(this,ht)&&!r(this,ht).isEmpty()}hasAltTextData(){return r(this,ht)?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=r(this,qa)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),p(this,Vh,Ib).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!=0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),Du(this,this.div,["pointerdown"]),this.div}pointerdown(t){const{isMac:e}=se.platform;0!==t.button||t.ctrlKey&&e?t.preventDefault():(m(this,hr,!0),this._isDraggable?p(this,Of,cv).call(this,t):p(this,Hh,Rb).call(this,t))}moveInDOM(){r(this,gi)&&clearTimeout(r(this,gi)),m(this,gi,setTimeout(()=>{m(this,gi,null),this.parent?.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition()}getRect(t,e,i=this.rotation){const s=this.parentScale,[n,a]=this.pageDimensions,[o,h]=this.pageTranslation,c=t/s,d=e/s,u=this.x*n,g=this.y*a,b=this.width*n,_=this.height*a;switch(i){case 0:return[u+c+o,a-g-d-_+h,u+c+b+o,a-g-d+h];case 90:return[u+d+o,a-g+c+h,u+d+_+o,a-g+c+b+h];case 180:return[u-c-b+o,a-g+d+h,u-c+o,a-g+d+_+h];case 270:return[u-d-_+o,a-g-c-b+h,u-d+o,a-g-c+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,n,a]=t,o=n-i,h=a-s;switch(this.rotation){case 0:return[i,e-a,o,h];case 90:return[i,e-s,h,o];case 180:return[n,e-s,o,h];case 270:return[n,e-a,h,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){m(this,cr,!0)}disableEditMode(){m(this,cr,!1)}isInEditMode(){return r(this,cr)}shouldGetKeyboardEvents(){return r(this,qi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){p(this,Vh,Ib).call(this)}rotate(t){}serialize(t=!1,e=null){bt("An editor must be serializable")}static deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i});s.rotation=t.rotation,m(s,ar,t.accessibilityData);const[n,a]=s.pageDimensions,[o,h,c,d]=s.getRectInCurrentCoords(t.rect,a);return s.x=o/n,s.y=h/a,s.width=c/n,s.height=d/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){if(r(this,Vs)?.abort(),m(this,Vs,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),r(this,gi)&&(clearTimeout(r(this,gi)),m(this,gi,null)),p(this,dr,du).call(this),this.removeEditToolbar(),r(this,Ce)){for(const t of r(this,Ce).values())clearTimeout(t);m(this,Ce,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(p(this,If,lv).call(this),r(this,Ht).classList.remove("hidden"),Du(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||"Enter"!==t.key)return;this._uiManager.setSelected(this),m(this,lr,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=r(this,Ht).children;if(!r(this,We)){m(this,We,Array.from(e));const a=p(this,Ff,dv).bind(this),o=p(this,Nf,uv).bind(this),h=this._uiManager._signal;for(const c of r(this,We)){const d=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:h}),c.addEventListener("blur",o,{signal:h}),c.addEventListener("focus",p(this,Bf,fv).bind(this,d),{signal:h}),c.setAttribute("data-l10n-id",at._l10nResizer[d])}}const i=r(this,We)[0];let s=0;for(const a of e){if(a===i)break;s++}const n=(360-this.rotation+this.parentRotation)%360/90*(r(this,We).length/4);if(n!==s){if(n<s)for(let o=0;o<s-n;o++)r(this,Ht).append(r(this,Ht).firstChild);else if(n>s)for(let o=0;o<n-s;o++)r(this,Ht).firstChild.before(r(this,Ht).lastChild);let a=0;for(const o of e){const c=r(this,We)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",at._l10nResizer[c])}}p(this,jh,Db).call(this,0),m(this,qi,!0),r(this,Ht).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){!r(this,qi)||p(this,Bh,kb).call(this,r(this,kh),{movementX:t,movementY:e})}_stopResizingWithKeyboard(){p(this,dr,du).call(this),this.div.focus()}select(){this.makeResizable(),this.div?.classList.add("selectedEditor"),this._editToolbar?(this._editToolbar?.show(),r(this,ht)?.toggleAltTextBadge(!1)):this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()})}unselect(){r(this,Ht)?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),r(this,ht)?.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return r(this,Rh)}set isEditing(t){m(this,Rh,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){m(this,or,!0);const i=t/e,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){r(this,Ce)||m(this,Ce,new Map);const{action:i}=t;let s=r(this,Ce).get(i);return s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),r(this,Ce).delete(i),0===r(this,Ce).size&&m(this,Ce,null)},at._telemetryTimeout),void r(this,Ce).set(i,s)}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),m(this,qa,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,qa,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(e){if("CANVAS"===e.nodeName){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}}else e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);return e}resetAnnotationElement(t){const{firstChild:e}=t.container;"DIV"===e.nodeName&&e.classList.contains("annotationContent")&&e.remove()}};let G=at;ar=new WeakMap,We=new WeakMap,ht=new WeakMap,qa=new WeakMap,or=new WeakMap,Ht=new WeakMap,lr=new WeakMap,Vs=new WeakMap,kh=new WeakMap,hr=new WeakMap,js=new WeakMap,Rh=new WeakMap,cr=new WeakMap,qi=new WeakMap,gi=new WeakMap,Ka=new WeakMap,Xa=new WeakMap,Ce=new WeakMap,Ih=new WeakMap,Rf=new WeakMap,Dh=new WeakSet,Pb=function([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this.fixAndSetPosition()},Oh=new WeakSet,Tb=function(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},Fh=new WeakSet,Mb=function(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}},If=new WeakSet,lv=function(){if(r(this,Ht))return;m(this,Ht,document.createElement("div")),r(this,Ht).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const s=document.createElement("div");r(this,Ht).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",p(this,Df,hv).bind(this,i),{signal:e}),s.addEventListener("contextmenu",ve,{signal:e}),s.tabIndex=-1}this.div.prepend(r(this,Ht))},Df=new WeakSet,hv=function(t,e){e.preventDefault();const{isMac:i}=se.platform;if(0!==e.button||e.ctrlKey&&i)return;r(this,ht)?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1;const n=new AbortController,a=this._uiManager.combinedSignal(n);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",p(this,Bh,kb).bind(this,t),{passive:!0,capture:!0,signal:a}),window.addEventListener("contextmenu",ve,{signal:a});const o=this.x,h=this.y,c=this.width,d=this.height,u=this.parent.div.style.cursor,g=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const b=()=>{n.abort(),this.parent.togglePointerEvents(!0),r(this,ht)?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=u,this.div.style.cursor=g,p(this,Nh,Lb).call(this,o,h,c,d)};window.addEventListener("pointerup",b,{signal:a}),window.addEventListener("blur",b,{signal:a})},Nh=new WeakSet,Lb=function(t,e,i,s){const n=this.x,a=this.y,o=this.width,h=this.height;n===t&&a===e&&o===i&&h===s||this.addCommands({cmd:()=>{this.width=o,this.height=h,this.x=n,this.y=a;const[c,d]=this.parentDimensions;this.setDims(c*o,d*h),this.fixAndSetPosition()},undo:()=>{this.width=i,this.height=s,this.x=t,this.y=e;const[c,d]=this.parentDimensions;this.setDims(c*i,d*s),this.fixAndSetPosition()},mustExec:!0})},Bh=new WeakSet,kb=function(t,e){const[i,s]=this.parentDimensions,n=this.x,a=this.y,o=this.width,h=this.height,c=at.MIN_SIZE/i,d=at.MIN_SIZE/s,u=B=>Math.round(1e4*B)/1e4,g=p(this,Fh,Mb).call(this,this.rotation),b=(B,U)=>[g[0]*B+g[2]*U,g[1]*B+g[3]*U],_=p(this,Fh,Mb).call(this,360-this.rotation);let v,y,E=!1,x=!1;switch(t){case"topLeft":E=!0,v=(B,U)=>[0,0],y=(B,U)=>[B,U];break;case"topMiddle":v=(B,U)=>[B/2,0],y=(B,U)=>[B/2,U];break;case"topRight":E=!0,v=(B,U)=>[B,0],y=(B,U)=>[0,U];break;case"middleRight":x=!0,v=(B,U)=>[B,U/2],y=(B,U)=>[0,U/2];break;case"bottomRight":E=!0,v=(B,U)=>[B,U],y=(B,U)=>[0,0];break;case"bottomMiddle":v=(B,U)=>[B/2,U],y=(B,U)=>[B/2,0];break;case"bottomLeft":E=!0,v=(B,U)=>[0,U],y=(B,U)=>[B,0];break;case"middleLeft":x=!0,v=(B,U)=>[0,U/2],y=(B,U)=>[B,U/2]}const C=v(o,h),S=y(o,h);let P=b(...S);const L=u(n+P[0]),k=u(a+P[1]);let w=1,T=1,[D,$]=this.screenToPageTranslation(e.movementX,e.movementY);if([D,$]=[_[0]*(B=D/i)+_[2]*(U=$/s),_[1]*B+_[3]*U],E){const B=Math.hypot(o,h);w=T=Math.max(Math.min(Math.hypot(S[0]-C[0]-D,S[1]-C[1]-$)/B,1/o,1/h),c/o,d/h)}else x?w=Math.max(c,Math.min(1,Math.abs(S[0]-C[0]-D)))/o:T=Math.max(d,Math.min(1,Math.abs(S[1]-C[1]-$)))/h;var B,U;const j=u(o*w),W=u(h*T);P=b(...y(j,W));const tt=L-P[0],mt=k-P[1];this.width=j,this.height=W,this.x=tt,this.y=mt,this.setDims(i*j,s*W),this.fixAndSetPosition()},Hh=new WeakSet,Rb=function(t){const{isMac:e}=se.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},Of=new WeakSet,cv=function(t){const e=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();const i=new AbortController,s=this._uiManager.combinedSignal(i);e&&(this.div.classList.add("moving"),m(this,Ka,t.clientX),m(this,Xa,t.clientY),window.addEventListener("pointermove",o=>{const{clientX:h,clientY:c}=o,[d,u]=this.screenToPageTranslation(h-r(this,Ka),c-r(this,Xa));m(this,Ka,h),m(this,Xa,c),this._uiManager.dragSelectedEditors(d,u)},{passive:!0,capture:!0,signal:s}));const n=()=>{i.abort(),e&&this.div.classList.remove("moving"),m(this,hr,!1),this._uiManager.endDragSession()||p(this,Hh,Rb).call(this,t)};window.addEventListener("pointerup",n,{signal:s}),window.addEventListener("blur",n,{signal:s})},Vh=new WeakSet,Ib=function(){if(r(this,Vs)||!this.div)return;m(this,Vs,new AbortController);const t=this._uiManager.combinedSignal(r(this,Vs));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Ff=new WeakSet,dv=function(t){at._resizerKeyboardManager.exec(this,t)},Nf=new WeakSet,uv=function(t){r(this,qi)&&t.relatedTarget?.parentNode!==r(this,Ht)&&p(this,dr,du).call(this)},Bf=new WeakSet,fv=function(t){m(this,kh,r(this,qi)?t:"")},jh=new WeakSet,Db=function(t){if(r(this,We))for(const e of r(this,We))e.tabIndex=t},dr=new WeakSet,du=function(){if(m(this,qi,!1),p(this,jh,Db).call(this,-1),r(this,lr)){const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=r(this,lr);p(this,Nh,Lb).call(this,t,e,i,s),m(this,lr,null)}},f(G,Oh),R(G,"_l10nPromise",null),R(G,"_l10nResizer",null),R(G,"_borderLineWidth",-1),R(G,"_colorManager",new Ou),R(G,"_zIndex",1),R(G,"_telemetryTimeout",1e3);class Aw extends G{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}const eA=3285377520,we=4294901760,ii=65535;class iA{constructor(t){this.h1=t?4294967295&t:eA,this.h2=t?4294967295&t:eA}update(t){let e,i;if("string"==typeof t){e=new Uint8Array(2*t.length),i=0;for(let A=0,v=t.length;A<v;A++){const y=t.charCodeAt(A);y<=255?e[i++]=y:(e[i++]=y>>>8,e[i++]=255&y)}}else{if(!ArrayBuffer.isView(t))throw new Error("Invalid data format, must be a string or TypedArray.");e=t.slice(),i=e.byteLength}const s=i>>2,n=i-4*s,a=new Uint32Array(e.buffer,0,s);let o=0,h=0,c=this.h1,d=this.h2;const u=3432918353,g=461845907,b=u&ii,_=g&ii;for(let A=0;A<s;A++)1&A?(o=a[A],o=o*u&we|o*b&ii,o=o<<15|o>>>17,o=o*g&we|o*_&ii,c^=o,c=c<<13|c>>>19,c=5*c+3864292196):(h=a[A],h=h*u&we|h*b&ii,h=h<<15|h>>>17,h=h*g&we|h*_&ii,d^=h,d=d<<13|d>>>19,d=5*d+3864292196);switch(o=0,n){case 3:o^=e[4*s+2]<<16;case 2:o^=e[4*s+1]<<8;case 1:o^=e[4*s],o=o*u&we|o*b&ii,o=o<<15|o>>>17,o=o*g&we|o*_&ii,1&s?c^=o:d^=o}this.h1=c,this.h2=d}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=3981806797*t&we|36045*t&ii,e=4283543511*e&we|(2950163797*(e<<16|t>>>16)&we)>>>16,t^=e>>>1,t=444984403*t&we|60499*t&ii,e=3301882366*e&we|(3120437893*(e<<16|t>>>16)&we)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Pm=Object.freeze({map:null,hash:"",transfer:void 0});class Tm{constructor(){f(this,Hf),f(this,ur,!1),f(this,fr,null),f(this,Ot,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=r(this,Ot).get(t);return void 0===i?e:Object.assign(e,i)}getRawValue(t){return r(this,Ot).get(t)}remove(t){if(r(this,Ot).delete(t),0===r(this,Ot).size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const e of r(this,Ot).values())if(e instanceof G)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=r(this,Ot).get(t);let s=!1;if(void 0!==i)for(const[n,a]of Object.entries(e))i[n]!==a&&(s=!0,i[n]=a);else s=!0,r(this,Ot).set(t,e);s&&p(this,Hf,pv).call(this),e instanceof G&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type)}has(t){return r(this,Ot).has(t)}getAll(){return r(this,Ot).size>0?_m(r(this,Ot)):null}setAll(t){for(const[e,i]of Object.entries(t))this.setValue(e,i)}get size(){return r(this,Ot).size}resetModified(){r(this,ur)&&(m(this,ur,!1),"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new sA(this)}get serializable(){if(0===r(this,Ot).size)return Pm;const t=new Map,e=new iA,i=[],s=Object.create(null);let n=!1;for(const[a,o]of r(this,Ot)){const h=o instanceof G?o.serialize(!1,s):o;h&&(t.set(a,h),e.update(`${a}:${JSON.stringify(h)}`),n||(n=!!h.bitmap))}if(n)for(const a of t.values())a.bitmap&&i.push(a.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:Pm}get editorStats(){let t=null;const e=new Map;for(const i of r(this,Ot).values()){if(!(i instanceof G))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:n}=s;e.has(n)||e.set(n,Object.getPrototypeOf(i).constructor),t||(t=Object.create(null));const a=t[n]||(t[n]=new Map);for(const[o,h]of Object.entries(s)){if("type"===o)continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const d=c.get(h)??0;c.set(h,d+1)}}for(const[i,s]of e)t[i]=s.computeTelemetryFinalData(t[i]);return t}resetModifiedIds(){m(this,fr,null)}get modifiedIds(){if(r(this,fr))return r(this,fr);const t=[];for(const e of r(this,Ot).values())!(e instanceof G)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return m(this,fr,{ids:new Set(t),hash:t.join(",")})}}ur=new WeakMap,fr=new WeakMap,Ot=new WeakMap,Hf=new WeakSet,pv=function(){r(this,ur)||(m(this,ur,!0),"function"==typeof this.onSetModified&&this.onSetModified())};class sA extends Tm{constructor(e){super(),f(this,Uh,void 0);const{map:i,hash:s,transfer:n}=e.serializable,a=structuredClone(i,n?{transfer:n}:null);m(this,Uh,{map:a,hash:s,transfer:n})}get print(){bt("Should not call PrintAnnotationStorage.print")}get serializable(){return r(this,Uh)}get modifiedIds(){return Y(this,"modifiedIds",{ids:new Set,hash:""})}}Uh=new WeakMap;class yw{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){f(this,Ya,new Set),this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),r(this,Ya).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}loadSystemFont({systemFontInfo:t,_inspectFont:e}){var i=this;return(0,I.Z)(function*(){if(t&&!r(i,Ya).has(t.loadedName)){if(wt(!i.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),i.isFontLoadingAPISupported){const{loadedName:s,src:n,style:a}=t,o=new FontFace(s,n,a);i.addNativeFontFace(o);try{yield o.load(),r(i,Ya).add(s),e?.(t)}catch{z(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),i.removeNativeFontFace(o)}return}bt("Not implemented: loadSystemFont without the Font Loading API.")}})()}bind(t){var e=this;return(0,I.Z)(function*(){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo)return void(yield e.loadSystemFont(t));if(e.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){e.addNativeFontFace(s);try{yield s.loaded}catch(n){throw z(`Failed to load font '${s.family}': '${n}'.`),t.disableFontFace=!0,n}}return}const i=t.createFontFaceRule();if(i){if(e.insertRule(i),e.isSyncFontLoadingSupported)return;yield new Promise(s=>{const n=e._queueLoadingCallback(s);e._prepareFontLoadEvent(t,n)})}})()}get isFontLoadingAPISupported(){return Y(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){let t=!1;return(zt||typeof navigator<"u"&&"string"==typeof navigator?.userAgent&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),Y(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){const{loadingRequests:i}=this,s={done:!1,complete:function e(){for(wt(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const n=i.shift();setTimeout(n.callback,0)}},callback:t};return i.push(s),s}get _loadTestFont(){return Y(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(t,e){function i(C,S){return C.charCodeAt(S)<<24|C.charCodeAt(S+1)<<16|C.charCodeAt(S+2)<<8|255&C.charCodeAt(S+3)}function s(C,S,P,L){return C.substring(0,S)+L+C.substring(S+P)}let n,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const h=o.getContext("2d");let c=0;const u=`lt${Date.now()}${this.loadTestFontId++}`;let g=this._loadTestFont;g=s(g,976,u.length,u);const A=1482184792;let v=i(g,16);for(n=0,a=u.length-3;n<a;n+=4)v=v-A+i(u,n)|0;n<u.length&&(v=v-A+i(u+"XXX",n)|0),g=s(g,16,4,function ew(l){return String.fromCharCode(l>>24&255,l>>16&255,l>>8&255,255&l)}(v));const y=`url(data:font/opentype;base64,${btoa(g)});`;this.insertRule(`@font-face {font-family:"${u}";src:${y}}`);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const C of[t.loadedName,u]){const S=this._document.createElement("span");S.textContent="Hi",S.style.fontFamily=C,x.append(S)}this._document.body.append(x),function d(C,S){if(++c>30)return z("Load test font never loaded."),void S();h.font="30px "+C,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0?S():setTimeout(d.bind(null,C,S))}(u,()=>{x.remove(),e.complete()})}}Ya=new WeakMap;class vw{constructor(t,{disableFontFace:e=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const s in t)this[s]=t[s];this.disableFontFace=!0===e,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=z_(this.data),e=`url(data:${this.mimetype};base64,${btoa(t)});`;let i;if(this.cssFontInfo){let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}else i=`@font-face {font-family:"${this.loadedName}";src:${e}}`;return this._inspectFont?.(this,e),i}getPathGenerator(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];let i;try{i=t.get(this.loadedName+"_path_"+e)}catch(n){z(`getPathGenerator - ignoring character: "${n}".`)}if(!Array.isArray(i)||0===i.length)return this.compiledGlyphs[e]=function(n,a){};const s=[];for(let n=0,a=i.length;n<a;)switch(i[n++]){case 0:{const[o,h,c,d,u,g]=i.slice(n,n+6);s.push(b=>b.bezierCurveTo(o,h,c,d,u,g)),n+=6}break;case 1:{const[o,h]=i.slice(n,n+2);s.push(c=>c.moveTo(o,h)),n+=2}break;case 2:{const[o,h]=i.slice(n,n+2);s.push(c=>c.lineTo(o,h)),n+=2}break;case 3:{const[o,h,c,d]=i.slice(n,n+4);s.push(u=>u.quadraticCurveTo(o,h,c,d)),n+=4}break;case 4:s.push(o=>o.restore());break;case 5:s.push(o=>o.save());break;case 6:wt(2===s.length,"Scale command is only valid at the third position.");break;case 7:{const[o,h,c,d,u,g]=i.slice(n,n+6);s.push(b=>b.transform(o,h,c,d,u,g)),n+=6}break;case 8:{const[o,h]=i.slice(n,n+2);s.push(c=>c.translate(o,h)),n+=2}}return this.compiledGlyphs[e]=function(a,o){s[0](a),s[1](a),a.scale(o,-o);for(let h=2,c=s.length;h<c;h++)s[h](a)}}}if(zt){var Mm=Promise.withResolvers(),Lm=null;(function(){var t=(0,I.Z)(function*(){const e=yield import("fs"),i=yield import("http"),s=yield import("https"),n=yield import("url");return new Map(Object.entries({fs:e,http:i,https:s,url:n,canvas:void 0,path2d:void 0}))});return function(){return t.apply(this,arguments)}})()().then(t=>{Lm=t,Mm.resolve()},t=>{z(`loadPackages: ${t}`),Lm=new Map,Mm.resolve()})}class Cs{static get promise(){return Mm.promise}static get(t){return Lm?.get(t)}}const nA=function(l){return Cs.get("fs").promises.readFile(l).then(e=>new Uint8Array(e))};function km(l,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),l.clip(s)}class Rm{getPattern(){bt("Abstract method `getPattern` called.")}}class Sw extends Rm{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,s){let n;if("Stroke"===s||"Fill"===s){const a=e.current.getClippedPathBoundingBox(s,ot(t))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,h=Math.ceil(a[3]-a[1])||1,c=e.cachedCanvases.getCanvas("pattern",o,h,!0),d=c.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-a[0],-a[1]),i=O.transform(i,[1,0,0,1,a[0],a[1]]),d.transform(...e.baseTransform),this.matrix&&d.transform(...this.matrix),km(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),n=t.createPattern(c.canvas,"no-repeat");const u=new DOMMatrix(i);n.setTransform(u)}else km(t,this._bbox),n=this._createGradient(t);return n}}function Im(l,t,e,i,s,n,a,o){const h=t.coords,c=t.colors,d=l.data,u=4*l.width;let g;h[e+1]>h[i+1]&&(g=e,e=i,i=g,g=n,n=a,a=g),h[i+1]>h[s+1]&&(g=i,i=s,s=g,g=a,a=o,o=g),h[e+1]>h[i+1]&&(g=e,e=i,i=g,g=n,n=a,a=g);const b=(h[e]+t.offsetX)*t.scaleX,_=(h[e+1]+t.offsetY)*t.scaleY,A=(h[i]+t.offsetX)*t.scaleX,v=(h[i+1]+t.offsetY)*t.scaleY,y=(h[s]+t.offsetX)*t.scaleX,E=(h[s+1]+t.offsetY)*t.scaleY;if(_>=E)return;const x=c[n],C=c[n+1],S=c[n+2],P=c[a],L=c[a+1],k=c[a+2],w=c[o],T=c[o+1],D=c[o+2],$=Math.round(_),j=Math.round(E);let W,tt,mt,B,U,Pg,Tg,Mg;for(let te=$;te<=j;te++){if(te<v){const Mt=te<_?0:(_-te)/(_-v);W=b-(b-A)*Mt,tt=x-(x-P)*Mt,mt=C-(C-L)*Mt,B=S-(S-k)*Mt}else{let Mt;Mt=te>E?1:v===E?0:(v-te)/(v-E),W=A-(A-y)*Mt,tt=P-(P-w)*Mt,mt=L-(L-T)*Mt,B=k-(k-D)*Mt}let Ut;Ut=te<_?0:te>E?1:(_-te)/(_-E),U=b-(b-y)*Ut,Pg=x-(x-w)*Ut,Tg=C-(C-T)*Ut,Mg=S-(S-D)*Ut;const Lg=Math.round(Math.min(W,U)),wa=Math.round(Math.max(W,U));let Mn=u*te+4*Lg;for(let Mt=Lg;Mt<=wa;Mt++)Ut=(W-Mt)/(W-U),Ut<0?Ut=0:Ut>1&&(Ut=1),d[Mn++]=tt-(tt-Pg)*Ut|0,d[Mn++]=mt-(mt-Tg)*Ut|0,d[Mn++]=B-(B-Mg)*Ut|0,d[Mn++]=255}}function Pw(l,t,e){const i=t.coords,s=t.colors;let n,a;switch(t.type){case"lattice":const o=t.verticesPerRow,h=Math.floor(i.length/o)-1,c=o-1;for(n=0;n<h;n++){let d=n*o;for(let u=0;u<c;u++,d++)Im(l,e,i[d],i[d+1],i[d+o],s[d],s[d+1],s[d+o]),Im(l,e,i[d+o+1],i[d+1],i[d+o],s[d+o+1],s[d+1],s[d+o])}break;case"triangles":for(n=0,a=i.length;n<a;n+=3)Im(l,e,i[n],i[n+1],i[n+2],s[n],s[n+1],s[n+2]);break;default:throw new Error("illegal figure")}}class Tw extends Rm{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,i){const o=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,d=Math.ceil(this._bounds[3])-h,u=Math.min(Math.ceil(Math.abs(c*t[0]*1.1)),3e3),g=Math.min(Math.ceil(Math.abs(d*t[1]*1.1)),3e3),b=c/u,_=d/g,A={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-h,scaleX:1/b,scaleY:1/_},E=i.getCanvas("mesh",u+4,g+4,!1),x=E.context,C=x.createImageData(u,g);if(e){const P=C.data;for(let L=0,k=P.length;L<k;L+=4)P[L]=e[0],P[L+1]=e[1],P[L+2]=e[2],P[L+3]=255}for(const P of this._figures)Pw(C,P,A);return x.putImageData(C,2,2),{canvas:E.canvas,offsetX:o-2*b,offsetY:h-2*_,scaleX:b,scaleY:_}}getPattern(t,e,i,s){let n;if(km(t,this._bbox),"Shading"===s)n=O.singularValueDecompose2dScale(ot(t));else if(n=O.singularValueDecompose2dScale(e.baseTransform),this.matrix){const o=O.singularValueDecompose2dScale(this.matrix);n=[n[0]*o[0],n[1]*o[1]]}const a=this._createMeshCanvas(n,"Shading"===s?null:this._background,e.cachedCanvases);return"Shading"!==s&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(a.offsetX,a.offsetY),t.scale(a.scaleX,a.scaleY),t.createPattern(a.canvas,"no-repeat")}}class Mw extends Rm{getPattern(){return"hotpink"}}const ab=class{constructor(t,e,i,s,n){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=n}createPatternCanvas(t){const e=this.operatorList,i=this.bbox,s=this.xstep,n=this.ystep,a=this.paintType,h=this.color,c=this.canvasGraphicsFactory;Lu("TilingType: "+this.tilingType);const d=i[0],u=i[1],g=i[2],b=i[3],_=O.singularValueDecompose2dScale(this.matrix),A=O.singularValueDecompose2dScale(this.baseTransform),v=[_[0]*A[0],_[1]*A[1]],y=this.getSizeAndScale(s,this.ctx.canvas.width,v[0]),E=this.getSizeAndScale(n,this.ctx.canvas.height,v[1]),x=t.cachedCanvases.getCanvas("pattern",y.size,E.size,!0),C=x.context,S=c.createCanvasGraphics(C);S.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(S,a,h);let P=d,L=u,k=g,w=b;return d<0&&(P=0,k+=Math.abs(d)),u<0&&(L=0,w+=Math.abs(u)),C.translate(-y.scale*P,-E.scale*L),S.transform(y.scale,0,0,E.scale,0,0),C.save(),this.clipBbox(S,P,L,k,w),S.baseTransform=ot(S.ctx),S.executeOperatorList(e),S.endDrawing(),{canvas:x.canvas,scaleX:y.scale,scaleY:E.scale,offsetX:P,offsetY:L}}getSizeAndScale(t,e,i){t=Math.abs(t);const s=Math.max(ab.MAX_PATTERN_SIZE,e);let n=Math.ceil(t*i);return n>=s?n=s:i=n/t,{scale:i,size:n}}clipBbox(t,e,i,s,n){t.ctx.rect(e,i,s-e,n-i),t.current.updateRectMinMax(ot(t.ctx),[e,i,s,n]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,n=t.current;switch(e){case 1:const a=this.ctx;s.fillStyle=a.fillStyle,s.strokeStyle=a.strokeStyle,n.fillColor=a.fillStyle,n.strokeColor=a.strokeStyle;break;case 2:const o=O.makeHexColor(i[0],i[1],i[2]);s.fillStyle=o,s.strokeStyle=o,n.fillColor=o,n.strokeColor=o;break;default:throw new tw(`Unsupported paint type: ${e}`)}}getPattern(t,e,i,s){let n=i;"Shading"!==s&&(n=O.transform(n,e.baseTransform),this.matrix&&(n=O.transform(n,this.matrix)));const a=this.createPatternCanvas(e);let o=new DOMMatrix(n);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const h=t.createPattern(a.canvas,"repeat");return h.setTransform(o),h}};let Fu=ab;function aA({src:l,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:n=4294967295,inverseDecode:a=!1}){const o=se.isLittleEndian?4278190080:255,[h,c]=a?[n,o]:[o,n],d=i>>3,u=7&i,g=l.length;e=new Uint32Array(e.buffer);let b=0;for(let _=0;_<s;_++){for(const v=t+d;t<v;t++){const y=t<g?l[t]:255;e[b++]=128&y?c:h,e[b++]=64&y?c:h,e[b++]=32&y?c:h,e[b++]=16&y?c:h,e[b++]=8&y?c:h,e[b++]=4&y?c:h,e[b++]=2&y?c:h,e[b++]=1&y?c:h}if(0===u)continue;const A=t<g?l[t++]:255;for(let v=0;v<u;v++)e[b++]=A&1<<7-v?c:h}return{srcPos:t,destPos:b}}R(Fu,"MAX_PATTERN_SIZE",3e3);class Dw{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return void 0!==this.cache[t]?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache)this.canvasFactory.destroy(this.cache[t]),delete this.cache[t]}}function Nu(l,t,e,i,s,n,a,o,h,c){const[d,u,g,b,_,A]=ot(l);if(0===u&&0===g){const x=Math.round(a*d+_),S=Math.round(o*b+A),L=Math.abs(Math.round((a+h)*d+_)-x)||1,w=Math.abs(Math.round((o+c)*b+A)-S)||1;return l.setTransform(Math.sign(d),0,0,Math.sign(b),x,S),l.drawImage(t,e,i,s,n,0,0,L,w),l.setTransform(d,u,g,b,_,A),[L,w]}if(0===d&&0===b){const x=Math.round(o*g+_),S=Math.round(a*u+A),L=Math.abs(Math.round((o+c)*g+_)-x)||1,w=Math.abs(Math.round((a+h)*u+A)-S)||1;return l.setTransform(0,Math.sign(u),Math.sign(g),0,x,S),l.drawImage(t,e,i,s,n,0,0,w,L),l.setTransform(d,u,g,b,_,A),[w,L]}return l.drawImage(t,e,i,s,n,a,o,h,c),[Math.hypot(d,u)*h,Math.hypot(g,b)*c]}class dA{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=j_,this.textMatrixScale=1,this.fontMatrix=pm,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=0,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,i){[e,i]=O.applyTransform([e,i],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(t,e){const i=O.applyTransform(e,t),s=O.applyTransform(e.slice(2),t),n=O.applyTransform([e[0],e[3]],t),a=O.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,i[0],s[0],n[0],a[0]),this.minY=Math.min(this.minY,i[1],s[1],n[1],a[1]),this.maxX=Math.max(this.maxX,i[0],s[0],n[0],a[0]),this.maxY=Math.max(this.maxY,i[1],s[1],n[1],a[1])}updateScalingPathMinMax(t,e){O.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,i,s,n,a,o,h,c,d){const u=O.bezierBoundingBox(e,i,s,n,a,o,h,c,d);d||this.updateRectMinMax(t,u)}getPathBoundingBox(t="Fill",e=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if("Stroke"===t){e||bt("Stroke bounding box must include transform.");const s=O.singularValueDecompose2dScale(e),n=s[0]*this.lineWidth/2,a=s[1]*this.lineWidth/2;i[0]-=n,i[1]-=a,i[2]+=n,i[3]+=a}return i}updateClipFromPath(){const t=O.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t="Fill",e=null){return O.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function uA(l,t){if(typeof ImageData<"u"&&t instanceof ImageData)return void l.putImageData(t,0,0);const e=t.height,i=t.width,s=e%16,n=(e-s)/16,a=0===s?n:n+1,o=l.createImageData(i,16);let c,h=0;const d=t.data,u=o.data;let g,b,_,A;if(t.kind===Pu.GRAYSCALE_1BPP){const v=d.byteLength,y=new Uint32Array(u.buffer,0,u.byteLength>>2),E=y.length,x=i+7>>3,C=4294967295,S=se.isLittleEndian?4278190080:255;for(g=0;g<a;g++){for(_=g<n?16:s,c=0,b=0;b<_;b++){const P=v-h;let L=0;const k=P>x?i:8*P-7,w=-8&k;let T=0,D=0;for(;L<w;L+=8)D=d[h++],y[c++]=128&D?C:S,y[c++]=64&D?C:S,y[c++]=32&D?C:S,y[c++]=16&D?C:S,y[c++]=8&D?C:S,y[c++]=4&D?C:S,y[c++]=2&D?C:S,y[c++]=1&D?C:S;for(;L<k;L++)0===T&&(D=d[h++],T=128),y[c++]=D&T?C:S,T>>=1}for(;c<E;)y[c++]=0;l.putImageData(o,0,16*g)}}else if(t.kind===Pu.RGBA_32BPP){for(b=0,A=16*i*4,g=0;g<n;g++)u.set(d.subarray(h,h+A)),h+=A,l.putImageData(o,0,b),b+=16;g<a&&(A=i*s*4,u.set(d.subarray(h,h+A)),l.putImageData(o,0,b))}else{if(t.kind!==Pu.RGB_24BPP)throw new Error(`bad image kind: ${t.kind}`);for(_=16,A=i*_,g=0;g<a;g++){for(g>=n&&(_=s,A=i*_),c=0,b=A;b--;)u[c++]=d[h++],u[c++]=d[h++],u[c++]=d[h++],u[c++]=255;l.putImageData(o,0,16*g)}}}function fA(l,t){if(t.bitmap)return void l.drawImage(t.bitmap,0,0);const e=t.height,i=t.width,s=e%16,n=(e-s)/16,a=0===s?n:n+1,o=l.createImageData(i,16);let h=0;const c=t.data,d=o.data;for(let u=0;u<a;u++){const g=u<n?16:s;({srcPos:h}=aA({src:c,srcPos:h,dest:d,width:i,height:g,nonBlackColor:0})),l.putImageData(o,0,16*u)}}function Ul(l,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)void 0!==l[i]&&(t[i]=l[i]);void 0!==l.setLineDash&&(t.setLineDash(l.getLineDash()),t.lineDashOffset=l.lineDashOffset)}function Bu(l){if(l.strokeStyle=l.fillStyle="#000000",l.fillRule="nonzero",l.globalAlpha=1,l.lineWidth=1,l.lineCap="butt",l.lineJoin="miter",l.miterLimit=10,l.globalCompositeOperation="source-over",l.font="10px sans-serif",void 0!==l.setLineDash&&(l.setLineDash([]),l.lineDashOffset=0),!zt){const{filter:t}=l;"none"!==t&&""!==t&&(l.filter="none")}}function pA(l,t){if(t)return!0;const e=O.singularValueDecompose2dScale(l);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*Ie.PDF_TO_CSS_UNITS);return e[0]<=i&&e[1]<=i}const Fw=["butt","round","square"],Nw=["miter","round","bevel"],Bw={},gA={},ob=class{constructor(t,e,i,s,n,{optionalContentConfig:a,markedContentStack:o=null},h,c){f(this,zh),f(this,Wh),this.ctx=t,this.current=new dA(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new Dw(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return"string"==typeof t?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const n=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,n,a),this.ctx.fillStyle=o,i){const h=this.cachedCanvases.getCanvas("transparent",n,a);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...ot(this.compositeCtx))}this.ctx.save(),Bu(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ot(this.ctx)}executeOperatorList(t,e,i,s){const n=t.argsArray,a=t.fnArray;let o=e||0;const h=n.length;if(h===o)return o;const c=h-o>10&&"function"==typeof i,d=c?Date.now()+15:0;let u=0;const g=this.commonObjs,b=this.objs;let _;for(;;){if(void 0!==s&&o===s.nextBreakPoint)return s.breakIt(o,i),o;if(_=a[o],_!==Re.dependency)this[_].apply(this,n[o]);else for(const A of n[o]){const v=A.startsWith("g_")?g:b;if(!v.has(A))return v.get(A,i),o}if(o++,o===h)return o;if(c&&++u>10){if(Date.now()>d)return i(),o;u=0}}}endDrawing(){p(this,zh,Ob).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),p(this,Wh,Fb).call(this)}_scaleImage(t,e){const i=t.width,s=t.height;let d,u,n=Math.max(Math.hypot(e[0],e[1]),1),a=Math.max(Math.hypot(e[2],e[3]),1),o=i,h=s,c="prescale1";for(;n>2&&o>1||a>2&&h>1;){let g=o,b=h;n>2&&o>1&&(g=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),n/=o/g),a>2&&h>1&&(b=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,a/=h/b),d=this.cachedCanvases.getCanvas(c,g,b),u=d.context,u.clearRect(0,0,g,b),u.drawImage(t,0,0,o,h,0,0,g,b),t=d.canvas,o=g,h=b,c="prescale1"===c?"prescale2":"prescale1"}return{img:t,paintWidth:o,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:i,height:s}=t,n=this.current.fillColor,a=this.current.patternFill,o=ot(e);let h,c,d,u;if((t.bitmap||t.data)&&t.count>1){const k=t.bitmap||t.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),n]),h=this._cachedBitmapsMap.get(k),h||(h=new Map,this._cachedBitmapsMap.set(k,h));const w=h.get(c);if(w&&!a)return{canvas:w,offsetX:Math.round(Math.min(o[0],o[2])+o[4]),offsetY:Math.round(Math.min(o[1],o[3])+o[5])};d=w}d||(u=this.cachedCanvases.getCanvas("maskCanvas",i,s),fA(u.context,t));let g=O.transform(o,[1/i,0,0,-1/s,0,0]);g=O.transform(g,[1,0,0,1,0,-s]);const[b,_,A,v]=O.getAxialAlignedBoundingBox([0,0,i,s],g),y=Math.round(A-b)||1,E=Math.round(v-_)||1,x=this.cachedCanvases.getCanvas("fillCanvas",y,E),C=x.context,S=b,P=_;C.translate(-S,-P),C.transform(...g),d||(d=this._scaleImage(u.canvas,Oi(C)),d=d.img,h&&a&&h.set(c,d)),C.imageSmoothingEnabled=pA(ot(C),t.interpolate),Nu(C,d,0,0,d.width,d.height,0,0,i,s),C.globalCompositeOperation="source-in";const L=O.transform(Oi(C),[1,0,0,1,-S,-P]);return C.fillStyle=a?n.getPattern(e,this,L,"Fill"):n,C.fillRect(0,0,i,s),h&&!a&&(this.cachedCanvases.delete("fillCanvas"),h.set(c,x.canvas)),{canvas:x.canvas,offsetX:Math.round(S),offsetY:Math.round(P)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Fw[t]}setLineJoin(t){this.ctx.lineJoin=Nw[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const i=this.ctx;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,i]of t)switch(e){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.cachedCanvases.getCanvas("smaskGroupAt"+this.groupLevel,this.ctx.canvas.width,this.ctx.canvas.height);this.suspendedCtx=this.ctx,this.ctx=s.context;const n=this.ctx;n.setTransform(...ot(this.suspendedCtx)),Ul(this.suspendedCtx,n),function Iw(l,t){if(l._removeMirroring)throw new Error("Context is already forwarding operations.");l.__originalSave=l.save,l.__originalRestore=l.restore,l.__originalRotate=l.rotate,l.__originalScale=l.scale,l.__originalTranslate=l.translate,l.__originalTransform=l.transform,l.__originalSetTransform=l.setTransform,l.__originalResetTransform=l.resetTransform,l.__originalClip=l.clip,l.__originalMoveTo=l.moveTo,l.__originalLineTo=l.lineTo,l.__originalBezierCurveTo=l.bezierCurveTo,l.__originalRect=l.rect,l.__originalClosePath=l.closePath,l.__originalBeginPath=l.beginPath,l._removeMirroring=()=>{l.save=l.__originalSave,l.restore=l.__originalRestore,l.rotate=l.__originalRotate,l.scale=l.__originalScale,l.translate=l.__originalTranslate,l.transform=l.__originalTransform,l.setTransform=l.__originalSetTransform,l.resetTransform=l.__originalResetTransform,l.clip=l.__originalClip,l.moveTo=l.__originalMoveTo,l.lineTo=l.__originalLineTo,l.bezierCurveTo=l.__originalBezierCurveTo,l.rect=l.__originalRect,l.closePath=l.__originalClosePath,l.beginPath=l.__originalBeginPath,delete l._removeMirroring},l.save=function(){t.save(),this.__originalSave()},l.restore=function(){t.restore(),this.__originalRestore()},l.translate=function(i,s){t.translate(i,s),this.__originalTranslate(i,s)},l.scale=function(i,s){t.scale(i,s),this.__originalScale(i,s)},l.transform=function(i,s,n,a,o,h){t.transform(i,s,n,a,o,h),this.__originalTransform(i,s,n,a,o,h)},l.setTransform=function(i,s,n,a,o,h){t.setTransform(i,s,n,a,o,h),this.__originalSetTransform(i,s,n,a,o,h)},l.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},l.rotate=function(i){t.rotate(i),this.__originalRotate(i)},l.clip=function(i){t.clip(i),this.__originalClip(i)},l.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},l.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},l.bezierCurveTo=function(e,i,s,n,a,o){t.bezierCurveTo(e,i,s,n,a,o),this.__originalBezierCurveTo(e,i,s,n,a,o)},l.rect=function(e,i,s,n){t.rect(e,i,s,n),this.__originalRect(e,i,s,n)},l.closePath=function(){t.closePath(),this.__originalClosePath()},l.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ul(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){this.current.activeSMask&&(t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height],this.composeSMask(this.suspendedCtx,this.current.activeSMask,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore())}composeSMask(t,e,i,s){const n=s[0],a=s[1],o=s[2]-n,h=s[3]-a;0===o||0===h||(this.genericComposeSMask(e.context,i,o,h,e.subtype,e.backdrop,e.transferMap,n,a,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,n,a,o,h,c,d,u){let g=t.canvas,b=h-d,_=c-u;if(a)if(b<0||_<0||b+i>g.width||_+s>g.height){const v=this.cachedCanvases.getCanvas("maskExtension",i,s),y=v.context;y.drawImage(g,-b,-_),a.some(E=>0!==E)&&(y.globalCompositeOperation="destination-atop",y.fillStyle=O.makeHexColor(...a),y.fillRect(0,0,i,s),y.globalCompositeOperation="source-over"),g=v.canvas,b=_=0}else if(a.some(v=>0!==v)){t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(b,_,i,s),t.clip(v),t.globalCompositeOperation="destination-atop",t.fillStyle=O.makeHexColor(...a),t.fillRect(b,_,i,s),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),"Alpha"===n&&o?e.filter=this.filterFactory.addAlphaFilter(o):"Luminosity"===n&&(e.filter=this.filterFactory.addLuminosityFilter(o));const A=new Path2D;A.rect(h,c,i,s),e.clip(A),e.globalCompositeOperation="destination-in",e.drawImage(g,b,_,i,s,h,c,i,s),e.restore()}save(){this.inSMaskMode?(Ul(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Ul(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,i,s,n,a){this.ctx.transform(t,e,i,s,n,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i){const s=this.ctx,n=this.current;let h,c,a=n.x,o=n.y;const d=ot(s),u=0===d[0]&&0===d[3]||0===d[1]&&0===d[2],g=u?i.slice(0):null;for(let b=0,_=0,A=t.length;b<A;b++)switch(0|t[b]){case Re.rectangle:a=e[_++],o=e[_++];const v=e[_++],y=e[_++],E=a+v,x=o+y;s.moveTo(a,o),0===v||0===y?s.lineTo(E,x):(s.lineTo(E,o),s.lineTo(E,x),s.lineTo(a,x)),u||n.updateRectMinMax(d,[a,o,E,x]),s.closePath();break;case Re.moveTo:a=e[_++],o=e[_++],s.moveTo(a,o),u||n.updatePathMinMax(d,a,o);break;case Re.lineTo:a=e[_++],o=e[_++],s.lineTo(a,o),u||n.updatePathMinMax(d,a,o);break;case Re.curveTo:h=a,c=o,a=e[_+4],o=e[_+5],s.bezierCurveTo(e[_],e[_+1],e[_+2],e[_+3],a,o),n.updateCurvePathMinMax(d,h,c,e[_],e[_+1],e[_+2],e[_+3],a,o,g),_+=6;break;case Re.curveTo2:h=a,c=o,s.bezierCurveTo(a,o,e[_],e[_+1],e[_+2],e[_+3]),n.updateCurvePathMinMax(d,h,c,a,o,e[_],e[_+1],e[_+2],e[_+3],g),a=e[_+2],o=e[_+3],_+=4;break;case Re.curveTo3:h=a,c=o,a=e[_+2],o=e[_+3],s.bezierCurveTo(e[_],e[_+1],a,o,a,o),n.updateCurvePathMinMax(d,h,c,e[_],e[_+1],a,o,a,o,g),_+=4;break;case Re.closePath:s.closePath()}u&&n.updateScalingPathMinMax(d,g),n.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,i=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof i&&i?.getPattern?(e.save(),e.strokeStyle=i.getPattern(e,this,Oi(e),"Stroke"),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,i=this.current.fillColor;let n=!1;this.current.patternFill&&(e.save(),e.fillStyle=i.getPattern(e,this,Oi(e),"Fill"),n=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==a&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),n&&e.restore(),t&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Bw}eoClip(){this.pendingClip=gA}beginText(){this.current.textMatrix=j_,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(void 0!==t){e.save(),e.beginPath();for(const i of t)e.setTransform(...i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize);e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}else e.beginPath()}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||pm,(0===s.fontMatrix[0]||0===s.fontMatrix[3])&&z("Invalid font matrix for font "+t),e<0?(e=-e,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const a=i.systemFontInfo?.css||`"${i.loadedName||"sans-serif"}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const h=i.italic?"italic":"normal";let c=e;e<16?c=16:e>100&&(c=100),this.current.fontSizeScale=e/c,this.ctx.font=`${h} ${o} ${c}px ${a}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,i,s,n,a){this.current.textMatrix=[t,e,i,s,n,a],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,i,s){const n=this.ctx,a=this.current,o=a.font,h=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,d=3&h,u=!!(4&h),g=a.patternFill&&!o.missingFile;let b;(o.disableFontFace||u||g)&&(b=o.getPathGenerator(this.commonObjs,t)),o.disableFontFace||g?(n.save(),n.translate(e,i),n.beginPath(),b(n,c),s&&n.setTransform(...s),(0===d||2===d)&&n.fill(),(1===d||2===d)&&n.stroke(),n.restore()):((0===d||2===d)&&n.fillText(t,e,i),(1===d||2===d)&&n.strokeText(t,e,i)),u&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ot(n),x:e,y:i,fontSize:c,addToPath:b})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return Y(this,"isFontSubpixelAAEnabled",i)}showText(t){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(t);const s=e.fontSize;if(0===s)return;const n=this.ctx,a=e.fontSizeScale,o=e.charSpacing,h=e.wordSpacing,c=e.fontDirection,d=e.textHScale*c,u=t.length,g=i.vertical,b=g?1:-1,_=i.defaultVMetrics,A=s*e.fontMatrix[0],v=0===e.textRenderingMode&&!i.disableFontFace&&!e.patternFill;let y;if(n.save(),n.transform(...e.textMatrix),n.translate(e.x,e.y+e.textRise),n.scale(d,c>0?-1:1),e.patternFill){n.save();const P=e.fillColor.getPattern(n,this,Oi(n),"Fill");y=ot(n),n.restore(),n.fillStyle=P}let E=e.lineWidth;const x=e.textMatrixScale;if(0===x||0===E){const P=3&e.textRenderingMode;(1===P||2===P)&&(E=this.getSinglePixelWidth())}else E/=x;if(1!==a&&(n.scale(a,a),E/=a),n.lineWidth=E,i.isInvalidPDFjsFont){const P=[];let L=0;for(const k of t)P.push(k.unicode),L+=k.width;return n.fillText(P.join(""),0,0),e.x+=L*A*d,n.restore(),void this.compose()}let S,C=0;for(S=0;S<u;++S){const P=t[S];if("number"==typeof P){C+=b*P*s/1e3;continue}let L=!1;const k=(P.isSpace?h:0)+o,w=P.fontChar,T=P.accent;let D,$,j=P.width;if(g){const tt=P.vmetric||_,mt=-(P.vmetric?tt[1]:.5*j)*A;j=tt?-tt[0]:j,D=mt/a,$=(C+tt[2]*A)/a}else D=C/a,$=0;if(i.remeasure&&j>0){const tt=1e3*n.measureText(w).width/s*a;if(j<tt&&this.isFontSubpixelAAEnabled){const mt=j/tt;L=!0,n.save(),n.scale(mt,1),D/=mt}else j!==tt&&(D+=(j-tt)/2e3*s/a)}this.contentVisible&&(P.isInFont||i.missingFile)&&(v&&!T?n.fillText(w,D,$):(this.paintChar(w,D,$,y),T&&this.paintChar(T.fontChar,D+s*T.offset.x/a,$-s*T.offset.y/a,y))),C+=g?j*A-k*c:j*A+k*c,L&&n.restore()}g?e.y-=C:e.x+=C*d,n.restore(),this.compose()}showType3Text(t){const e=this.ctx,i=this.current,s=i.font,n=i.fontSize,a=i.fontDirection,o=s.vertical?1:-1,h=i.charSpacing,c=i.wordSpacing,d=i.textHScale*a,u=i.fontMatrix||pm,g=t.length;let _,A,v,y;if(3!==i.textRenderingMode&&0!==n){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...i.textMatrix),e.translate(i.x,i.y),e.scale(d,a),_=0;_<g;++_){if(A=t[_],"number"==typeof A){y=o*A*n/1e3,this.ctx.translate(y,0),i.x+=y*d;continue}const E=(A.isSpace?c:0)+h,x=s.charProcOperatorList[A.operatorListId];x?(this.contentVisible&&(this.processingType3=A,this.save(),e.scale(n,n),e.transform(...u),this.executeOperatorList(x),this.restore()),v=O.applyTransform([A.width,0],u)[0]*n+E,e.translate(v,0),i.x+=v*d):z(`Type3 character "${A.operatorListId}" is not available.`)}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,i,s,n,a){this.ctx.rect(i,s,n-i,a-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if("TilingPattern"===t[0]){const i=t[1],s=this.baseTransform||ot(this.ctx);e=new Fu(t,i,this.ctx,{createCanvasGraphics:a=>new ob(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})},s)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,i){this.ctx.strokeStyle=this.current.strokeColor=O.makeHexColor(t,e,i)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(t,e,i){this.ctx.fillStyle=this.current.fillColor=O.makeHexColor(t,e,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=function Lw(l){switch(l[0]){case"RadialAxial":return new Sw(l);case"Mesh":return new Tw(l);case"Dummy":return new Mw}throw new Error(`Unknown IR type: ${l[0]}`)}(this.getObject(t)),this.cachedPatterns.set(t,i)),e&&(i.matrix=e),i}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(t);e.fillStyle=i.getPattern(e,this,Oi(e),"Shading");const s=Oi(e);if(s){const{width:n,height:a}=e.canvas,[o,h,c,d]=O.getAxialAlignedBoundingBox([0,0,n,a],s);this.ctx.fillRect(o,h,c-o,d-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){bt("Should not call beginInlineImage")}beginImageData(){bt("Should not call beginImageData")}paintFormXObjectBegin(t,e){this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=ot(this.ctx),e)&&(this.ctx.rect(e[0],e[1],e[2]-e[0],e[3]-e[1]),this.current.updateRectMinMax(ot(this.ctx),e),this.clip(),this.endPath())}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||Lu("TODO: Support non-isolated groups."),t.knockout&&z("Knockout groups not supported.");const i=ot(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=O.getAxialAlignedBoundingBox(t.bbox,ot(e));s=O.intersect(s,[0,0,e.canvas.width,e.canvas.height])||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),h=Math.max(Math.ceil(s[2])-a,1),c=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,h,c]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const u=this.cachedCanvases.getCanvas(d,h,c),g=u.context;g.translate(-a,-o),g.transform(...i),t.smask?this.smaskStack.push({canvas:u.canvas,context:g,offsetX:a,offsetY:o,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(a,o),e.save()),Ul(e,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=ot(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const n=O.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],s);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,e,i,s,n){if(p(this,zh,Ob).call(this),Bu(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const a=e[2]-e[0],o=e[3]-e[1];if(n&&this.annotationCanvasMap){(i=i.slice())[4]-=e[0],i[5]-=e[1],(e=e.slice())[0]=e[1]=0,e[2]=a,e[3]=o;const[h,c]=O.singularValueDecompose2dScale(ot(this.ctx)),{viewportScale:d}=this,u=Math.ceil(a*this.outputScaleX*d),g=Math.ceil(o*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(u,g);const{canvas:b,context:_}=this.annotationCanvas;this.annotationCanvasMap.set(t,b),this.annotationCanvas.savedCtx=this.ctx,this.ctx=_,this.ctx.save(),this.ctx.setTransform(h,0,0,-c,0,o*c),Bu(this.ctx)}else Bu(this.ctx),this.ctx.rect(e[0],e[1],a,o),this.ctx.clip(),this.endPath()}this.current=new dA(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),p(this,Wh,Fb).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;(t=this.getObject(t.data,t)).count=e;const i=this.ctx,s=this.processingType3;if(s&&(void 0===s.compiled&&(s.compiled=function Ow(l){const{width:t,height:e}=l;if(t>1e3||e>1e3)return null;const s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=t+1;let o,h,c,a=new Uint8Array(n*(e+1));const d=t+7&-8;let u=new Uint8Array(d*e),g=0;for(const y of l.data){let E=128;for(;E>0;)u[g++]=y&E?0:255,E>>=1}let b=0;for(g=0,0!==u[g]&&(a[0]=1,++b),h=1;h<t;h++)u[g]!==u[g+1]&&(a[h]=u[g]?2:1,++b),g++;for(0!==u[g]&&(a[h]=2,++b),o=1;o<e;o++){g=o*d,c=o*n,u[g-d]!==u[g]&&(a[c]=u[g]?1:8,++b);let y=(u[g]?4:0)+(u[g-d]?8:0);for(h=1;h<t;h++)y=(y>>2)+(u[g+1]?4:0)+(u[g-d+1]?8:0),s[y]&&(a[c+h]=s[y],++b),g++;if(u[g-d]!==u[g]&&(a[c+h]=u[g]?2:4,++b),b>1e3)return null}for(g=d*(e-1),c=o*n,0!==u[g]&&(a[c]=8,++b),h=1;h<t;h++)u[g]!==u[g+1]&&(a[c+h]=u[g]?4:8,++b),g++;if(0!==u[g]&&(a[c+h]=4,++b),b>1e3)return null;const _=new Int32Array([0,n,-1,0,-n,0,0,0,1]),A=new Path2D;for(o=0;b&&o<=e;o++){let y=o*n;const E=y+t;for(;y<E&&!a[y];)y++;if(y===E)continue;A.moveTo(y%n,o);const x=y;let C=a[y];do{const S=_[C];do{y+=S}while(!a[y]);const P=a[y];5!==P&&10!==P?(C=P,a[y]=0):(C=P&51*C>>4,a[y]&=C>>2|C<<2),A.lineTo(y%n,y/n|0),a[y]||--b}while(x!==y);--o}return u=null,a=null,function(y){y.save(),y.scale(1/t,-1/e),y.translate(0,-e),y.fill(A),y.beginPath(),y.restore()}}(t)),s.compiled))return void s.compiled(i);const n=this._createMaskCanvas(t),a=n.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,n.offsetX,n.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i=0,s=0,n,a){if(!this.contentVisible)return;t=this.getObject(t.data,t);const o=this.ctx;o.save();const h=ot(o);o.transform(e,i,s,n,0,0);const c=this._createMaskCanvas(t);o.setTransform(1,0,0,1,c.offsetX-h[4],c.offsetY-h[5]);for(let d=0,u=a.length;d<u;d+=2){const g=O.transform(h,[e,i,s,n,a[d],a[d+1]]),[b,_]=O.applyTransform([0,0],g);o.drawImage(c.canvas,b,_)}o.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const n of t){const{data:a,width:o,height:h,transform:c}=n,d=this.cachedCanvases.getCanvas("maskCanvas",o,h),u=d.context;u.save(),fA(u,this.getObject(a,n)),u.globalCompositeOperation="source-in",u.fillStyle=s?i.getPattern(u,this,Oi(e),"Fill"):i,u.fillRect(0,0,o,h),u.restore(),e.save(),e.transform(...c),e.scale(1,-1),Nu(e,d.canvas,0,0,o,h,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);e?this.paintInlineImageXObject(e):z("Dependent image isn't ready yet")}paintImageXObjectRepeat(t,e,i,s){if(!this.contentVisible)return;const n=this.getObject(t);if(!n)return void z("Dependent image isn't ready yet");const a=n.width,o=n.height,h=[];for(let c=0,d=s.length;c<d;c+=2)h.push({transform:[e,0,0,i,s[c],s[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(n,h)}applyTransferMapsToCanvas(t){return"none"!==this.current.transferMaps&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if("none"===this.current.transferMaps)return t.bitmap;const{bitmap:e,width:i,height:s}=t,n=this.cachedCanvases.getCanvas("inlineImage",i,s),a=n.context;return a.filter=this.current.transferMaps,a.drawImage(e,0,0),a.filter="none",n.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,i=t.height,s=this.ctx;if(this.save(),!zt){const{filter:o}=s;"none"!==o&&""!==o&&(s.filter="none")}let n;if(s.scale(1/e,-1/i),t.bitmap)n=this.applyTransferMapsToBitmap(t);else if("function"==typeof HTMLElement&&t instanceof HTMLElement||!t.data)n=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,i).context;uA(h,t),n=this.applyTransferMapsToCanvas(h)}const a=this._scaleImage(n,Oi(s));s.imageSmoothingEnabled=pA(ot(s),t.interpolate),Nu(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,e,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const h=this.cachedCanvases.getCanvas("inlineImage",t.width,t.height).context;uA(h,t),s=this.applyTransferMapsToCanvas(h)}for(const n of e)i.save(),i.transform(...n.transform),i.scale(1,-1),Nu(i,s,n.x,n.y,n.w,n.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){this.markedContentStack.push("OC"===t?{visible:this.optionalContentConfig.isVisible(e)}:{visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const i=this.ctx;this.pendingClip&&(e||(this.pendingClip===gA?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ot(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:n}=this.ctx.getTransform();let a,o;if(0===i&&0===s){const h=Math.abs(e),c=Math.abs(n);if(h===c)if(0===t)a=o=1/h;else{const d=h*t;a=o=d<1?1/d:1}else if(0===t)a=1/h,o=1/c;else{const d=h*t,u=c*t;a=d<1?1/d:1,o=u<1?1/u:1}}else{const h=Math.abs(e*n-i*s),c=Math.hypot(e,i),d=Math.hypot(s,n);if(0===t)a=d/h,o=c/h;else{const u=t*h;a=d>u?d/u:1,o=c>u?c/u:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:i}=this.current,[s,n]=this.getScaleForStroking();if(e.lineWidth=i||1,1===s&&1===n)return void e.stroke();const a=e.getLineDash();if(t&&e.save(),e.scale(s,n),a.length>0){const o=Math.max(s,n);e.setLineDash(a.map(h=>h/o)),e.lineDashOffset/=o}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};let Sa=ob;zh=new WeakSet,Ob=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Wh=new WeakSet,Fb=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}};for(const l in Re)void 0!==Sa.prototype[l]&&(Sa.prototype[Re[l]]=Sa.prototype[l]);class Ni{static get workerPort(){return r(this,Gh)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&null!==t)throw new Error("Invalid `workerPort` type.");m(this,Gh,t)}static get workerSrc(){return r(this,$h)}static set workerSrc(t){if("string"!=typeof t)throw new Error("Invalid `workerSrc` type.");m(this,$h,t)}}Gh=new WeakMap,$h=new WeakMap,f(Ni,Gh,null),f(Ni,$h,"");function de(l){switch(l instanceof Error||"object"==typeof l&&null!==l||bt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),l.name){case"AbortException":return new Dn(l.message);case"MissingPDFException":return new In(l.message);case"PasswordException":return new mm(l.message,l.code);case"UnexpectedResponseException":return new ku(l.message,l.status);case"UnknownErrorException":return new bm(l.message,l.details);default:return new bm(l.message,l.toString())}}class zl{constructor(t,e,i){f(this,Vf),f(this,jf),f(this,Za),this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=s=>{const n=s.data;if(n.targetName!==this.sourceName)return;if(n.stream)return void p(this,jf,mv).call(this,n);if(n.callback){const o=n.callbackId,h=this.callbackCapabilities[o];if(!h)throw new Error(`Cannot resolve callback ${o}`);if(delete this.callbackCapabilities[o],1===n.callback)h.resolve(n.data);else{if(2!==n.callback)throw new Error("Unexpected callback case");h.reject(de(n.reason))}return}const a=this.actionHandler[n.action];if(!a)throw new Error(`Unknown action from worker: ${n.action}`);if(n.callbackId){const o=this.sourceName,h=n.sourceName;new Promise(function(c){c(a(n.data))}).then(function(c){i.postMessage({sourceName:o,targetName:h,callback:1,callbackId:n.callbackId,data:c})},function(c){i.postMessage({sourceName:o,targetName:h,callback:2,callbackId:n.callbackId,reason:de(c)})})}else n.streamId?p(this,Vf,gv).call(this,n):a(n.data)},i.addEventListener("message",this._onComObjOnMessage)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,n=Promise.withResolvers();this.callbackCapabilities[s]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(a){n.reject(a)}return n.promise}sendWithStream(t,e,i,s){const n=this.streamId++,a=this.sourceName,o=this.targetName,h=this.comObj;return new ReadableStream({start:c=>{const d=Promise.withResolvers();return this.streamControllers[n]={controller:c,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:a,targetName:o,action:t,streamId:n,data:e,desiredSize:c.desiredSize},s),d.promise},pull:c=>{const d=Promise.withResolvers();return this.streamControllers[n].pullCall=d,h.postMessage({sourceName:a,targetName:o,stream:6,streamId:n,desiredSize:c.desiredSize}),d.promise},cancel:c=>{wt(c instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[n].cancelCall=d,this.streamControllers[n].isClosed=!0,h.postMessage({sourceName:a,targetName:o,stream:1,streamId:n,reason:de(c)}),d.promise}},i)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}Vf=new WeakSet,gv=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,n=this.comObj,a=this,o=this.actionHandler[t.action],h={enqueue(c,d=1,u){if(this.isCancelled)return;const g=this.desiredSize;this.desiredSize-=d,g>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),n.postMessage({sourceName:i,targetName:s,stream:4,streamId:e,chunk:c},u)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:3,streamId:e}),delete a.streamSinks[e])},error(c){wt(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,n.postMessage({sourceName:i,targetName:s,stream:5,streamId:e,reason:de(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,new Promise(function(c){c(o(t.data,h))}).then(function(){n.postMessage({sourceName:i,targetName:s,stream:8,streamId:e,success:!0})},function(c){n.postMessage({sourceName:i,targetName:s,stream:8,streamId:e,reason:de(c)})})},jf=new WeakSet,mv=function(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,n=this.comObj,a=this.streamControllers[e],o=this.streamSinks[e];switch(t.stream){case 8:t.success?a.startCall.resolve():a.startCall.reject(de(t.reason));break;case 7:t.success?a.pullCall.resolve():a.pullCall.reject(de(t.reason));break;case 6:if(!o){n.postMessage({sourceName:i,targetName:s,stream:7,streamId:e,success:!0});break}o.desiredSize<=0&&t.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=t.desiredSize,new Promise(function(h){h(o.onPull?.())}).then(function(){n.postMessage({sourceName:i,targetName:s,stream:7,streamId:e,success:!0})},function(h){n.postMessage({sourceName:i,targetName:s,stream:7,streamId:e,reason:de(h)})});break;case 4:if(wt(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(t.chunk);break;case 3:if(wt(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),p(this,Za,Bg).call(this,a,e);break;case 5:wt(a,"error should have stream controller"),a.controller.error(de(t.reason)),p(this,Za,Bg).call(this,a,e);break;case 2:t.success?a.cancelCall.resolve():a.cancelCall.reject(de(t.reason)),p(this,Za,Bg).call(this,a,e);break;case 1:if(!o)break;new Promise(function(h){h(o.onCancel?.(de(t.reason)))}).then(function(){n.postMessage({sourceName:i,targetName:s,stream:2,streamId:e,success:!0})},function(h){n.postMessage({sourceName:i,targetName:s,stream:2,streamId:e,reason:de(h)})}),o.sinkCapability.reject(de(t.reason)),o.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},Za=new WeakSet,Bg=function(t,e){var i=this;return(0,I.Z)(function*(){yield Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete i.streamControllers[e]})()};class Hw{constructor({parsedData:t,rawData:e}){f(this,pr,void 0),f(this,qh,void 0),m(this,pr,t),m(this,qh,e)}getRaw(){return r(this,qh)}get(t){return r(this,pr).get(t)??null}getAll(){return _m(r(this,pr))}has(t){return r(this,pr).has(t)}}pr=new WeakMap,qh=new WeakMap;const Ss=Symbol("INTERNAL");class Vw{constructor(t,{name:e,intent:i,usage:s}){f(this,Kh,!1),f(this,Xh,!1),f(this,Yh,!1),f(this,Ja,!0),m(this,Kh,!!(2&t)),m(this,Xh,!!(4&t)),this.name=e,this.intent=i,this.usage=s}get visible(){if(r(this,Yh))return r(this,Ja);if(!r(this,Ja))return!1;const{print:t,view:e}=this.usage;return r(this,Kh)?"OFF"!==e?.viewState:!r(this,Xh)||"OFF"!==t?.printState}_setVisible(t,e,i=!1){t!==Ss&&bt("Internal method `_setVisible` called."),m(this,Yh,i),m(this,Ja,e)}}Kh=new WeakMap,Xh=new WeakMap,Yh=new WeakMap,Ja=new WeakMap;class jw{constructor(t,e=2){if(f(this,Zh),f(this,Us,null),f(this,it,new Map),f(this,Qa,null),f(this,to,null),this.renderingIntent=e,this.name=null,this.creator=null,null!==t){this.name=t.name,this.creator=t.creator,m(this,to,t.order);for(const i of t.groups)r(this,it).set(i.id,new Vw(e,i));if("OFF"===t.baseState)for(const i of r(this,it).values())i._setVisible(Ss,!1);for(const i of t.on)r(this,it).get(i)._setVisible(Ss,!0);for(const i of t.off)r(this,it).get(i)._setVisible(Ss,!1);m(this,Qa,this.getHash())}}isVisible(t){if(0===r(this,it).size)return!0;if(!t)return Lu("Optional content group not defined."),!0;if("OCG"===t.type)return r(this,it).has(t.id)?r(this,it).get(t.id).visible:(z(`Optional content group not found: ${t.id}`),!0);if("OCMD"===t.type){if(t.expression)return p(this,Zh,Nb).call(this,t.expression);if(!t.policy||"AnyOn"===t.policy){for(const e of t.ids){if(!r(this,it).has(e))return z(`Optional content group not found: ${e}`),!0;if(r(this,it).get(e).visible)return!0}return!1}if("AllOn"===t.policy){for(const e of t.ids){if(!r(this,it).has(e))return z(`Optional content group not found: ${e}`),!0;if(!r(this,it).get(e).visible)return!1}return!0}if("AnyOff"===t.policy){for(const e of t.ids){if(!r(this,it).has(e))return z(`Optional content group not found: ${e}`),!0;if(!r(this,it).get(e).visible)return!0}return!1}if("AllOff"===t.policy){for(const e of t.ids){if(!r(this,it).has(e))return z(`Optional content group not found: ${e}`),!0;if(r(this,it).get(e).visible)return!1}return!0}return z(`Unknown optional content policy ${t.policy}.`),!0}return z(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0){const i=r(this,it).get(t);i?(i._setVisible(Ss,!!e,!0),m(this,Us,null)):z(`Optional content group not found: ${t}`)}setOCGState({state:t}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const n=r(this,it).get(s);if(n)switch(i){case"ON":n._setVisible(Ss,!0);break;case"OFF":n._setVisible(Ss,!1);break;case"Toggle":n._setVisible(Ss,!n.visible)}}m(this,Us,null)}get hasInitialVisibility(){return null===r(this,Qa)||this.getHash()===r(this,Qa)}getOrder(){return r(this,it).size?r(this,to)?r(this,to).slice():[...r(this,it).keys()]:null}getGroups(){return r(this,it).size>0?_m(r(this,it)):null}getGroup(t){return r(this,it).get(t)||null}getHash(){if(null!==r(this,Us))return r(this,Us);const t=new iA;for(const[e,i]of r(this,it))t.update(`${e}:${i.visible}`);return m(this,Us,t.hexdigest())}}Us=new WeakMap,it=new WeakMap,Qa=new WeakMap,to=new WeakMap,Zh=new WeakSet,Nb=function(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let s=1;s<e;s++){const n=t[s];let a;if(Array.isArray(n))a=p(this,Zh,Nb).call(this,n);else{if(!r(this,it).has(n))return z(`Optional content group not found: ${n}`),!0;a=r(this,it).get(n).visible}switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return"And"===i};class Uw{constructor(t,{disableRange:e=!1,disableStream:i=!1}){wt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:n,progressiveDone:a,contentDispositionFilename:o}=t;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,n?.length>0){const h=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,c)=>{this._onReceiveData({begin:h,chunk:c})}),t.addProgressListener((h,c)=>{this._onProgress({loaded:h,total:c})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;void 0===t?this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i):wt(this._rangeReaders.some(function(n){return n._begin===t&&(n._enqueue(i),!0)}),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){void 0===t.total?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){wt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new zw(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new Ww(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class zw{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=xm(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}read(){var t=this;return(0,I.Z)(function*(){if(t._queuedChunks.length>0)return{value:t._queuedChunks.shift(),done:!1};if(t._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return t._requests.push(e),e.promise})()}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Ww{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}read(){var t=this;return(0,I.Z)(function*(){if(t._queuedChunk){const i=t._queuedChunk;return t._queuedChunk=null,{value:i,done:!1}}if(t._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return t._requests.push(e),e.promise})()}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Dm({getResponseHeader:l,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},n=parseInt(l("Content-Length"),10);return!Number.isInteger(n)||(s.suggestedLength=n,n<=2*e)||i||!t||"bytes"!==l("Accept-Ranges")||"identity"!==(l("Content-Encoding")||"identity")||(s.allowRangeRequests=!0),s}function Om(l){const t=l("Content-Disposition");if(t){let e=function Gw(l){let t=!0,e=i("filename\\*","i").exec(l);if(e){e=e[1];let d=o(e);return d=unescape(d),d=h(d),d=c(d),n(d)}if(e=function a(d){const u=[];let g;const b=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(g=b.exec(d));){let[,A,v,y]=g;if(A=parseInt(A,10),A in u){if(0===A)break}else u[A]=[v,y]}const _=[];for(let A=0;A<u.length&&A in u;++A){let[v,y]=u[A];y=o(y),v&&(y=unescape(y),0===A&&(y=h(y))),_.push(y)}return _.join("")}(l),e)return n(c(e));if(e=i("filename","i").exec(l),e){e=e[1];let d=o(e);return d=c(d),n(d)}function i(d,u){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function s(d,u){if(d){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const g=new TextDecoder(d,{fatal:!0}),b=Fl(u);u=g.decode(b),t=!1}catch{}}return u}function n(d){return t&&/[\x80-\xff]/.test(d)&&(d=s("utf-8",d),t&&(d=s("iso-8859-1",d))),d}function o(d){if(d.startsWith('"')){const u=d.slice(1).split('\\"');for(let g=0;g<u.length;++g){const b=u[g].indexOf('"');-1!==b&&(u[g]=u[g].slice(0,b),u.length=g+1),u[g]=u[g].replaceAll(/\\(.)/g,"$1")}d=u.join('"')}return d}function h(d){const u=d.indexOf("'");return-1===u?d:s(d.slice(0,u),d.slice(u+1).replace(/^[^']*'/,""))}function c(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,g,b,_){if("q"===b||"Q"===b)return s(g,_=(_=_.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(A,v){return String.fromCharCode(parseInt(v,16))}));try{_=atob(_)}catch{}return s(g,_)})}return""}(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(xm(e))return e}return null}function Vu(l,t){return 404===l||0===l&&t.startsWith("file:")?new In('Missing PDF "'+t+'".'):new ku(`Unexpected server response (${l}) while retrieving PDF "${t}".`,l)}function mA(l){return 200===l||206===l}function bA(l,t,e){return{method:"GET",headers:l,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function _A(l){const t=new Headers;for(const e in l){const i=l[e];void 0!==i&&t.append(e,i)}return t}function AA(l){return l instanceof Uint8Array?l.buffer:l instanceof ArrayBuffer?l:(z(`getArrayBuffer - unexpected data format: ${l}`),new Uint8Array(l).buffer)}class yA{constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return wt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new $w(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new qw(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class $w{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._headers=_A(this._stream.httpHeaders);const i=e.url;fetch(i,bA(this._headers,this._withCredentials,this._abortController)).then(s=>{if(!mA(s.status))throw Vu(s.status,i);this._reader=s.body.getReader(),this._headersCapability.resolve();const n=h=>s.headers.get(h),{allowRangeRequests:a,suggestedLength:o}=Dm({getResponseHeader:n,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=o||this._contentLength,this._filename=Om(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Dn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var t=this;return(0,I.Z)(function*(){yield t._headersCapability.promise;const{value:e,done:i}=yield t._reader.read();return i?{value:e,done:i}:(t._loaded+=e.byteLength,t.onProgress?.({loaded:t._loaded,total:t._contentLength}),{value:AA(e),done:!1})})()}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class qw{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController,this._headers=_A(this._stream.httpHeaders),this._headers.append("Range",`bytes=${e}-${i-1}`);const n=s.url;fetch(n,bA(this._headers,this._withCredentials,this._abortController)).then(a=>{if(!mA(a.status))throw Vu(a.status,n);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}read(){var t=this;return(0,I.Z)(function*(){yield t._readCapability.promise;const{value:e,done:i}=yield t._reader.read();return i?{value:e,done:i}:(t._loaded+=e.byteLength,t.onProgress?.({loaded:t._loaded}),{value:AA(e),done:!1})})()}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class Xw{constructor(t,e={}){this.url=t,this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(t,e,i){const s={begin:t,end:e};for(const n in i)s[n]=i[n];return this.request(s)}requestFull(t){return this.request(t)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const n in this.httpHeaders){const a=this.httpHeaders[n];void 0!==a&&e.setRequestHeader(n,a)}return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=206):s.expectedStatus=200,e.responseType="arraybuffer",t.onError&&(e.onerror=function(n){t.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];!i||i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),4!==s.readyState||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===s.status&&this.isHttp)return void i.onError?.(s.status);const n=s.status||200;if((200!==n||206!==i.expectedStatus)&&n!==i.expectedStatus)return void i.onError?.(s.status);const o=function Kw(l){const t=l.response;return"string"!=typeof t?t:Fl(t).buffer}(s);if(206===n){const h=s.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);i.onDone({begin:parseInt(c[1],10),chunk:o})}else o?i.onDone({begin:0,chunk:o}):i.onError?.(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class Yw{constructor(t){this._source=t,this._manager=new Xw(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return wt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Zw(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new Jw(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class Zw{constructor(t,e){this._manager=t;const i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t),i=a=>e.getResponseHeader(a),{allowRangeRequests:s,suggestedLength:n}=Dm({getResponseHeader:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=n||this._contentLength,this._filename=Om(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersReceivedCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Vu(t,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}read(){var t=this;return(0,I.Z)(function*(){if(t._storedError)throw t._storedError;if(t._cachedChunks.length>0)return{value:t._cachedChunks.shift(),done:!1};if(t._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return t._requests.push(e),e.promise})()}cancel(t){this._done=!0,this._headersReceivedCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class Jw{constructor(t,e,i){this._manager=t;const s={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._requestId=t.requestRange(e,i,s),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError=Vu(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}read(){var t=this;return(0,I.Z)(function*(){if(t._storedError)throw t._storedError;if(null!==t._queuedChunk){const i=t._queuedChunk;return t._queuedChunk=null,{value:i,done:!1}}if(t._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return t._requests.push(e),e.promise})()}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Qw=/^[a-z][a-z0-9\-+.]+:/i;function vA(l,t,e){return"http:"===l.protocol?Cs.get("http").request(l,{headers:t},e):Cs.get("https").request(l,{headers:t},e)}class eE{constructor(t){this.source=t,this.url=function tE(l){if(Qw.test(l))return new URL(l);const t=Cs.get("url");return new URL(t.pathToFileURL(l))}(t.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return wt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new nE(this):new iE(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=this.isFsUrl?new rE(this,t,e):new sE(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class wA{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}read(){var t=this;return(0,I.Z)(function*(){if(yield t._readCapability.promise,t._done)return{value:void 0,done:!0};if(t._storedError)throw t._storedError;const e=t._readableStream.read();return null===e?(t._readCapability=Promise.withResolvers(),t.read()):(t._loaded+=e.length,t.onProgress?.({loaded:t._loaded,total:t._contentLength}),{value:new Uint8Array(e).buffer,done:!1})})()}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Dn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class EA{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!t.source.disableStream}get isStreamingSupported(){return this._isStreamingSupported}read(){var t=this;return(0,I.Z)(function*(){if(yield t._readCapability.promise,t._done)return{value:void 0,done:!0};if(t._storedError)throw t._storedError;const e=t._readableStream.read();return null===e?(t._readCapability=Promise.withResolvers(),t.read()):(t._loaded+=e.length,t.onProgress?.({loaded:t._loaded}),{value:new Uint8Array(e).buffer,done:!1})})()}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class iE extends wA{constructor(t){super(t),this._request=vA(this._url,t.httpHeaders,i=>{if(404===i.statusCode){const o=new In(`Missing PDF "${this._url}".`);return this._storedError=o,void this._headersCapability.reject(o)}this._headersCapability.resolve(),this._setReadableStream(i);const s=o=>this._readableStream.headers[o.toLowerCase()],{allowRangeRequests:n,suggestedLength:a}=Dm({getResponseHeader:s,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=a||this._contentLength,this._filename=Om(s)}),this._request.on("error",i=>{this._storedError=i,this._headersCapability.reject(i)}),this._request.end()}}class sE extends EA{constructor(t,e,i){super(t),this._httpHeaders={};for(const n in t.httpHeaders){const a=t.httpHeaders[n];void 0!==a&&(this._httpHeaders[n]=a)}this._httpHeaders.Range=`bytes=${e}-${i-1}`,this._request=vA(this._url,this._httpHeaders,n=>{if(404!==n.statusCode)this._setReadableStream(n);else{const a=new In(`Missing PDF "${this._url}".`);this._storedError=a}}),this._request.on("error",n=>{this._storedError=n}),this._request.end()}}class nE extends wA{constructor(t){super(t);const e=Cs.get("fs");e.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(e.createReadStream(this._url)),this._headersCapability.resolve()},i=>{"ENOENT"===i.code&&(i=new In(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}}class rE extends EA{constructor(t,e,i){super(t);const s=Cs.get("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:i-1}))}}const Ge=class{constructor({textContentSource:t,container:e,viewport:i}){var h;if(f(this,Uf),f(this,zf),f(this,rc),f(this,zs,Promise.withResolvers()),f(this,oe,null),f(this,Jh,!1),f(this,Qh,!!globalThis.FontInspector?.enabled),f(this,gr,null),f(this,Ki,null),f(this,tc,0),f(this,ec,0),f(this,mr,null),f(this,eo,null),f(this,io,0),f(this,Ws,0),f(this,so,Object.create(null)),f(this,ic,[]),f(this,no,null),f(this,br,[]),f(this,sc,new WeakMap),f(this,nc,null),t instanceof ReadableStream)m(this,no,t);else{if("object"!=typeof t)throw new Error('No "textContentSource" parameter specified.');m(this,no,new ReadableStream({start(c){c.enqueue(t),c.close()}}))}m(this,oe,m(this,eo,e)),m(this,Ws,i.scale*(globalThis.devicePixelRatio||1)),m(this,io,i.rotation),m(this,Ki,{prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:n,pageX:a,pageY:o}=i.rawDims;m(this,nc,[1,0,0,-1,-a,o+n]),m(this,ec,s),m(this,tc,n),p(h=Ge,Wf,Av).call(h),On(e,i),r(this,zs).promise.catch(()=>{}).then(()=>{r(Ge,ro).delete(this),m(this,Ki,null),m(this,so,null)})}render(){const t=()=>{r(this,mr).read().then(({value:e,done:i})=>{i?r(this,zs).resolve():(r(this,gr)??m(this,gr,e.lang),Object.assign(r(this,so),e.styles),p(this,Uf,bv).call(this,e.items),t())},r(this,zs).reject)};return m(this,mr,r(this,no).getReader()),r(Ge,ro).add(this),t(),r(this,zs).promise}update({viewport:t,onBefore:e=null}){var n;const i=t.scale*(globalThis.devicePixelRatio||1),s=t.rotation;if(s!==r(this,io)&&(e?.(),m(this,io,s),On(r(this,eo),{rotation:s})),i!==r(this,Ws)){e?.(),m(this,Ws,i);const a={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:p(n=Ge,ao,Hg).call(n,r(this,gr))};for(const o of r(this,br))a.properties=r(this,sc).get(o),a.div=o,p(this,rc,Bb).call(this,a)}}cancel(){const t=new Dn("TextLayer task cancelled.");r(this,mr)?.cancel(t).catch(()=>{}),m(this,mr,null),r(this,zs).reject(t)}get textDivs(){return r(this,br)}get textContentItemsStr(){return r(this,ic)}static cleanup(){if(!(r(this,ro).size>0)){r(this,_r).clear();for(const{canvas:t}of r(this,Ar).values())t.remove();r(this,Ar).clear()}}};let Ee=Ge;zs=new WeakMap,oe=new WeakMap,Jh=new WeakMap,Qh=new WeakMap,gr=new WeakMap,Ki=new WeakMap,tc=new WeakMap,ec=new WeakMap,mr=new WeakMap,eo=new WeakMap,io=new WeakMap,Ws=new WeakMap,so=new WeakMap,ic=new WeakMap,no=new WeakMap,br=new WeakMap,sc=new WeakMap,nc=new WeakMap,_r=new WeakMap,Ar=new WeakMap,Gs=new WeakMap,ro=new WeakMap,Uf=new WeakSet,bv=function(t){var s,n;if(r(this,Jh))return;(n=r(this,Ki)).ctx??(n.ctx=p(s=Ge,ao,Hg).call(s,r(this,gr)));const e=r(this,br),i=r(this,ic);for(const a of t){if(e.length>1e5)return z("Ignoring additional textDivs for performance reasons."),void m(this,Jh,!0);if(void 0!==a.str)i.push(a.str),p(this,zf,_v).call(this,a);else if("beginMarkedContentProps"===a.type||"beginMarkedContent"===a.type){const o=r(this,oe);m(this,oe,document.createElement("span")),r(this,oe).classList.add("markedContent"),null!==a.id&&r(this,oe).setAttribute("id",`${a.id}`),o.append(r(this,oe))}else"endMarkedContent"===a.type&&m(this,oe,r(this,oe).parentNode)}},zf=new WeakSet,_v=function(t){var A;const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};r(this,br).push(e);const s=O.transform(r(this,nc),t.transform);let n=Math.atan2(s[1],s[0]);const a=r(this,so)[t.fontName];a.vertical&&(n+=Math.PI/2);const o=r(this,Qh)&&a.fontSubstitution||a.fontFamily,h=Math.hypot(s[2],s[3]),c=h*p(A=Ge,Gf,yv).call(A,o,r(this,gr));let d,u;0===n?(d=s[4],u=s[5]-c):(d=s[4]+c*Math.sin(n),u=s[5]-c*Math.cos(n));const g="calc(var(--scale-factor)*",b=e.style;r(this,oe)===r(this,eo)?(b.left=`${(100*d/r(this,ec)).toFixed(2)}%`,b.top=`${(100*u/r(this,tc)).toFixed(2)}%`):(b.left=`${g}${d.toFixed(2)}px)`,b.top=`${g}${u.toFixed(2)}px)`),b.fontSize=`${g}${(r(Ge,Gs)*h).toFixed(2)}px)`,b.fontFamily=o,i.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,r(this,Qh)&&(e.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),0!==n&&(i.angle=n*(180/Math.PI));let _=!1;if(t.str.length>1)_=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const v=Math.abs(t.transform[0]),y=Math.abs(t.transform[3]);v!==y&&Math.max(v,y)/Math.min(v,y)>1.5&&(_=!0)}if(_&&(i.canvasWidth=a.vertical?t.height:t.width),r(this,sc).set(e,i),r(this,Ki).div=e,r(this,Ki).properties=i,p(this,rc,Bb).call(this,r(this,Ki)),i.hasText&&r(this,oe).append(e),i.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),r(this,oe).append(v)}},rc=new WeakSet,Bb=function(t){const{div:e,properties:i,ctx:s,prevFontSize:n,prevFontFamily:a}=t,{style:o}=e;let h="";if(r(Ge,Gs)>1&&(h=`scale(${1/r(Ge,Gs)})`),0!==i.canvasWidth&&i.hasText){const{fontFamily:c}=o,{canvasWidth:d,fontSize:u}=i;(n!==u||a!==c)&&(s.font=`${u*r(this,Ws)}px ${c}`,t.prevFontSize=u,t.prevFontFamily=c);const{width:g}=s.measureText(e.textContent);g>0&&(h=`scaleX(${d*r(this,Ws)/g}) ${h}`)}0!==i.angle&&(h=`rotate(${i.angle}deg) ${h}`),h.length>0&&(o.transform=h)},ao=new WeakSet,Hg=function(t=null){let e=r(this,Ar).get(t||(t=""));if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),r(this,Ar).set(t,e)}return e},Wf=new WeakSet,Av=function(){if(null!==r(this,Gs))return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),m(this,Gs,t.getBoundingClientRect().height),t.remove()},Gf=new WeakSet,yv=function(t,e){const i=r(this,_r).get(t);if(i)return i;const s=p(this,ao,Hg).call(this,e),n=s.font;s.canvas.width=s.canvas.height=30,s.font=`30px ${t}`;const a=s.measureText("");let o=a.fontBoundingBoxAscent,h=Math.abs(a.fontBoundingBoxDescent);if(o){const u=o/(o+h);return r(this,_r).set(t,u),s.canvas.width=s.canvas.height=0,s.font=n,u}s.strokeStyle="red",s.clearRect(0,0,30,30),s.strokeText("g",0,0);let c=s.getImageData(0,0,30,30).data;h=0;for(let u=c.length-1-3;u>=0;u-=4)if(c[u]>0){h=Math.ceil(u/4/30);break}s.clearRect(0,0,30,30),s.strokeText("A",0,30),c=s.getImageData(0,0,30,30).data,o=0;for(let u=0,g=c.length;u<g;u+=4)if(c[u]>0){o=30-Math.floor(u/4/30);break}s.canvas.width=s.canvas.height=0,s.font=n;const d=o?o/(o+h):.8;return r(this,_r).set(t,d),d},f(Ee,ao),f(Ee,Wf),f(Ee,Gf),f(Ee,_r,new Map),f(Ee,Ar,new Map),f(Ee,Gs,null),f(Ee,ro,new Set);class Wl{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};return function s(n){if(!n)return;let a=null;const o=n.name;if("#text"===o)a=n.value;else{if(!Wl.shouldBuildText(o))return;n?.attributes?.textContent?a=n.attributes.textContent:n.value&&(a=n.value)}if(null!==a&&e.push({str:a}),n.children)for(const h of n.children)s(h)}(t),i}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}const dE=zt?class Ew extends q_{_createCanvas(t,e){return Cs.get("canvas").createCanvas(t,e)}}:class cw extends q_{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}={}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}},uE=zt?class xw extends K_{_fetchData(t,e){return nA(t).then(i=>({cMapData:i,compressionType:e}))}}:Y_,fE=zt?class ww extends $_{}:class hw extends $_{constructor({docId:e,ownerDocument:i=globalThis.document}={}){super(),f(this,Lt),f(this,Ms),f(this,Ls),f(this,Da),f(this,ks),f(this,hf),f(this,oh),f(this,Rs),f(this,Gn),f(this,$n),f(this,lh),f(this,qn),f(this,Un,void 0),f(this,zn,void 0),f(this,ri,void 0),f(this,Ui,void 0),f(this,qt,void 0),f(this,lf,void 0),f(this,Wn,0),m(this,Ui,e),m(this,qt,i)}addFilter(e){if(!e)return"none";let i=r(this,Lt,Xt).get(e);if(i)return i;const[s,n,a]=p(this,Da,Rg).call(this,e),o=1===e.length?s:`${s}${n}${a}`;if(i=r(this,Lt,Xt).get(o),i)return r(this,Lt,Xt).set(e,i),i;const h=`g_${r(this,Ui)}_transfer_map_${ee(this,Wn)._++}`,c=p(this,ks,Pl).call(this,h);r(this,Lt,Xt).set(e,c),r(this,Lt,Xt).set(o,c);const d=p(this,Rs,Tl).call(this,h);return p(this,$n,lu).call(this,s,n,a,d),c}addHCMFilter(e,i){const s=`${e}-${i}`,n="base";let a=r(this,Ms,Cl).get(n);if(a?.key===s||(a?(a.filter?.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},r(this,Ms,Cl).set(n,a)),!e||!i))return a.url;const o=p(this,qn,hu).call(this,e);e=O.makeHexColor(...o);const h=p(this,qn,hu).call(this,i);if(i=O.makeHexColor(...h),r(this,Ls,Sl).style.color="","#000000"===e&&"#ffffff"===i||e===i)return a.url;const c=new Array(256);for(let _=0;_<=255;_++){const A=_/255;c[_]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const d=c.join(","),u=`g_${r(this,Ui)}_hcm_filter`,g=a.filter=p(this,Rs,Tl).call(this,u);p(this,$n,lu).call(this,d,d,d,g),p(this,oh,bb).call(this,g);const b=(_,A)=>{const v=o[_]/255,y=h[_]/255,E=new Array(A+1);for(let x=0;x<=A;x++)E[x]=v+x/A*(y-v);return E.join(",")};return p(this,$n,lu).call(this,b(0,5),b(1,5),b(2,5),g),a.url=p(this,ks,Pl).call(this,u),a.url}addAlphaFilter(e){let i=r(this,Lt,Xt).get(e);if(i)return i;const[s]=p(this,Da,Rg).call(this,[e]),n=`alpha_${s}`;if(i=r(this,Lt,Xt).get(n),i)return r(this,Lt,Xt).set(e,i),i;const a=`g_${r(this,Ui)}_alpha_map_${ee(this,Wn)._++}`,o=p(this,ks,Pl).call(this,a);r(this,Lt,Xt).set(e,o),r(this,Lt,Xt).set(n,o);const h=p(this,Rs,Tl).call(this,a);return p(this,lh,_b).call(this,s,h),o}addLuminosityFilter(e){let s,n,i=r(this,Lt,Xt).get(e||"luminosity");if(i)return i;if(e?([s]=p(this,Da,Rg).call(this,[e]),n=`luminosity_${s}`):n="luminosity",i=r(this,Lt,Xt).get(n),i)return r(this,Lt,Xt).set(e,i),i;const a=`g_${r(this,Ui)}_luminosity_map_${ee(this,Wn)._++}`,o=p(this,ks,Pl).call(this,a);r(this,Lt,Xt).set(e,o),r(this,Lt,Xt).set(n,o);const h=p(this,Rs,Tl).call(this,a);return p(this,hf,zy).call(this,h),e&&p(this,lh,_b).call(this,s,h),o}addHighlightHCMFilter(e,i,s,n,a){const o=`${i}-${s}-${n}-${a}`;let h=r(this,Ms,Cl).get(e);if(h?.key===o||(h?(h.filter?.remove(),h.key=o,h.url="none",h.filter=null):(h={key:o,url:"none",filter:null},r(this,Ms,Cl).set(e,h)),!i||!s))return h.url;const[c,d]=[i,s].map(p(this,qn,hu).bind(this));let u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[b,_]=[n,a].map(p(this,qn,hu).bind(this));g<u&&([u,g,b,_]=[g,u,_,b]),r(this,Ls,Sl).style.color="";const A=(E,x,C)=>{const S=new Array(256),P=(g-u)/C,L=E/255,k=(x-E)/(255*C);let w=0;for(let T=0;T<=C;T++){const D=Math.round(u+T*P),$=L+T*k;for(let j=w;j<=D;j++)S[j]=$;w=D+1}for(let T=w;T<256;T++)S[T]=S[w-1];return S.join(",")},v=`g_${r(this,Ui)}_hcm_${e}_filter`,y=h.filter=p(this,Rs,Tl).call(this,v);return p(this,oh,bb).call(this,y),p(this,$n,lu).call(this,A(b[0],_[0],5),A(b[1],_[1],5),A(b[2],_[2],5),y),h.url=p(this,ks,Pl).call(this,v),h.url}destroy(e=!1){e&&0!==r(this,Ms,Cl).size||(r(this,ri)&&(r(this,ri).parentNode.parentNode.remove(),m(this,ri,null)),r(this,zn)&&(r(this,zn).clear(),m(this,zn,null)),m(this,Wn,0))}},pE=zt?class Cw extends X_{_fetchData(t){return nA(t)}}:Z_;function gE(l={}){"string"==typeof l||l instanceof URL?l={url:l}:(l instanceof ArrayBuffer||ArrayBuffer.isView(l))&&(l={data:l});const t=new ju,{docId:e}=t,i=l.url?function mE(l){if(l instanceof URL)return l.href;try{return new URL(l,window.location).href}catch{if(zt&&"string"==typeof l)return l}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(l.url):null,s=l.data?function bE(l){if(zt&&typeof Buffer<"u"&&l instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength)return l;if("string"==typeof l)return Fl(l);if(l instanceof ArrayBuffer||ArrayBuffer.isView(l)||"object"==typeof l&&!isNaN(l?.length))return new Uint8Array(l);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(l.data):null,n=l.httpHeaders||null,a=!0===l.withCredentials,o=l.password??null,h=l.range instanceof CA?l.range:null,c=Number.isInteger(l.rangeChunkSize)&&l.rangeChunkSize>0?l.rangeChunkSize:65536;let d=l.worker instanceof De?l.worker:null;const u=l.verbosity,g="string"!=typeof l.docBaseUrl||Iu(l.docBaseUrl)?null:l.docBaseUrl,b="string"==typeof l.cMapUrl?l.cMapUrl:null,_=!1!==l.cMapPacked,A=l.CMapReaderFactory||uE,v="string"==typeof l.standardFontDataUrl?l.standardFontDataUrl:null,y=l.StandardFontDataFactory||pE,E=!0!==l.stopAtErrors,x=Number.isInteger(l.maxImageSize)&&l.maxImageSize>-1?l.maxImageSize:-1,C=!1!==l.isEvalSupported,S="boolean"==typeof l.isOffscreenCanvasSupported?l.isOffscreenCanvasSupported:!zt,P=Number.isInteger(l.canvasMaxAreaInBytes)?l.canvasMaxAreaInBytes:-1,L="boolean"==typeof l.disableFontFace?l.disableFontFace:zt,k=!0===l.fontExtraProperties,w=!0===l.enableXfa,T=l.ownerDocument||globalThis.document,D=!0===l.disableRange,$=!0===l.disableStream,j=!0===l.disableAutoFetch,W=!0===l.pdfBug,tt=!0===l.enableHWA,mt=h?h.length:l.length??NaN,B="boolean"==typeof l.useSystemFonts?l.useSystemFonts:!zt&&!L,U="boolean"==typeof l.useWorkerFetch?l.useWorkerFetch:A===Y_&&y===Z_&&b&&v&&Bl(b,document.baseURI)&&Bl(v,document.baseURI),Pg=l.canvasFactory||new dE({ownerDocument:T,enableHWA:tt}),Tg=l.filterFactory||new fE({docId:e,ownerDocument:T});!function Y0(l){Number.isInteger(l)&&(Mu=l)}(u);const te={canvasFactory:Pg,filterFactory:Tg};if(U||(te.cMapReaderFactory=new A({baseUrl:b,isCompressed:_}),te.standardFontDataFactory=new y({baseUrl:v})),!d){const wa={verbosity:u,port:Ni.workerPort};d=wa.port?De.fromPort(wa):new De(wa),t._worker=d}const Ut={docId:e,apiVersion:"4.6.82",data:s,password:o,disableAutoFetch:j,rangeChunkSize:c,length:mt,docBaseUrl:g,enableXfa:w,evaluatorOptions:{maxImageSize:x,disableFontFace:L,ignoreErrors:E,isEvalSupported:C,isOffscreenCanvasSupported:S,canvasMaxAreaInBytes:P,fontExtraProperties:k,useSystemFonts:B,cMapUrl:U?b:null,standardFontDataUrl:U?v:null}},Lg={disableFontFace:L,fontExtraProperties:k,ownerDocument:T,pdfBug:W,styleElement:null,loadingParams:{disableAutoFetch:j,enableXfa:w}};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const wa=d.messageHandler.sendWithPromise("GetDocRequest",Ut,s?[s.buffer]:null);let Mn;if(h)Mn=new Uw(h,{disableRange:D,disableStream:$});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");As={url:i,length:mt,httpHeaders:n,withCredentials:a,rangeChunkSize:c,disableRange:D,disableStream:$},Mn=zt?typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype&&Bl(As.url)?new yA(As):new eE(As):Bl(As.url)?new yA(As):new Yw(As)}var As;return wa.then(Mt=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const As=new zl(e,Mt,d.port),Uy=new vE(As,t,Mn,Lg,te);t._transport=Uy,As.send("Ready",null)})}).catch(t._capability.reject),t}function xA(l){return"object"==typeof l&&Number.isInteger(l?.num)&&l.num>=0&&Number.isInteger(l?.gen)&&l.gen>=0}const lb=class{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId="d"+ee(lb,$f)._++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}destroy(){var t=this;return(0,I.Z)(function*(){t.destroyed=!0;try{t._worker?.port&&(t._worker._pendingDestroy=!0),yield t._transport?.destroy()}catch(e){throw t._worker?.port&&delete t._worker._pendingDestroy,e}t._transport=null,t._worker&&(t._worker.destroy(),t._worker=null)})()}};let ju=lb;$f=new WeakMap,f(ju,$f,0);class CA{constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const i of this._rangeListeners)i(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){bt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class _E{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Y(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class AE{constructor(t,e,i,s=!1){f(this,qs),f(this,oo),f(this,$s,null),f(this,Xi,!1),this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new J_:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new SA,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:n=!1}={}){return new Nl({viewBox:this.view,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:n})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Y(this,"isPureXfa",!!this._transport._htmlForXfa)}getXfa(){var t=this;return(0,I.Z)(function*(){return t._transport._htmlForXfa?.children[t._pageIndex]||null})()}render({canvasContext:t,viewport:e,intent:i="display",annotationMode:s=Es.ENABLE,transform:n=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:h=null,pageColors:c=null,printAnnotationStorage:d=null,isEditing:u=!1}){this._stats?.time("Overall");const g=this._transport.getRenderingIntent(i,s,d,u),{renderingIntent:b,cacheKey:_}=g;m(this,Xi,!1),p(this,oo,Vg).call(this),o||(o=this._transport.getOptionalContentConfig(b));let A=this._intentStates.get(_);A||(A=Object.create(null),this._intentStates.set(_,A)),A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null);const v=!!(4&b);A.displayReadyCapability||(A.displayReadyCapability=Promise.withResolvers(),A.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(g));const y=C=>{A.renderTasks.delete(E),(this._maybeCleanupAfterRender||v)&&m(this,Xi,!0),p(this,qs,Ml).call(this,!v),C?(E.capability.reject(C),this._abortOperatorList({intentState:A,reason:C instanceof Error?C:new Error(C)})):E.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},E=new zu({callback:y,params:{canvasContext:t,viewport:e,transform:n,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:A.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!v,pdfBug:this._pdfBug,pageColors:c});(A.renderTasks||(A.renderTasks=new Set)).add(E);const x=E.task;return Promise.all([A.displayReadyCapability.promise,o]).then(([C,S])=>{if(this.destroyed)y();else{if(this._stats?.time("Rendering"),!(S.renderingIntent&b))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");E.initializeGraphics({transparency:C,optionalContentConfig:S}),E.operatorListChanged()}}).catch(y),x}getOperatorList({intent:t="display",annotationMode:e=Es.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){const a=this._transport.getRenderingIntent(t,e,i,s,!0);let h,o=this._intentStates.get(a.cacheKey);return o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o)),o.opListReadCapability||(h=Object.create(null),h.operatorListChanged=function n(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(h))},o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(h),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===t,disableNormalization:!0===e},{highWaterMark:100,size:s=>s.items.length})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Wl.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){const a=e.getReader(),o={items:[],styles:Object.create(null),lang:null};!function n(){a.read().then(function({value:h,done:c}){c?i(o):(o.lang??(o.lang=h.lang),Object.assign(o.styles,h.styles),o.items.push(...h.items),n())},s)}()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),m(this,Xi,!1),p(this,oo,Vg).call(this),Promise.all(t)}cleanup(t=!1){m(this,Xi,!0);const e=p(this,qs,Ml).call(this,!1);return t&&e&&this._stats&&(this._stats=new J_),e}_startRenderPage(t,e){const i=this._intentStates.get(e);!i||(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&p(this,qs,Ml).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:s}){const{map:n,transfer:a}=i,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:n,modifiedIds:s},a).getReader(),c=this._intentStates.get(e);c.streamReader=h;const d=()=>{h.read().then(({value:u,done:g})=>{g?c.streamReader=null:this._transport.destroyed||(this._renderPageChunk(u,c),d())},u=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const g of c.renderTasks)g.operatorListChanged();p(this,qs,Ml).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(u);else{if(!c.opListReadCapability)throw u;c.opListReadCapability.reject(u)}}})};d()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof Em){let s=100;return e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),void(t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s))}}if(t.streamReader.cancel(new Dn(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,n]of this._intentStates)if(n===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}$s=new WeakMap,Xi=new WeakMap,qs=new WeakSet,Ml=function(t=!1){if(p(this,oo,Vg).call(this),!r(this,Xi)||this.destroyed)return!1;if(t)return m(this,$s,setTimeout(()=>{m(this,$s,null),p(this,qs,Ml).call(this,!1)},5e3)),!1;for(const{renderTasks:e,operatorList:i}of this._intentStates.values())if(e.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,Xi,!1),!0},oo=new WeakSet,Vg=function(){r(this,$s)&&(clearTimeout(r(this,$s)),m(this,$s,null))};class yE{constructor(){f(this,yr,new Set),f(this,qf,Promise.resolve())}postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};r(this,qf).then(()=>{for(const s of r(this,yr))s.call(this,i)})}addEventListener(t,e){r(this,yr).add(e)}removeEventListener(t,e){r(this,yr).delete(e)}terminate(){r(this,yr).clear()}}yr=new WeakMap,qf=new WeakMap;const yt=class{constructor({name:t=null,port:e=null,verbosity:i=Z0()}={}){if(f(this,lo),this.name=t,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if(r(yt,wr)?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");return(r(yt,wr)||m(yt,wr,new WeakMap)).set(e,this),void this._initializeFromPort(e)}this._initialize()}get promise(){return zt?Promise.all([Cs.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new zl("main","worker",t),this._messageHandler.on("ready",function(){}),p(this,lo,jg).call(this)}_initialize(){if(r(yt,vr)||r(yt,ho,Ug))return void this._setupFakeWorker();let{workerSrc:t}=yt;try{yt._isSameOrigin(window.location.href,t)||(t=yt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new zl("main","worker",e),s=()=>{n.abort(),i.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=new AbortController;e.addEventListener("error",()=>{this._webWorker||s()},{signal:n.signal}),i.on("test",o=>{n.abort(),!this.destroyed&&o?(this._messageHandler=i,this._port=e,this._webWorker=e,p(this,lo,jg).call(this)):s()}),i.on("ready",o=>{if(n.abort(),this.destroyed)s();else try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};return void a()}catch{Lu("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){r(yt,vr)||(z("Setting up fake worker."),m(yt,vr,!0)),yt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const e=new yE;this._port=e;const i="fake"+ee(yt,Kf)._++,s=new zl(i+"_worker",i,e);t.setup(s,e),this._messageHandler=new zl(i,i+"_worker",e),p(this,lo,jg).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),r(yt,wr)?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=r(this,wr)?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new yt(t)}static get workerSrc(){if(Ni.workerSrc)return Ni.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){var t=this;return Y(this,"_setupFakeWorkerGlobal",function(){var i=(0,I.Z)(function*(){return r(t,ho,Ug)?r(t,ho,Ug):(yield import(t.workerSrc)).WorkerMessageHandler});return function(){return i.apply(this,arguments)}}()())}};let De=yt;Kf=new WeakMap,vr=new WeakMap,wr=new WeakMap,hb=new WeakMap,lo=new WeakSet,jg=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},ho=new WeakSet,Ug=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},f(De,ho),f(De,Kf,0),f(De,vr,!1),f(De,wr,void 0),f(De,hb,(zt&&(m(yt,vr,!0),Ni.workerSrc||(Ni.workerSrc="./pdf.worker.mjs")),yt._isSameOrigin=(t,e)=>{let i;try{if(i=new URL(t),!i.origin||"null"===i.origin)return!1}catch{return!1}const s=new URL(e,i);return i.origin===s.origin},void(yt._createCDNWrapper=t=>URL.createObjectURL(new Blob([`await import("${t}");`],{type:"text/javascript"})))));class vE{constructor(t,e,i,s,n){f(this,Er),f(this,Yi,new Map),f(this,mi,new Map),f(this,co,new Map),f(this,uo,new Map),f(this,bi,null),this.messageHandler=t,this.loadingTask=e,this.commonObjs=new SA,this.fontLoader=new yw({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Y(this,"annotationStorage",new Tm)}getRenderingIntent(t,e=Es.ENABLE,i=null,s=!1,n=!1){let a=2,o=Pm;switch(t){case"any":a=1;break;case"display":break;case"print":a=4;break;default:z(`getRenderingIntent - invalid intent: ${t}`)}const h=4&a&&i instanceof sA?i:this.annotationStorage;switch(e){case Es.DISABLE:a+=64;break;case Es.ENABLE:break;case Es.ENABLE_FORMS:a+=16;break;case Es.ENABLE_STORAGE:a+=32,o=h.serializable;break;default:z(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(a+=128),n&&(a+=256);const{ids:c,hash:d}=h.modifiedIds;return{renderingIntent:a,cacheKey:[a,o.hash,d].join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),r(this,bi)?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of r(this,mi).values())t.push(i._destroy());r(this,mi).clear(),r(this,co).clear(),r(this,uo).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),r(this,Yi).clear(),this.filterFactory.destroy(),Ee.cleanup(),this._networkStream?.cancelAllRequests(new Dn("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{wt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},s.onPull=()=>{this._fullReader.read().then(function({value:n,done:a}){a?s.close():(wt(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(n),1,[n]))}).catch(n=>{s.error(n)})},s.onCancel=n=>{this._fullReader.cancel(n),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),t.on("ReaderHeadersReady",i=>{const s=Promise.withResolvers(),n=this._fullReader;return n.headersReady.then(()=>{(!n.isStreamingSupported||!n.isRangeSupported)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),n.onProgress=a=>{e.onProgress?.({loaded:a.loaded,total:a.total})}),s.resolve({isStreamingSupported:n.isStreamingSupported,isRangeSupported:n.isRangeSupported,contentLength:n.contentLength})},s.reject),s.promise}),t.on("GetRangeReader",(i,s)=>{wt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(i.begin,i.end);n?(s.onPull=()=>{n.read().then(function({value:a,done:o}){o?s.close():(wt(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a]))}).catch(a=>{s.error(a)})},s.onCancel=a=>{n.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}):s.close()}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new _E(i,this))}),t.on("DocException",function(i){let s;switch(i.name){case"PasswordException":s=new mm(i.message,i.code);break;case"InvalidPDFException":s=new U_(i.message);break;case"MissingPDFException":s=new In(i.message);break;case"UnexpectedResponseException":s=new ku(i.message,i.status);break;case"UnknownErrorException":s=new bm(i.message,i.details);break;default:bt("DocException - expected a valid Error.")}e._capability.reject(s)}),t.on("PasswordRequest",i=>{if(m(this,bi,Promise.withResolvers()),e.onPassword){const s=n=>{n instanceof Error?r(this,bi).reject(n):r(this,bi).resolve({password:n})};try{e.onPassword(s,i.code)}catch(n){r(this,bi).reject(n)}}else r(this,bi).reject(new mm(i.message,i.code));return r(this,bi).promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{this.destroyed||r(this,mi).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,n])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:a,fontExtraProperties:o,pdfBug:h}=this._params;if("error"in n){const g=n.error;z(`Error during font loading: ${g}`),this.commonObjs.resolve(i,g);break}const c=h&&globalThis.FontInspector?.enabled?(g,b)=>globalThis.FontInspector.fontAdded(g,b):null,d=new vw(n,{disableFontFace:a,inspectFont:c});this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!o&&d.data&&(d.data=null),this.commonObjs.resolve(i,d)});break;case"CopyLocalImage":const{imageRef:u}=n;wt(u,"The imageRef must be defined.");for(const g of r(this,mi).values())for(const[,b]of g.objs)if(b?.ref===u)return b.dataLen?(this.commonObjs.resolve(i,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,n);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,n,a])=>{if(this.destroyed)return;const o=r(this,mi).get(s);if(!o.objs.has(i)){if(0===o._intentStates.size)return void a?.bitmap?.close();switch(n){case"Image":o.objs.resolve(i,a),a?.dataLen>1e7&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${n}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBuiltInCMap",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(i):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",i=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(i):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&z("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=r(this,co).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&r(this,uo).set(n.refStr,t);const a=new AE(e,n,this,this._params.pdfBug);return r(this,mi).set(e,a),a});return r(this,co).set(e,s),s}getPageIndex(t){return xA(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return p(this,Er,uu).call(this,"GetFieldObjects")}hasJSActions(){return p(this,Er,uu).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return p(this,Er,uu).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return p(this,Er,uu).call(this,"GetOptionalContentConfig").then(e=>new jw(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=r(this,Yi).get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>({info:s[0],metadata:s[1]?new Hw(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return r(this,Yi).set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}startCleanup(t=!1){var e=this;return(0,I.Z)(function*(){if(!e.destroyed){yield e.messageHandler.sendWithPromise("Cleanup",null);for(const i of r(e,mi).values())if(!i.cleanup())throw new Error(`startCleanup: Page ${i.pageNumber} is currently rendering.`);e.commonObjs.clear(),t||e.fontLoader.clear(),r(e,Yi).clear(),e.filterFactory.destroy(!0),Ee.cleanup()}})()}cachedPageNumber(t){if(!xA(t))return null;const e=0===t.gen?`${t.num}R`:`${t.num}R${t.gen}`;return r(this,uo).get(e)??null}}Yi=new WeakMap,mi=new WeakMap,co=new WeakMap,uo=new WeakMap,bi=new WeakMap,Er=new WeakSet,uu=function(t,e=null){const i=r(this,Yi).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return r(this,Yi).set(t,s),s};const Uu=Symbol("INITIAL_DATA");class SA{constructor(){f(this,ac),f(this,$e,Object.create(null))}get(t,e=null){if(e){const s=p(this,ac,Hb).call(this,t);return s.promise.then(()=>e(s.data)),null}const i=r(this,$e)[t];if(!i||i.data===Uu)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=r(this,$e)[t];return!!e&&e.data!==Uu}resolve(t,e=null){const i=p(this,ac,Hb).call(this,t);i.data=e,i.resolve()}clear(){for(const t in r(this,$e)){const{data:e}=r(this,$e)[t];e?.bitmap?.close()}m(this,$e,Object.create(null))}*[Symbol.iterator](){for(const t in r(this,$e)){const{data:e}=r(this,$e)[t];e!==Uu&&(yield[t,e])}}}$e=new WeakMap,ac=new WeakSet,Hb=function(t){var e;return(e=r(this,$e))[t]||(e[t]={...Promise.withResolvers(),data:Uu})};class wE{constructor(t){f(this,Ks,null),m(this,Ks,t),this.onContinue=null}get promise(){return r(this,Ks).capability.promise}cancel(t=0){r(this,Ks).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=r(this,Ks).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=r(this,Ks);return t.form||t.canvas&&e?.size>0}}Ks=new WeakMap;const fo=class{constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:n,operatorList:a,pageIndex:o,canvasFactory:h,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:u=!1,pageColors:g=null}){f(this,Xs,null),this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=h,this.filterFactory=c,this._pdfBug=u,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===d&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new wE(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(r(fo,xr).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");r(fo,xr).add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:n,background:a}=this.params;this.gfx=new Sa(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:n,viewport:s,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),r(this,Xs)&&(window.cancelAnimationFrame(r(this,Xs)),m(this,Xs,null)),r(fo,xr).delete(this._canvas),this.callback(t||new Em(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,Xs,window.requestAnimationFrame(()=>{m(this,Xs,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}_next(){var t=this;return(0,I.Z)(function*(){t.cancelled||(t.operatorListIdx=t.gfx.executeOperatorList(t.operatorList,t.operatorListIdx,t._continueBound,t.stepper),t.operatorListIdx===t.operatorList.argsArray.length&&(t.running=!1,t.operatorList.lastChunk&&(t.gfx.endDrawing(),r(fo,xr).delete(t._canvas),t.callback())))})()}};let zu=fo;Xs=new WeakMap,xr=new WeakMap,f(zu,xr,new WeakSet);const EE="4.6.82",xE="9b541910f";function PA(l){return Math.floor(255*Math.max(0,Math.min(1,l))).toString(16).padStart(2,"0")}function Gl(l){return Math.max(0,Math.min(255,255*l))}class TA{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return[t=Gl(t),t,t]}static G_HTML([t]){const e=PA(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Gl)}static RGB_HTML(t){return`#${t.map(PA).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[Gl(1-Math.min(1,t+s)),Gl(1-Math.min(1,i+s)),Gl(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,n=1-e,a=1-i;return["CMYK",s,n,a,Math.min(s,n,a)]}}class MA{static setupStorage(t,e,i,s,n){const a=s.getValue(e,{value:null});switch(i.name){case"textarea":if(null!==a.value&&(t.textContent=a.value),"print"===n)break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})});break;case"input":if("radio"===i.attributes.type||"checkbox"===i.attributes.type){if(a.value===i.attributes.xfaOn?t.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&t.removeAttribute("checked"),"print"===n)break;t.addEventListener("change",o=>{s.setValue(e,{value:o.target.getAttribute(o.target.checked?"xfaOn":"xfaOff")})})}else{if(null!==a.value&&t.setAttribute("value",a.value),"print"===n)break;t.addEventListener("input",o=>{s.setValue(e,{value:o.target.value})})}break;case"select":if(null!==a.value){t.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}t.addEventListener("input",o=>{const h=o.target.options;s.setValue(e,{value:-1===h.selectedIndex?"":h[h.selectedIndex].value})})}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:n}){const{attributes:a}=e,o=t instanceof HTMLAnchorElement;"radio"===a.type&&(a.name=`${a.name}-${s}`);for(const[h,c]of Object.entries(a))if(null!=c)switch(h){case"class":c.length&&t.setAttribute(h,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||"href"!==h&&"newWindow"!==h)&&t.setAttribute(h,c)}o&&n.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,s=t.xfaHtml,n=t.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:n,linkService:i});const o="richText"!==n,h=t.div;if(h.append(a),t.viewport){const u=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=u}o&&h.setAttribute("class","xfaLayer xfaFont");const c=[];if(0===s.children.length){if(s.value){const u=document.createTextNode(s.value);a.append(u),o&&Wl.shouldBuildText(s.name)&&c.push(u)}return{textDivs:c}}const d=[[s,-1,a]];for(;d.length>0;){const[u,g,b]=d.at(-1);if(g+1===u.children.length){d.pop();continue}const _=u.children[++d.at(-1)[1]];if(null===_)continue;const{name:A}=_;if("#text"===A){const y=document.createTextNode(_.value);c.push(y),b.append(y);continue}const v=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,A):document.createElement(A);if(b.append(v),_.attributes&&this.setAttributes({html:v,element:_,storage:e,intent:n,linkService:i}),_.children?.length>0)d.push([_,-1,v]);else if(_.value){const y=document.createTextNode(_.value);o&&Wl.shouldBuildText(A)&&c.push(y),v.append(y)}}for(const u of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))u.setAttribute("readOnly",!0);return{textDivs:c}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const $l=1e3,Fn=new WeakSet;function Bi(l){return{width:l[2]-l[0],height:l[3]-l[1]}}class SE{static create(t){switch(t.data.annotationType){case 2:return new LA(t);case 1:return new PE(t);case 20:switch(t.data.fieldType){case"Tx":return new TE(t);case"Btn":return t.data.radioButton?new kA(t):t.data.checkBox?new LE(t):new kE(t);case"Ch":return new RE(t);case"Sig":return new ME(t)}return new Nn(t);case 16:return new Bm(t);case 3:return new RA(t);case 4:return new DE(t);case 5:return new OE(t);case 6:return new FE(t);case 8:return new IA(t);case 14:return new BE(t);case 15:return new DA(t);case 7:return new NE(t);case 9:return new HE(t);case 10:return new VE(t);case 11:return new jE(t);case 12:return new UE(t);case 13:return new OA(t);case 17:return new zE(t);default:return new ut(t)}}}const cb=class{constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){f(this,oc),f(this,Cr,null),f(this,po,!1),f(this,go,null),this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:i}){return!!(t?.str||e?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return cb._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;r(this,Cr)||m(this,Cr,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&p(this,oc,Vb).call(this,e),r(this,go)?.popup.updateEdited(t)}resetEdited(){!r(this,Cr)||(p(this,oc,Vb).call(this,r(this,Cr).rect),r(this,go)?.popup.resetEdited(),m(this,Cr,null))}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",e.id),this instanceof Nn||(n.tabIndex=$l);const{style:a}=n;if(a.zIndex=this.parent.zIndex++,e.popupRef&&n.setAttribute("aria-haspopup","dialog"),e.alternativeText&&(n.title=e.alternativeText),e.noRotate&&n.classList.add("norotate"),!e.rect||this instanceof Bm){const{rotation:A}=e;return!e.hasOwnCanvas&&0!==A&&this.setRotation(A,n),n}const{width:o,height:h}=Bi(e.rect);if(!t&&e.borderStyle.width>0){a.borderWidth=`${e.borderStyle.width}px`;const A=e.borderStyle.horizontalCornerRadius,v=e.borderStyle.verticalCornerRadius;switch(A>0||v>0?a.borderRadius=`calc(${A}px * var(--scale-factor)) / calc(${v}px * var(--scale-factor))`:this instanceof kA&&(a.borderRadius=`calc(${o}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`),e.borderStyle.style){case 1:a.borderStyle="solid";break;case 2:a.borderStyle="dashed";break;case 3:z("Unimplemented border style: beveled");break;case 4:z("Unimplemented border style: inset");break;case 5:a.borderBottomStyle="solid"}const y=e.borderColor||null;y?(m(this,po,!0),a.borderColor=O.makeHexColor(0|y[0],0|y[1],0|y[2])):a.borderWidth=0}const c=O.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:d,pageHeight:u,pageX:g,pageY:b}=s.rawDims;a.left=100*(c[0]-g)/d+"%",a.top=100*(c[1]-b)/u+"%";const{rotation:_}=e;return e.hasOwnCanvas||0===_?(a.width=100*o/d+"%",a.height=100*h/u+"%"):this.setRotation(_,n),n}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:n,height:a}=Bi(this.data.rect);let o,h;t%180==0?(o=100*n/i,h=100*a/s):(o=100*a/i,h=100*n/s),e.style.width=`${o}%`,e.style.height=`${h}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const n=s.detail[e],a=n[0],o=n.slice(1);s.target.style[i]=TA[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:TA[`${a}_rgb`](o)})};return Y(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2==1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:1===i||2===i})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail))(t[s]||i[s])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,n]of Object.entries(e)){const a=i[s];a&&(a({detail:{[s]:n},target:t}),delete e[s])}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,n]=this.data.rect.map(A=>Math.fround(A));if(8===t.length){const[A,v,y,E]=t.subarray(2,6);if(s===A&&n===v&&e===y&&i===E)return}const{style:a}=this.container;let o;if(r(this,po)){const{borderColor:A,borderWidth:v}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${v}">`],this.container.classList.add("hasBorder")}const h=s-e,c=n-i,{svgFactory:d}=this,u=d.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0);const g=d.createElement("defs");u.append(g);const b=d.createElement("clipPath"),_=`clippath_${this.data.id}`;b.setAttribute("id",_),b.setAttribute("clipPathUnits","objectBoundingBox"),g.append(b);for(let A=2,v=t.length;A<v;A+=8){const y=t[A],E=t[A+1],x=t[A+2],C=t[A+3],S=d.createElement("rect"),P=(x-e)/h,L=(n-E)/c,k=(y-x)/h,w=(E-C)/c;S.setAttribute("x",P),S.setAttribute("y",L),S.setAttribute("width",k),S.setAttribute("height",w),b.append(S),o?.push(`<rect vector-effect="non-scaling-stroke" x="${P}" y="${L}" width="${k}" height="${w}"/>`)}r(this,po)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(u),this.container.style.clipPath=`url(#${_})`}_createPopup(){const{container:t,data:e}=this;t.setAttribute("aria-haspopup","dialog");const i=m(this,go,new Bm({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(i.render())}render(){bt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:n,id:a,exportValues:o}of s){if(-1===n||a===e)continue;const h="string"==typeof o?o:null,c=document.querySelector(`[data-element-id="${a}"]`);!c||Fn.has(c)?i.push({id:a,exportValue:h,domElement:c}):z(`_getElementsByName - element not allowed: ${a}`)}return i}for(const s of document.getElementsByName(t)){const{exportValue:n}=s,a=s.getAttribute("data-element-id");a!==e&&(!Fn.has(s)||i.push({id:a,exportValue:n,domElement:s}))}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};let ut=cb;Cr=new WeakMap,po=new WeakMap,go=new WeakMap,oc=new WeakSet,Vb=function(t){const{container:{style:e},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:n,pageHeight:a,pageX:o,pageY:h}}}}=this;i?.splice(0,4,...t);const{width:c,height:d}=Bi(t);e.left=100*(t[0]-o)/n+"%",e.top=100*(a-t[3]+h)/a+"%",0===s?(e.width=100*c/n+"%",e.height=100*d/a+"%"):this.setRotation(s)};class LA extends ut{constructor(e,i=null){super(e,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0}),f(this,Zi),f(this,Xf),f(this,Yf),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let n=!1;return e.url?(i.addLinkAttributes(s,e.url,e.newWindow),n=!0):e.action?(this._bindNamedAction(s,e.action),n=!0):e.attachment?(p(this,Xf,vv).call(this,s,e.attachment,e.attachmentDest),n=!0):e.setOCGState?(p(this,Yf,wv).call(this,s,e.setOCGState),n=!0):e.dest?(this._bindLink(s,e.dest),n=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),n=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(s,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(s),this.container}_bindLink(e,i){e.href=this.linkService.getDestinationHash(i),e.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||""===i)&&p(this,Zi,Ea).call(this)}_bindNamedAction(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(i),!1),p(this,Zi,Ea).call(this)}_bindJSAction(e,i){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(i.actions)){const a=s.get(n);!a||(e[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:n}}),!1))}e.onclick||(e.onclick=()=>!1),p(this,Zi,Ea).call(this)}_bindResetFormAction(e,i){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),p(this,Zi,Ea).call(this),!this._fieldObjects)return z('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(s||(e.onclick=()=>!1));e.onclick=()=>{s?.();const{fields:n,refs:a,include:o}=i,h=[];if(0!==n.length||0!==a.length){const u=new Set(a);for(const g of n){const b=this._fieldObjects[g]||[];for(const{id:_}of b)u.add(_)}for(const g of Object.values(this._fieldObjects))for(const b of g)u.has(b.id)===o&&h.push(b)}else for(const u of Object.values(this._fieldObjects))h.push(...u);const c=this.annotationStorage,d=[];for(const u of h){const{id:g}=u;switch(d.push(g),u.type){case"text":case"combobox":case"listbox":c.setValue(g,{value:u.defaultValue||""});break;case"checkbox":case"radiobutton":c.setValue(g,{value:u.defaultValue===u.exportValues});break;default:continue}const b=document.querySelector(`[data-element-id="${g}"]`);b&&(Fn.has(b)?b.dispatchEvent(new Event("resetform")):z(`_bindResetFormAction - element not allowed: ${g}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}Zi=new WeakSet,Ea=function(){this.container.setAttribute("data-internal-link","")},Xf=new WeakSet,vv=function(e,i,s=null){e.href=this.linkService.getAnchorUrl(""),i.description&&(e.title=i.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,s),!1),p(this,Zi,Ea).call(this)},Yf=new WeakSet,wv=function(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(i),!1),p(this,Zi,Ea).call(this)};class PE extends ut{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Nn extends ut{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&("CANVAS"===t.previousSibling?.nodeName&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return se.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,n){i.includes("mouse")?t.addEventListener(i,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):t.addEventListener(i,a=>{if("blur"===i){if(!e.focused||!a.relatedTarget)return;e.focused=!1}else if("focus"===i){if(e.focused)return;e.focused=!0}!n||this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:n(a)}})})}_setEventListeners(t,e,i,s){for(const[n,a]of i)("Action"===a||this.data.actions?.[a])&&(("Focus"===a||"Blur"===a)&&(e||(e={focused:!1})),this._setEventListener(t,e,n,a,s),"Focus"!==a||this.data.actions?.Blur?"Blur"===a&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null):this._setEventListener(t,e,"blur","Blur",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":O.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||9,n=t.style;let a;const h=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-2),d=Math.round(c/(1.35*s))||1;a=Math.min(s,h(c/d/1.35))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-2);a=Math.min(s,h(c/1.35))}n.fontSize=`calc(${a}px * var(--scale-factor))`,n.color=O.makeHexColor(i[0],i[1],i[2]),null!==this.data.textAlignment&&(n.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class TE extends Nn{constructor(t){super(t,{isRenderable:t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,e,i,s){const n=this.annotationStorage;for(const a of this._getElementsByName(t.name,t.id))a.domElement&&(a.domElement[e]=i),n.setValue(a.id,{[s]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let n=s.value||"";const a=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;a&&n.length>a&&(n=n.slice(0,a));let o=s.formattedValue||this.data.textContent?.join("\n")||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const h={userValue:n,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=o??n,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",o??n),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Fn.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=$l,this._setRequired(i,this.data.required),a&&(i.maxLength=a),i.addEventListener("input",d=>{t.setValue(e,{value:d.target.value}),this.setPropertyOnSiblings(i,"value",d.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",d=>{i.value=h.userValue=this.data.defaultFieldValue??"",h.formattedValue=null});let c=d=>{const{formattedValue:u}=h;null!=u&&(d.target.value=u),d.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",u=>{if(h.focused)return;const{target:g}=u;h.userValue&&(g.value=h.userValue),h.lastCommittedValue=g.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",u=>{this.showElementAndHideCanvas(u.target),this._dispatchEventFromSandbox({value(b){h.userValue=b.detail.value??"",t.setValue(e,{value:h.userValue.toString()}),b.target.value=h.userValue},formattedValue(b){const{formattedValue:_}=b.detail;h.formattedValue=_,null!=_&&b.target!==document.activeElement&&(b.target.value=_),t.setValue(e,{formattedValue:_})},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{const{charLimit:_}=b.detail,{target:A}=b;if(0===_)return void A.removeAttribute("maxLength");A.setAttribute("maxLength",_);let v=h.userValue;!v||v.length<=_||(v=v.slice(0,_),A.value=h.userValue=v,t.setValue(e,{value:v}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:v,willCommit:!0,commitKey:1,selStart:A.selectionStart,selEnd:A.selectionEnd}}))}},u)}),i.addEventListener("keydown",u=>{h.commitKey=1;let g=-1;if("Escape"===u.key?g=0:"Enter"!==u.key||this.data.multiLine?"Tab"===u.key&&(h.commitKey=3):g=2,-1===g)return;const{value:b}=u.target;h.lastCommittedValue!==b&&(h.lastCommittedValue=b,h.userValue=b,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:b,willCommit:!0,commitKey:g,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}))});const d=c;c=null,i.addEventListener("blur",u=>{if(!h.focused||!u.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{value:g}=u.target;h.userValue=g,h.lastCommittedValue!==g&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:g,willCommit:!0,commitKey:h.commitKey,selStart:u.target.selectionStart,selEnd:u.target.selectionEnd}}),d(u)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",u=>{h.lastCommittedValue=null;const{data:g,target:b}=u,{value:_,selectionStart:A,selectionEnd:v}=b;let y=A,E=v;switch(u.inputType){case"deleteWordBackward":{const x=_.substring(0,A).match(/\w*[^\w]*$/);x&&(y-=x[0].length);break}case"deleteWordForward":{const x=_.substring(A).match(/^[^\w]*\w*/);x&&(E+=x[0].length);break}case"deleteContentBackward":A===v&&(y-=1);break;case"deleteContentForward":A===v&&(E+=1)}u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,change:g||"",willCommit:!1,selStart:y,selEnd:E}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.value)}if(c&&i.addEventListener("blur",c),this.data.comb){const u=(this.data.rect[2]-this.data.rect[0])/a;i.classList.add("comb"),i.style.letterSpacing=`calc(${u}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class ME extends Nn{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class LE extends Nn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;"string"==typeof s&&(s="Off"!==s,t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const n=document.createElement("input");return Fn.add(n),n.setAttribute("data-element-id",i),n.disabled=e.readOnly,this._setRequired(n,this.data.required),n.type="checkbox",n.name=e.fieldName,s&&n.setAttribute("checked",!0),n.setAttribute("exportValue",e.exportValue),n.tabIndex=$l,n.addEventListener("change",a=>{const{name:o,checked:h}=a.target;for(const c of this._getElementsByName(o,i)){const d=h&&c.exportValue===e.exportValue;c.domElement&&(c.domElement.checked=d),t.setValue(c.id,{value:d})}t.setValue(i,{value:h})}),n.addEventListener("resetform",a=>{a.target.checked=(e.defaultFieldValue||"Off")===e.exportValue}),this.enableScripting&&this.hasJSActions&&(n.addEventListener("updatefromsandbox",a=>{this._dispatchEventFromSandbox({value(h){h.target.checked="Off"!==h.detail.value,t.setValue(i,{value:h.target.checked})}},a)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class kA extends Nn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if("string"==typeof s&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const a of this._getElementsByName(e.fieldName,i))t.setValue(a.id,{value:!1});const n=document.createElement("input");if(Fn.add(n),n.setAttribute("data-element-id",i),n.disabled=e.readOnly,this._setRequired(n,this.data.required),n.type="radio",n.name=e.fieldName,s&&n.setAttribute("checked",!0),n.tabIndex=$l,n.addEventListener("change",a=>{const{name:o,checked:h}=a.target;for(const c of this._getElementsByName(o,i))t.setValue(c.id,{value:!1});t.setValue(i,{value:h})}),n.addEventListener("resetform",a=>{const o=e.defaultFieldValue;a.target.checked=null!=o&&o===e.buttonValue}),this.enableScripting&&this.hasJSActions){const a=e.buttonValue;n.addEventListener("updatefromsandbox",o=>{this._dispatchEventFromSandbox({value:c=>{const d=a===c.detail.value;for(const u of this._getElementsByName(c.target.name)){const g=d&&u.id===i;u.domElement&&(u.domElement.checked=g),t.setValue(u.id,{value:g})}}},o)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class kE extends LA{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class RE extends Nn{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");Fn.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=$l;let n=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",d=>{const u=this.data.defaultFieldValue;for(const g of s.options)g.selected=g.value===u});for(const d of this.data.options){const u=document.createElement("option");u.textContent=d.displayValue,u.value=d.exportValue,i.value.includes(d.exportValue)&&(u.setAttribute("selected",!0),n=!1),s.append(u)}let a=null;if(n){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),s.prepend(d),a=()=>{d.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=d=>{const u=d?"value":"textContent",{options:g,multiple:b}=s;return b?Array.prototype.filter.call(g,_=>_.selected).map(_=>_[u]):-1===g.selectedIndex?null:g[g.selectedIndex][u]};let h=o(!1);const c=d=>Array.prototype.map.call(d.target.options,g=>({displayValue:g.textContent,exportValue:g.value}));return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",d=>{this._dispatchEventFromSandbox({value(g){a?.();const b=g.detail.value,_=new Set(Array.isArray(b)?b:[b]);for(const A of s.options)A.selected=_.has(A.value);t.setValue(e,{value:o(!0)}),h=o(!1)},multipleSelection(g){s.multiple=!0},remove(g){const b=s.options,_=g.detail.remove;b[_].selected=!1,s.remove(_),b.length>0&&-1===Array.prototype.findIndex.call(b,v=>v.selected)&&(b[0].selected=!0),t.setValue(e,{value:o(!0),items:c(g)}),h=o(!1)},clear(g){for(;0!==s.length;)s.remove(0);t.setValue(e,{value:null,items:[]}),h=o(!1)},insert(g){const{index:b,displayValue:_,exportValue:A}=g.detail.insert,v=s.children[b],y=document.createElement("option");y.textContent=_,y.value=A,v?v.before(y):s.append(y),t.setValue(e,{value:o(!0),items:c(g)}),h=o(!1)},items(g){const{items:b}=g.detail;for(;0!==s.length;)s.remove(0);for(const _ of b){const{displayValue:A,exportValue:v}=_,y=document.createElement("option");y.textContent=A,y.value=v,s.append(y)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:o(!0),items:c(g)}),h=o(!1)},indices(g){const b=new Set(g.detail.indices);for(const _ of g.target.options)_.selected=b.has(_.index);t.setValue(e,{value:o(!0)}),h=o(!1)},editable(g){g.target.disabled=!g.detail.editable}},d)}),s.addEventListener("input",d=>{const u=o(!0),g=o(!1);t.setValue(e,{value:u}),d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:g,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):s.addEventListener("input",function(d){t.setValue(e,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Bm extends ut{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:ut._hasPopupData(e)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new IE({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const i of this.elements)i.popup=t,e.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(i=>`${G_}${i}`).join(",")),this.container}}class IE{constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:n,contentsObj:a,richText:o,parent:h,rect:c,parentRect:d,open:u}){f(this,yo),f(this,uc),f(this,Qf),f(this,tp),f(this,ep),f(this,ip),f(this,vo),f(this,wo),f(this,fc),f(this,mo,p(this,ep,Cv).bind(this)),f(this,Zf,p(this,fc,Ub).bind(this)),f(this,Jf,p(this,wo,Gg).bind(this)),f(this,bo,p(this,vo,Wg).bind(this)),f(this,Sr,null),f(this,dt,null),f(this,Ji,null),f(this,_o,null),f(this,lc,null),f(this,hc,null),f(this,Ao,null),f(this,Qi,!1),f(this,qe,null),f(this,ts,null),f(this,cc,null),f(this,es,null),f(this,dc,null),f(this,Pr,null),f(this,Tr,!1),m(this,dt,t),m(this,dc,s),m(this,Ji,a),m(this,es,o),m(this,hc,h),m(this,Sr,e),m(this,cc,c),m(this,Ao,d),m(this,lc,i),m(this,_o,tA.toDateObject(n)),this.trigger=i.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",r(this,bo)),g.addEventListener("mouseenter",r(this,Jf)),g.addEventListener("mouseleave",r(this,Zf)),g.classList.add("popupTriggerArea");for(const g of i)g.container?.addEventListener("keydown",r(this,mo));r(this,dt).hidden=!0,u&&p(this,vo,Wg).call(this)}render(){if(r(this,qe))return;const t=m(this,qe,document.createElement("div"));if(t.className="popup",r(this,Sr)){const n=t.style.outlineColor=O.makeHexColor(...r(this,Sr));t.style.backgroundColor=CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?`color-mix(in srgb, ${n} 30%, white)`:O.makeHexColor(...r(this,Sr).map(o=>Math.floor(.7*(255-o)+o)))}const e=document.createElement("span");e.className="header";const i=document.createElement("h1");if(e.append(i),({dir:i.dir,str:i.textContent}=r(this,dc)),t.append(e),r(this,_o)){const n=document.createElement("span");n.classList.add("popupDate"),n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:r(this,_o).valueOf()})),e.append(n)}const s=r(this,yo,zg);if(s)MA.render({xfaHtml:s,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const n=this._formatContents(r(this,Ji));t.append(n)}r(this,dt).append(t)}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let n=0,a=s.length;n<a;++n)i.append(document.createTextNode(s[n])),n<a-1&&i.append(document.createElement("br"));return i}updateEdited({rect:t,popupContent:e}){r(this,Pr)||m(this,Pr,{contentsObj:r(this,Ji),richText:r(this,es)}),t&&m(this,ts,null),e&&(m(this,es,p(this,tp,xv).call(this,e)),m(this,Ji,null)),r(this,qe)?.remove(),m(this,qe,null)}resetEdited(){!r(this,Pr)||(({contentsObj:ee(this,Ji)._,richText:ee(this,es)._}=r(this,Pr)),m(this,Pr,null),r(this,qe)?.remove(),m(this,qe,null),m(this,ts,null))}forceHide(){m(this,Tr,this.isVisible),r(this,Tr)&&(r(this,dt).hidden=!0)}maybeShow(){!r(this,Tr)||(r(this,qe)||p(this,wo,Gg).call(this),m(this,Tr,!1),r(this,dt).hidden=!1)}get isVisible(){return!1===r(this,dt).hidden}}mo=new WeakMap,Zf=new WeakMap,Jf=new WeakMap,bo=new WeakMap,Sr=new WeakMap,dt=new WeakMap,Ji=new WeakMap,_o=new WeakMap,lc=new WeakMap,hc=new WeakMap,Ao=new WeakMap,Qi=new WeakMap,qe=new WeakMap,ts=new WeakMap,cc=new WeakMap,es=new WeakMap,dc=new WeakMap,Pr=new WeakMap,Tr=new WeakMap,yo=new WeakSet,zg=function(){const t=r(this,es),e=r(this,Ji);return t?.str&&(!e?.str||e.str===t.str)&&r(this,es).html||null},uc=new WeakSet,jb=function(){return r(this,yo,zg)?.attributes?.style?.fontSize||0},Qf=new WeakSet,Ev=function(){return r(this,yo,zg)?.attributes?.style?.color||null},tp=new WeakSet,xv=function(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:r(this,Qf,Ev),fontSize:r(this,uc,jb)?`calc(${r(this,uc,jb)}px * var(--scale-factor))`:""}};for(const n of t.split("\n"))e.push({name:"span",value:n,attributes:s});return i},ep=new WeakSet,Cv=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||("Enter"===t.key||"Escape"===t.key&&r(this,Qi))&&p(this,vo,Wg).call(this)},ip=new WeakSet,Sv=function(){if(null!==r(this,ts))return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:s,pageY:n}}}=r(this,hc);let a=!!r(this,Ao),o=r(this,a?Ao:cc);for(const _ of r(this,lc))if(!o||null!==O.intersect(_.data.rect,o)){o=_.data.rect,a=!0;break}const h=O.normalizeRect([o[0],t[3]-o[1]+t[1],o[2],t[3]-o[3]+t[1]]);m(this,ts,[100*(h[0]+(a?o[2]-o[0]+5:0)-s)/e,100*(h[1]-n)/i]);const{style:b}=r(this,dt);b.left=`${r(this,ts)[0]}%`,b.top=`${r(this,ts)[1]}%`},vo=new WeakSet,Wg=function(){m(this,Qi,!r(this,Qi)),r(this,Qi)?(p(this,wo,Gg).call(this),r(this,dt).addEventListener("click",r(this,bo)),r(this,dt).addEventListener("keydown",r(this,mo))):(p(this,fc,Ub).call(this),r(this,dt).removeEventListener("click",r(this,bo)),r(this,dt).removeEventListener("keydown",r(this,mo)))},wo=new WeakSet,Gg=function(){r(this,qe)||this.render(),this.isVisible?r(this,Qi)&&r(this,dt).classList.add("focused"):(p(this,ip,Sv).call(this),r(this,dt).hidden=!1,r(this,dt).style.zIndex=parseInt(r(this,dt).style.zIndex)+1e3)},fc=new WeakSet,Ub=function(){r(this,dt).classList.remove("focused"),!r(this,Qi)&&this.isVisible&&(r(this,dt).hidden=!0,r(this,dt).style.zIndex=parseInt(r(this,dt).style.zIndex)-1e3)};class RA extends ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=K.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class DE extends ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),f(this,pc,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:i,height:s}=Bi(e.rect),n=this.svgFactory.create(i,s,!0),a=m(this,pc,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,pc)}addHighlightArea(){this.container.classList.add("highlightArea")}}pc=new WeakMap;class OE extends ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),f(this,gc,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:i,height:s}=Bi(e.rect),n=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=m(this,gc,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,gc)}addHighlightArea(){this.container.classList.add("highlightArea")}}gc=new WeakMap;class FE extends ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),f(this,mc,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:i,height:s}=Bi(e.rect),n=this.svgFactory.create(i,s,!0),a=e.borderStyle.width,o=m(this,mc,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",s/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),n.append(o),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,mc)}addHighlightArea(){this.container.classList.add("highlightArea")}}mc=new WeakMap;class IA extends ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),f(this,bc,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:i,borderStyle:s,popupRef:n}}=this;if(!i)return this.container;const{width:a,height:o}=Bi(e),h=this.svgFactory.create(a,o,!0);let c=[];for(let u=0,g=i.length;u<g;u+=2)c.push(`${i[u]-e[0]},${e[3]-i[u+1]}`);c=c.join(" ");const d=m(this,bc,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",c),d.setAttribute("stroke-width",s.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),h.append(d),this.container.append(h),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return r(this,bc)}addHighlightArea(){this.container.classList.add("highlightArea")}}bc=new WeakMap;class NE extends IA{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class BE extends ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class DA extends ut{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),f(this,_c,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=K.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,inkLists:i,borderStyle:s,popupRef:n}}=this,{width:a,height:o}=Bi(e),h=this.svgFactory.create(a,o,!0);for(const c of i){let d=[];for(let g=0,b=c.length;g<b;g+=2)d.push(`${c[g]-e[0]},${e[3]-c[g+1]}`);d=d.join(" ");const u=this.svgFactory.createElement(this.svgElementName);r(this,_c).push(u),u.setAttribute("points",d),u.setAttribute("stroke-width",s.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),!n&&this.hasPopupData&&this._createPopup(),h.append(u)}return this.container.append(h),this.container}getElementsToTriggerPopup(){return r(this,_c)}addHighlightArea(){this.container.classList.add("highlightArea")}}_c=new WeakMap;class HE extends ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class VE extends ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class jE extends ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class UE extends ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class OA extends ut{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class zE extends ut{constructor(e){super(e,{isRenderable:!0}),f(this,yc),f(this,Ac,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:i}=this;let s;i.hasAppearance||0===i.fillAlpha?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(100*i.fillAlpha)}%);`)),s.addEventListener("dblclick",p(this,yc,zb).bind(this)),m(this,Ac,s);const{isMac:n}=se.platform;return e.addEventListener("keydown",a=>{"Enter"===a.key&&(n?a.metaKey:a.ctrlKey)&&p(this,yc,zb).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return r(this,Ac)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ac=new WeakMap,yc=new WeakSet,zb=function(){this.downloadManager?.openOrDownloadData(this.content,this.filename)};class WE{constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:s,page:n,viewport:a}){f(this,sp),f(this,wc),f(this,vc,null),f(this,Mr,null),f(this,Lr,new Map),this.div=t,m(this,vc,e),m(this,Mr,i),this.page=n,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return r(this,Lr).size>0}render(t){var e=this;return(0,I.Z)(function*(){var o,h;const{annotations:i}=t,s=e.div;On(s,e.viewport);const n=new Map,a={data:null,layer:s,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new wm,annotationStorage:t.annotationStorage||new Tm,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:e,elements:null};for(const c of i){if(c.noHTML)continue;const d=16===c.annotationType;if(d){const b=n.get(c.id);if(!b)continue;a.elements=b}else{const{width:b,height:_}=Bi(c.rect);if(b<=0||_<=0)continue}a.data=c;const u=SE.create(a);if(!u.isRenderable)continue;if(!d&&c.popupRef){const b=n.get(c.popupRef);b?b.push(u):n.set(c.popupRef,[u])}const g=u.render();c.hidden&&(g.style.visibility="hidden"),p(o=e,sp,Pv).call(o,g,c.id),u._isEditable&&(r(e,Lr).set(u.data.id,u),e._annotationEditorUIManager?.renderAnnotationElement(u))}p(h=e,wc,Wb).call(h)})()}update({viewport:t}){const e=this.div;this.viewport=t,On(e,{rotation:t.rotation}),p(this,wc,Wb).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(r(this,Lr).values())}getEditableAnnotation(t){return r(this,Lr).get(t)}}vc=new WeakMap,Mr=new WeakMap,Lr=new WeakMap,sp=new WeakSet,Pv=function(t,e){const i=t.firstChild||t;i.id=`${G_}${e}`,this.div.append(t),r(this,vc)?.moveElementInDOM(this.div,t,i,!1)},wc=new WeakSet,Wb=function(){if(!r(this,Mr))return;const t=this.div;for(const[e,i]of r(this,Mr)){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:n}=s;n?"CANVAS"===n.nodeName?n.replaceWith(i):n.classList.contains("annotationContent")?n.after(i):n.before(i):s.append(i)}r(this,Mr).clear()};const Wu=/\r\n?|\n/g,xt=class extends G{constructor(e){super({...e,name:"freeTextEditor"}),f(this,np),f(this,rp),f(this,ap),f(this,xo),f(this,So),f(this,op),f(this,lp),f(this,Ke,void 0),f(this,ge,""),f(this,Ec,`${this.id}-editor`),f(this,kr,null),f(this,me,void 0),f(this,Eo,null),m(this,Ke,e.color||xt._defaultColor||G._defaultLineColor),m(this,me,e.fontSize||xt._defaultFontSize)}static get _keyboardManager(){const e=xt.prototype,i=a=>a.isEmpty(),s=Fi.TRANSLATE_SMALL,n=Fi.TRANSLATE_BIG;return Y(this,"_keyboardManager",new Vl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:i}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[n,0],checker:i}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:i}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,n],checker:i}]]))}static initialize(e,i){G.initialize(e,i,{strings:["pdfjs-free-text-default-content"]});const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,i){switch(e){case V.FREETEXT_SIZE:xt._defaultFontSize=i;break;case V.FREETEXT_COLOR:xt._defaultColor=i}}updateParams(e,i){switch(e){case V.FREETEXT_SIZE:p(this,np,Tv).call(this,i);break;case V.FREETEXT_COLOR:p(this,rp,Mv).call(this,i)}}static get defaultPropertiesToUpdate(){return[[V.FREETEXT_SIZE,xt._defaultFontSize],[V.FREETEXT_COLOR,xt._defaultColor||G._defaultLineColor]]}get propertiesToUpdate(){return[[V.FREETEXT_SIZE,r(this,me)],[V.FREETEXT_COLOR,r(this,Ke)]]}_translateEmpty(e,i){this._uiManager.translateSelectedEditors(e,i,!0)}getInitialTranslation(){const e=this.parentScale;return[-xt._internalPadding*e,-(xt._internalPadding+r(this,me))*e]}rebuild(){!this.parent||(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(K.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,kr,new AbortController);const e=this._uiManager.combinedSignal(r(this,kr));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){!this.isInEditMode()||(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",r(this,Ec)),this._isDraggable=!0,r(this,kr)?.abort(),m(this,kr,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){!this._focusEventsAllowed||(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=r(this,ge),i=m(this,ge,p(this,ap,Lv).call(this).trimEnd());if(e===i)return;const s=n=>{m(this,ge,n),n?(p(this,So,Kg).call(this),this._uiManager.rebuild(this),p(this,xo,$g).call(this)):this.remove()};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(e)},mustExec:!1}),p(this,xo,$g).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){xt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",r(this,Ec)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),G._l10nPromise.get("pdfjs-free-text-default-content").then(n=>this.editorDiv?.setAttribute("default-content",n)),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${r(this,me)}px * var(--scale-factor))`,s.color=r(this,Ke),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Du(this,this.div,["dblclick","keydown"]),this.width){const[n,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=r(this,Eo);let[h,c]=this.getInitialTranslation();[h,c]=this.pageTranslationToScreen(h,c);const[d,u]=this.pageDimensions,[g,b]=this.pageTranslation;let _,A;switch(this.rotation){case 0:_=e+(o[0]-g)/d,A=i+this.height-(o[1]-b)/u;break;case 90:_=e+(o[0]-g)/d,A=i-(o[1]-b)/u,[h,c]=[c,-h];break;case 180:_=e-this.width+(o[0]-g)/d,A=i-(o[1]-b)/u,[h,c]=[-h,-c];break;case 270:_=e+(o[0]-g-this.height*u)/d,A=i+(o[1]-b-this.width*d)/u,[h,c]=[-c,h]}this.setAt(_*n,A*a,h,c)}else this.setAt(e*n,i*a,this.width*n,this.height*a);p(this,So,Kg).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var _,A,v;const i=e.clipboardData||window.clipboardData,{types:s}=i;if(1===s.length&&"text/plain"===s[0])return;e.preventDefault();const n=p(_=xt,xc,Gb).call(_,i.getData("text")||"").replaceAll(Wu,"\n");if(!n)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!n.includes("\n"))return o.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),void a.collapseToStart();const{startContainer:h,startOffset:c}=o,d=[],u=[];if(h.nodeType===Node.TEXT_NODE){const y=h.parentElement;if(u.push(h.nodeValue.slice(c).replaceAll(Wu,"")),y!==this.editorDiv){let E=d;for(const x of this.editorDiv.childNodes)x!==y?E.push(p(A=xt,Co,qg).call(A,x)):E=u}d.push(h.nodeValue.slice(0,c).replaceAll(Wu,""))}else if(h===this.editorDiv){let y=d,E=0;for(const x of this.editorDiv.childNodes)E++===c&&(y=u),y.push(p(v=xt,Co,qg).call(v,x))}m(this,ge,`${d.join("\n")}${n}${u.join("\n")}`),p(this,So,Kg).call(this);const g=new Range;let b=d.reduce((y,E)=>y+E.length,0);for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const E=y.nodeValue.length;if(b<=E){g.setStart(y,b),g.setEnd(y,b);break}b-=E}a.removeAllRanges(),a.addRange(g)}get contentDiv(){return this.editorDiv}static deserialize(e,i,s){var o;let n=null;if(e instanceof RA){const{data:{defaultAppearanceData:{fontSize:h,fontColor:c},rect:d,rotation:u,id:g},textContent:b,textPosition:_,parent:{page:{pageNumber:A}}}=e;if(!b||0===b.length)return null;n=e={annotationType:K.FREETEXT,color:Array.from(c),fontSize:h,value:b.join("\n"),position:_,pageIndex:A-1,rect:d.slice(0),rotation:u,id:g,deleted:!1}}const a=super.deserialize(e,i,s);return m(a,me,e.fontSize),m(a,Ke,O.makeHexColor(...e.color)),m(a,ge,p(o=xt,xc,Gb).call(o,e.value)),a.annotationElementId=e.id||null,m(a,Eo,n),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const i=xt._internalPadding*this.parentScale,s=this.getRect(i,i),n=G._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:r(this,Ke)),a={annotationType:K.FREETEXT,color:n,fontSize:r(this,me),value:p(this,op,kv).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?a:this.annotationElementId&&!p(this,lp,Rv).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(e){const i=super.renderAnnotationElement(e);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${r(this,me)}px * var(--scale-factor))`,s.color=r(this,Ke),i.replaceChildren();for(const a of r(this,ge).split("\n")){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const n=xt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(n,n),popupContent:r(this,ge)}),i}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};let Oe=xt;Ke=new WeakMap,ge=new WeakMap,Ec=new WeakMap,kr=new WeakMap,me=new WeakMap,Eo=new WeakMap,np=new WeakSet,Tv=function(e){const i=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--scale-factor))`,this.translate(0,-(n-r(this,me))*this.parentScale),m(this,me,n),p(this,xo,$g).call(this)},s=r(this,me);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:V.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},rp=new WeakSet,Mv=function(e){const i=n=>{m(this,Ke,this.editorDiv.style.color=n)},s=r(this,Ke);this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:V.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},ap=new WeakSet,Lv=function(){var i;const e=[];this.editorDiv.normalize();for(const s of this.editorDiv.childNodes)e.push(p(i=xt,Co,qg).call(i,s));return e.join("\n")},xo=new WeakSet,$g=function(){const[e,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:n,div:a}=this,o=a.style.display,h=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",n.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",h)}this.rotation%180==this.parentRotation%180?(this.width=s.width/e,this.height=s.height/i):(this.width=s.height/e,this.height=s.width/i),this.fixAndSetPosition()},Co=new WeakSet,qg=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Wu,"")},So=new WeakSet,Kg=function(){if(this.editorDiv.replaceChildren(),r(this,ge))for(const e of r(this,ge).split("\n")){const i=document.createElement("div");i.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(i)}},op=new WeakSet,kv=function(){return r(this,ge).replaceAll("\xa0"," ")},xc=new WeakSet,Gb=function(e){return e.replaceAll(" ","\xa0")},lp=new WeakSet,Rv=function(e){const{value:i,fontSize:s,color:n,pageIndex:a}=r(this,Eo);return this._hasBeenMoved||e.value!==i||e.fontSize!==s||e.color.some((o,h)=>o!==n[h])||e.pageIndex!==a},f(Oe,Co),f(Oe,xc),R(Oe,"_freeTextDefaultContent",""),R(Oe,"_internalPadding",0),R(Oe,"_defaultColor",null),R(Oe,"_defaultFontSize",10),R(Oe,"_type","freetext"),R(Oe,"_editorType",K.FREETEXT);class FA{constructor(t,e=0,i=0,s=!0){f(this,hp),f(this,Po),f(this,cp),f(this,dp),f(this,Sc),f(this,Cc,void 0),f(this,Ys,[]),f(this,Xe,[]);let n=1/0,a=-1/0,o=1/0,h=-1/0;const d=10**-4;for(const{x:y,y:E,width:x,height:C}of t){const S=Math.floor((y-e)/d)*d,P=Math.ceil((y+x+e)/d)*d,L=Math.floor((E-e)/d)*d,k=Math.ceil((E+C+e)/d)*d,w=[S,L,k,!0],T=[P,L,k,!1];r(this,Ys).push(w,T),n=Math.min(n,S),a=Math.max(a,P),o=Math.min(o,L),h=Math.max(h,k)}const u=a-n+2*i,g=h-o+2*i,b=n-i,_=o-i,A=r(this,Ys).at(s?-1:-2),v=[A[0],A[2]];for(const y of r(this,Ys)){const[E,x,C]=y;y[0]=(E-b)/u,y[1]=(x-_)/g,y[2]=(C-_)/g}m(this,Cc,{x:b,y:_,width:u,height:g,lastPoint:v})}getOutlines(){r(this,Ys).sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of r(this,Ys))e[3]?(t.push(...p(this,Sc,$b).call(this,e)),p(this,cp,Dv).call(this,e)):(p(this,dp,Ov).call(this,e),t.push(...p(this,Sc,$b).call(this,e)));return p(this,hp,Iv).call(this,t)}}Cc=new WeakMap,Ys=new WeakMap,Xe=new WeakMap,hp=new WeakSet,Iv=function(t){const e=[],i=new Set;for(const a of t){const[o,h,c]=a;e.push([o,h,a],[o,c,a])}e.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=e.length;a<o;a+=2){const h=e[a][2],c=e[a+1][2];h.push(c),c.push(h),i.add(h),i.add(c)}const s=[];let n;for(;i.size>0;){const a=i.values().next().value;let[o,h,c,d,u]=a;i.delete(a);let g=o,b=h;for(n=[o,c],s.push(n);;){let _;if(i.has(d))_=d;else{if(!i.has(u))break;_=u}i.delete(_),[o,h,c,d,u]=_,g!==o&&(n.push(g,b,o,b===h?h:c),g=o),b=b===h?c:h}n.push(g,b)}return new GE(s,r(this,Cc))},Po=new WeakSet,Xg=function(t){const e=r(this,Xe);let i=0,s=e.length-1;for(;i<=s;){const n=i+s>>1,a=e[n][0];if(a===t)return n;a<t?i=n+1:s=n-1}return s+1},cp=new WeakSet,Dv=function([,t,e]){const i=p(this,Po,Xg).call(this,t);r(this,Xe).splice(i,0,[t,e])},dp=new WeakSet,Ov=function([,t,e]){const i=p(this,Po,Xg).call(this,t);for(let s=i;s<r(this,Xe).length;s++){const[n,a]=r(this,Xe)[s];if(n!==t)break;if(n===t&&a===e)return void r(this,Xe).splice(s,1)}for(let s=i-1;s>=0;s--){const[n,a]=r(this,Xe)[s];if(n!==t)break;if(n===t&&a===e)return void r(this,Xe).splice(s,1)}},Sc=new WeakSet,$b=function(t){const[e,i,s]=t,n=[[e,i,s]],a=p(this,Po,Xg).call(this,s);for(let o=0;o<a;o++){const[h,c]=r(this,Xe)[o];for(let d=0,u=n.length;d<u;d++){const[,g,b]=n[d];if(!(c<=g||b<=h)){if(g>=h){if(b>c)n[d][1]=c;else{if(1===u)return[];n.splice(d,1),d--,u--}continue}n[d][2]=h,b>c&&n.push([e,c,b])}}}return n};class NA{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(t,e){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof Hm}}class GE extends NA{constructor(e,i){super(),f(this,Pc,void 0),f(this,To,void 0),m(this,To,e),m(this,Pc,i)}toSVGPath(){const e=[];for(const i of r(this,To)){let[s,n]=i;e.push(`M${s} ${n}`);for(let a=2;a<i.length;a+=2){const o=i[a],h=i[a+1];o===s?(e.push(`V${h}`),n=h):h===n&&(e.push(`H${o}`),s=o)}e.push("Z")}return e.join(" ")}serialize([e,i,s,n],a){const o=[],h=s-e,c=n-i;for(const d of r(this,To)){const u=new Array(d.length);for(let g=0;g<d.length;g+=2)u[g]=e+d[g]*h,u[g+1]=n-d[g+1]*c;o.push(u)}return o}get box(){return r(this,Pc)}}Pc=new WeakMap,To=new WeakMap;const Io=class{constructor({x:t,y:e},i,s,n,a,o=0){f(this,kc),f(this,_i,void 0),f(this,is,[]),f(this,Mo,void 0),f(this,Lo,void 0),f(this,Ai,[]),f(this,X,new Float64Array(18)),f(this,Rr,void 0),f(this,Ir,void 0),f(this,Tc,void 0),f(this,Mc,void 0),f(this,ko,void 0),f(this,Ro,void 0),f(this,Zs,[]),m(this,_i,i),m(this,Ro,n*s),m(this,Lo,a),r(this,X).set([NaN,NaN,NaN,NaN,t,e],6),m(this,Mo,o),m(this,Mc,r(Io,Lc)*s),m(this,Tc,r(Io,fp)*s),m(this,ko,s),r(this,Zs).push(t,e)}get free(){return!0}isEmpty(){return isNaN(r(this,X)[8])}add({x:t,y:e}){m(this,Rr,t),m(this,Ir,e);const[i,s,n,a]=r(this,_i);let[o,h,c,d]=r(this,X).subarray(8,12);const u=t-c,g=e-d,b=Math.hypot(u,g);if(b<r(this,Tc))return!1;const _=b-r(this,Mc),A=_/b,v=A*u,y=A*g;let E=o,x=h;o=c,h=d,c+=v,d+=y,r(this,Zs)?.push(t,e);const S=v/_,P=-y/_*r(this,Ro),L=S*r(this,Ro);return r(this,X).set(r(this,X).subarray(2,8),0),r(this,X).set([c+P,d+L],4),r(this,X).set(r(this,X).subarray(14,18),12),r(this,X).set([c-P,d-L],16),isNaN(r(this,X)[6])?(0===r(this,Ai).length&&(r(this,X).set([o+P,h+L],2),r(this,Ai).push(NaN,NaN,NaN,NaN,(o+P-i)/n,(h+L-s)/a),r(this,X).set([o-P,h-L],14),r(this,is).push(NaN,NaN,NaN,NaN,(o-P-i)/n,(h-L-s)/a)),r(this,X).set([E,x,o,h,c,d],6),!this.isEmpty()):(r(this,X).set([E,x,o,h,c,d],6),Math.abs(Math.atan2(x-h,E-o)-Math.atan2(y,v))<Math.PI/2?([o,h,c,d]=r(this,X).subarray(2,6),r(this,Ai).push(NaN,NaN,NaN,NaN,((o+c)/2-i)/n,((h+d)/2-s)/a),[o,h,E,x]=r(this,X).subarray(14,18),r(this,is).push(NaN,NaN,NaN,NaN,((E+o)/2-i)/n,((x+h)/2-s)/a),!0):([E,x,o,h,c,d]=r(this,X).subarray(0,6),r(this,Ai).push(((E+5*o)/6-i)/n,((x+5*h)/6-s)/a,((5*o+c)/6-i)/n,((5*h+d)/6-s)/a,((o+c)/2-i)/n,((h+d)/2-s)/a),[c,d,o,h,E,x]=r(this,X).subarray(12,18),r(this,is).push(((E+5*o)/6-i)/n,((x+5*h)/6-s)/a,((5*o+c)/6-i)/n,((5*h+d)/6-s)/a,((o+c)/2-i)/n,((h+d)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const t=r(this,Ai),e=r(this,is),i=r(this,X).subarray(4,6),s=r(this,X).subarray(16,18),[n,a,o,h]=r(this,_i),[c,d,u,g]=p(this,kc,qb).call(this);if(isNaN(r(this,X)[6])&&!this.isEmpty())return`M${(r(this,X)[2]-n)/o} ${(r(this,X)[3]-a)/h} L${(r(this,X)[4]-n)/o} ${(r(this,X)[5]-a)/h} L${c} ${d} L${u} ${g} L${(r(this,X)[16]-n)/o} ${(r(this,X)[17]-a)/h} L${(r(this,X)[14]-n)/o} ${(r(this,X)[15]-a)/h} Z`;const b=[];b.push(`M${t[4]} ${t[5]}`);for(let _=6;_<t.length;_+=6)isNaN(t[_])?b.push(`L${t[_+4]} ${t[_+5]}`):b.push(`C${t[_]} ${t[_+1]} ${t[_+2]} ${t[_+3]} ${t[_+4]} ${t[_+5]}`);b.push(`L${(i[0]-n)/o} ${(i[1]-a)/h} L${c} ${d} L${u} ${g} L${(s[0]-n)/o} ${(s[1]-a)/h}`);for(let _=e.length-6;_>=6;_-=6)isNaN(e[_])?b.push(`L${e[_+4]} ${e[_+5]}`):b.push(`C${e[_]} ${e[_+1]} ${e[_+2]} ${e[_+3]} ${e[_+4]} ${e[_+5]}`);return b.push(`L${e[4]} ${e[5]} Z`),b.join(" ")}getOutlines(){const t=r(this,Ai),e=r(this,is),i=r(this,X),s=i.subarray(4,6),n=i.subarray(16,18),[a,o,h,c]=r(this,_i),d=new Float64Array((r(this,Zs)?.length??0)+2);for(let y=0,E=d.length-2;y<E;y+=2)d[y]=(r(this,Zs)[y]-a)/h,d[y+1]=(r(this,Zs)[y+1]-o)/c;d[d.length-2]=(r(this,Rr)-a)/h,d[d.length-1]=(r(this,Ir)-o)/c;const[u,g,b,_]=p(this,kc,qb).call(this);if(isNaN(i[6])&&!this.isEmpty()){const y=new Float64Array(36);return y.set([NaN,NaN,NaN,NaN,(i[2]-a)/h,(i[3]-o)/c,NaN,NaN,NaN,NaN,(i[4]-a)/h,(i[5]-o)/c,NaN,NaN,NaN,NaN,u,g,NaN,NaN,NaN,NaN,b,_,NaN,NaN,NaN,NaN,(i[16]-a)/h,(i[17]-o)/c,NaN,NaN,NaN,NaN,(i[14]-a)/h,(i[15]-o)/c],0),new Hm(y,d,r(this,_i),r(this,ko),r(this,Mo),r(this,Lo))}const A=new Float64Array(r(this,Ai).length+24+r(this,is).length);let v=t.length;for(let y=0;y<v;y+=2)isNaN(t[y])?A[y]=A[y+1]=NaN:(A[y]=t[y],A[y+1]=t[y+1]);A.set([NaN,NaN,NaN,NaN,(s[0]-a)/h,(s[1]-o)/c,NaN,NaN,NaN,NaN,u,g,NaN,NaN,NaN,NaN,b,_,NaN,NaN,NaN,NaN,(n[0]-a)/h,(n[1]-o)/c],v),v+=24;for(let y=e.length-6;y>=6;y-=6)for(let E=0;E<6;E+=2)isNaN(e[y+E])?(A[v]=A[v+1]=NaN,v+=2):(A[v]=e[y+E],A[v+1]=e[y+E+1],v+=2);return A.set([NaN,NaN,NaN,NaN,e[4],e[5]],v),new Hm(A,d,r(this,_i),r(this,ko),r(this,Mo),r(this,Lo))}};let Bn=Io;_i=new WeakMap,is=new WeakMap,Mo=new WeakMap,Lo=new WeakMap,Ai=new WeakMap,X=new WeakMap,Rr=new WeakMap,Ir=new WeakMap,Tc=new WeakMap,Mc=new WeakMap,ko=new WeakMap,Ro=new WeakMap,Zs=new WeakMap,Lc=new WeakMap,up=new WeakMap,fp=new WeakMap,kc=new WeakSet,qb=function(){const t=r(this,X).subarray(4,6),e=r(this,X).subarray(16,18),[i,s,n,a]=r(this,_i);return[(r(this,Rr)+(t[0]-e[0])/2-i)/n,(r(this,Ir)+(t[1]-e[1])/2-s)/a,(r(this,Rr)+(e[0]-t[0])/2-i)/n,(r(this,Ir)+(e[1]-t[1])/2-s)/a]},f(Bn,Lc,8),f(Bn,up,2),f(Bn,fp,r(Io,Lc)+r(Io,up));class Hm extends NA{constructor(e,i,s,n,a,o){super(),f(this,Or),f(this,Fr),f(this,pp),f(this,Do,void 0),f(this,Dr,null),f(this,ss,void 0),f(this,Rc,void 0),f(this,be,void 0),f(this,Ic,void 0),f(this,ft,void 0),m(this,ft,e),m(this,be,i),m(this,Do,s),m(this,Ic,n),m(this,ss,a),m(this,Rc,o),p(this,pp,Fv).call(this,o);const{x:h,y:c,width:d,height:u}=r(this,Dr);for(let g=0,b=e.length;g<b;g+=2)e[g]=(e[g]-h)/d,e[g+1]=(e[g+1]-c)/u;for(let g=0,b=i.length;g<b;g+=2)i[g]=(i[g]-h)/d,i[g+1]=(i[g+1]-c)/u}toSVGPath(){const e=[`M${r(this,ft)[4]} ${r(this,ft)[5]}`];for(let i=6,s=r(this,ft).length;i<s;i+=6)isNaN(r(this,ft)[i])?e.push(`L${r(this,ft)[i+4]} ${r(this,ft)[i+5]}`):e.push(`C${r(this,ft)[i]} ${r(this,ft)[i+1]} ${r(this,ft)[i+2]} ${r(this,ft)[i+3]} ${r(this,ft)[i+4]} ${r(this,ft)[i+5]}`);return e.push("Z"),e.join(" ")}serialize([e,i,s,n],a){const o=s-e,h=n-i;let c,d;switch(a){case 0:c=p(this,Or,fu).call(this,r(this,ft),e,n,o,-h),d=p(this,Or,fu).call(this,r(this,be),e,n,o,-h);break;case 90:c=p(this,Fr,pu).call(this,r(this,ft),e,i,o,h),d=p(this,Fr,pu).call(this,r(this,be),e,i,o,h);break;case 180:c=p(this,Or,fu).call(this,r(this,ft),s,i,-o,h),d=p(this,Or,fu).call(this,r(this,be),s,i,-o,h);break;case 270:c=p(this,Fr,pu).call(this,r(this,ft),s,n,-o,-h),d=p(this,Fr,pu).call(this,r(this,be),s,n,-o,-h)}return{outline:Array.from(c),points:[Array.from(d)]}}get box(){return r(this,Dr)}getNewOutline(e,i){const{x:s,y:n,width:a,height:o}=r(this,Dr),[h,c,d,u]=r(this,Do),g=a*d,b=o*u,_=s*d+h,A=n*u+c,v=new Bn({x:r(this,be)[0]*g+_,y:r(this,be)[1]*b+A},r(this,Do),r(this,Ic),e,r(this,Rc),i??r(this,ss));for(let y=2;y<r(this,be).length;y+=2)v.add({x:r(this,be)[y]*g+_,y:r(this,be)[y+1]*b+A});return v.getOutlines()}}Do=new WeakMap,Dr=new WeakMap,ss=new WeakMap,Rc=new WeakMap,be=new WeakMap,Ic=new WeakMap,ft=new WeakMap,Or=new WeakSet,fu=function(e,i,s,n,a){const o=new Float64Array(e.length);for(let h=0,c=e.length;h<c;h+=2)o[h]=i+e[h]*n,o[h+1]=s+e[h+1]*a;return o},Fr=new WeakSet,pu=function(e,i,s,n,a){const o=new Float64Array(e.length);for(let h=0,c=e.length;h<c;h+=2)o[h]=i+e[h+1]*n,o[h+1]=s+e[h]*a;return o},pp=new WeakSet,Fv=function(e){const i=r(this,ft);let s=i[4],n=i[5],a=s,o=n,h=s,c=n,d=s,u=n;const g=e?Math.max:Math.min;for(let y=6,E=i.length;y<E;y+=6){if(isNaN(i[y]))a=Math.min(a,i[y+4]),o=Math.min(o,i[y+5]),h=Math.max(h,i[y+4]),c=Math.max(c,i[y+5]),u<i[y+5]?(d=i[y+4],u=i[y+5]):u===i[y+5]&&(d=g(d,i[y+4]));else{const x=O.bezierBoundingBox(s,n,...i.slice(y,y+6));a=Math.min(a,x[0]),o=Math.min(o,x[1]),h=Math.max(h,x[2]),c=Math.max(c,x[3]),u<x[3]?(d=x[2],u=x[3]):u===x[3]&&(d=g(d,x[2]))}s=i[y+4],n=i[y+5]}const b=a-r(this,ss),_=o-r(this,ss),A=h-a+2*r(this,ss),v=c-o+2*r(this,ss);m(this,Dr,{x:b,y:_,width:A,height:v,lastPoint:[d,u]})};const rs=class{constructor({editor:t=null,uiManager:e=null}){f(this,Hc),f(this,Vc),f(this,gp),f(this,ns),f(this,mp),f(this,yi),f(this,Dc,p(this,gp,Nv).bind(this)),f(this,Oc,p(this,mp,Bv).bind(this)),f(this,Ye,null),f(this,Nr,null),f(this,Oo,void 0),f(this,Ct,null),f(this,Fc,!1),f(this,Fo,!1),f(this,Nc,null),f(this,Bc,void 0),f(this,Ze,null),f(this,No,void 0),t?(m(this,Fo,!1),m(this,No,V.HIGHLIGHT_COLOR),m(this,Nc,t)):(m(this,Fo,!0),m(this,No,V.HIGHLIGHT_DEFAULT_COLOR)),m(this,Ze,t?._uiManager||e),m(this,Bc,r(this,Ze)._eventBus),m(this,Oo,t?.color||r(this,Ze)?.highlightColors.values().next().value||"#FFFF98")}static get _keyboardManager(){return Y(this,"_keyboardManager",new Vl([[["Escape","mac+Escape"],rs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],rs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],rs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],rs.prototype._moveToPrevious],[["Home","mac+Home"],rs.prototype._moveToBeginning],[["End","mac+End"],rs.prototype._moveToEnd]]))}renderButton(){const t=m(this,Ye,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=r(this,Ze)._signal;t.addEventListener("click",p(this,ns,xa).bind(this),{signal:e}),t.addEventListener("keydown",r(this,Dc),{signal:e});const i=m(this,Nr,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=r(this,Oo),t.append(i),t}renderMainDropdown(){const t=m(this,Ct,p(this,Hc,Kb).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===r(this,Ye))return void p(this,ns,xa).call(this,t);const e=t.target.getAttribute("data-color");!e||p(this,Vc,Xb).call(this,e,t)}_moveToNext(t){r(this,yi,kn)?t.target!==r(this,Ye)?t.target.nextSibling?.focus():r(this,Ct).firstChild?.focus():p(this,ns,xa).call(this,t)}_moveToPrevious(t){t.target!==r(this,Ct)?.firstChild&&t.target!==r(this,Ye)?(r(this,yi,kn)||p(this,ns,xa).call(this,t),t.target.previousSibling?.focus()):r(this,yi,kn)&&this._hideDropdownFromKeyboard()}_moveToBeginning(t){r(this,yi,kn)?r(this,Ct).firstChild?.focus():p(this,ns,xa).call(this,t)}_moveToEnd(t){r(this,yi,kn)?r(this,Ct).lastChild?.focus():p(this,ns,xa).call(this,t)}hideDropdown(){r(this,Ct)?.classList.add("hidden"),window.removeEventListener("pointerdown",r(this,Oc))}_hideDropdownFromKeyboard(){if(!r(this,Fo)){if(!r(this,yi,kn))return void r(this,Nc)?.unselect();this.hideDropdown(),r(this,Ye).focus({preventScroll:!0,focusVisible:r(this,Fc)})}}updateColor(t){if(r(this,Nr)&&(r(this,Nr).style.backgroundColor=t),!r(this,Ct))return;const e=r(this,Ze).highlightColors.values();for(const i of r(this,Ct).children)i.setAttribute("aria-selected",e.next().value===t)}destroy(){r(this,Ye)?.remove(),m(this,Ye,null),m(this,Nr,null),r(this,Ct)?.remove(),m(this,Ct,null)}};let Gu=rs;Dc=new WeakMap,Oc=new WeakMap,Ye=new WeakMap,Nr=new WeakMap,Oo=new WeakMap,Ct=new WeakMap,Fc=new WeakMap,Fo=new WeakMap,Nc=new WeakMap,Bc=new WeakMap,Ze=new WeakMap,No=new WeakMap,Hc=new WeakSet,Kb=function(){const t=document.createElement("div"),e=r(this,Ze)._signal;t.addEventListener("contextmenu",ve,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of r(this,Ze).highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",s),n.title=i,n.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${i}`);const a=document.createElement("span");n.append(a),a.className="swatch",a.style.backgroundColor=s,n.setAttribute("aria-selected",s===r(this,Oo)),n.addEventListener("click",p(this,Vc,Xb).bind(this,s),{signal:e}),t.append(n)}return t.addEventListener("keydown",r(this,Dc),{signal:e}),t},Vc=new WeakSet,Xb=function(t,e){e.stopPropagation(),r(this,Bc).dispatch("switchannotationeditorparams",{source:this,type:r(this,No),value:t})},gp=new WeakSet,Nv=function(t){rs._keyboardManager.exec(this,t)},ns=new WeakSet,xa=function(t){if(r(this,yi,kn))return void this.hideDropdown();if(m(this,Fc,0===t.detail),window.addEventListener("pointerdown",r(this,Oc),{signal:r(this,Ze)._signal}),r(this,Ct))return void r(this,Ct).classList.remove("hidden");const e=m(this,Ct,p(this,Hc,Kb).call(this));r(this,Ye).append(e)},mp=new WeakSet,Bv=function(t){r(this,Ct)?.contains(t.target)||this.hideDropdown()},yi=new WeakSet,kn=function(){return r(this,Ct)&&!r(this,Ct).classList.contains("hidden")};const pt=class extends G{constructor(e){super({...e,name:"highlightEditor"}),f(this,Gc),f(this,$c),f(this,bp),f(this,_p),f(this,Ap),f(this,qc),f(this,jr),f(this,yp),f(this,Uo),f(this,Ur),f(this,vp),f(this,wp),f(this,Bo,null),f(this,jc,0),f(this,Js,void 0),f(this,Br,null),f(this,Ho,null),f(this,Se,null),f(this,Uc,null),f(this,zc,0),f(this,Hr,null),f(this,Je,null),f(this,Zt,null),f(this,_e,!1),f(this,Vo,null),f(this,Vr,void 0),f(this,St,null),f(this,jo,""),f(this,vi,void 0),f(this,Wc,""),this.color=e.color||pt._defaultColor,m(this,vi,e.thickness||pt._defaultThickness),m(this,Vr,e.opacity||pt._defaultOpacity),m(this,Js,e.boxes||null),m(this,Wc,e.methodOfCreation||""),m(this,jo,e.text||""),this._isDraggable=!1,e.highlightId>-1?(m(this,_e,!0),p(this,$c,Zb).call(this,e),p(this,jr,gu).call(this)):(m(this,Bo,e.anchorNode),m(this,jc,e.anchorOffset),m(this,Uc,e.focusNode),m(this,zc,e.focusOffset),p(this,Gc,Yb).call(this),p(this,jr,gu).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=pt.prototype;return Y(this,"_keyboardManager",new Vl([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:r(this,_e)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:r(this,vi),methodOfCreation:r(this,Wc)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,i){G.initialize(e,i),pt._defaultColor||(pt._defaultColor=i.highlightColors?.values().next().value||"#fff066")}static updateDefaultParams(e,i){switch(e){case V.HIGHLIGHT_DEFAULT_COLOR:pt._defaultColor=i;break;case V.HIGHLIGHT_THICKNESS:pt._defaultThickness=i}}translateInPage(e,i){}get toolbarPosition(){return r(this,Vo)}updateParams(e,i){switch(e){case V.HIGHLIGHT_COLOR:p(this,bp,Hv).call(this,i);break;case V.HIGHLIGHT_THICKNESS:p(this,_p,Vv).call(this,i)}}static get defaultPropertiesToUpdate(){return[[V.HIGHLIGHT_DEFAULT_COLOR,pt._defaultColor],[V.HIGHLIGHT_THICKNESS,pt._defaultThickness]]}get propertiesToUpdate(){return[[V.HIGHLIGHT_COLOR,this.color||pt._defaultColor],[V.HIGHLIGHT_THICKNESS,r(this,vi)||pt._defaultThickness],[V.HIGHLIGHT_FREE,r(this,_e)]]}addEditToolbar(){var e=()=>super.addEditToolbar,i=this;return(0,I.Z)(function*(){const s=yield e().call(i);return s?(i._uiManager.highlightColors&&(m(i,Ho,new Gu({editor:i})),s.addColorPicker(r(i,Ho))),s):null})()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(p(this,Ur,mu).call(this))}getBaseTranslation(){return[0,0]}getRect(e,i){return super.getRect(e,i,p(this,Ur,mu).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){p(this,qc,Jb).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){!this.parent||(super.rebuild(),null!==this.div&&(p(this,jr,gu).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let i=!1;this.parent&&!e?p(this,qc,Jb).call(this):e&&(p(this,jr,gu).call(this,e),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),i&&this.select()}rotate(e){var n,a,o;const{drawLayer:i}=this.parent;let s;r(this,_e)?(e=(e-this.rotation+360)%360,s=p(n=pt,Qs,Ll).call(n,r(this,Je).box,e)):s=p(a=pt,Qs,Ll).call(a,this,e),i.rotate(r(this,Zt),e),i.rotate(r(this,St),e),i.updateBox(r(this,Zt),s),i.updateBox(r(this,St),p(o=pt,Qs,Ll).call(o,r(this,Se).box,e))}render(){if(this.div)return this.div;const e=super.render();r(this,jo)&&(e.setAttribute("aria-label",r(this,jo)),e.setAttribute("role","mark")),r(this,_e)?e.classList.add("free"):this.div.addEventListener("keydown",p(this,yp,Uv).bind(this),{signal:this._uiManager._signal});const i=m(this,Hr,document.createElement("div"));e.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=r(this,Br);const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),Du(this,r(this,Hr),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.parent.drawLayer.addClass(r(this,St),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(r(this,St),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:p(this,Uo,Yg).call(this,!0);break;case 1:case 3:p(this,Uo,Yg).call(this,!1)}}select(){super.select(),r(this,St)&&(this.parent?.drawLayer.removeClass(r(this,St),"hovered"),this.parent?.drawLayer.addClass(r(this,St),"selected"))}unselect(){super.unselect(),r(this,St)&&(this.parent?.drawLayer.removeClass(r(this,St),"selected"),r(this,_e)||p(this,Uo,Yg).call(this,!1))}get _mustFixPosition(){return!r(this,_e)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(r(this,Zt),e),this.parent.drawLayer.show(r(this,St),e))}static startHighlighting(e,i,{target:s,x:n,y:a}){const{x:o,y:h,width:c,height:d}=s.getBoundingClientRect(),u=new AbortController,g=e.combinedSignal(u),_=A=>{u.abort(),p(this,xp,$v).call(this,e,A)};window.addEventListener("blur",_,{signal:g}),window.addEventListener("pointerup",_,{signal:g}),window.addEventListener("pointerdown",A=>{A.preventDefault(),A.stopPropagation()},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",ve,{signal:g}),s.addEventListener("pointermove",p(this,Ep,Gv).bind(this,e),{signal:g}),this._freeHighlight=new Bn({x:n,y:a},[o,h,c,d],e.scale,this._defaultThickness/2,i,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0))}static deserialize(e,i,s){var A;const n=super.deserialize(e,i,s),{rect:[a,o,h,c],color:d,quadPoints:u}=e;n.color=O.makeHexColor(...d),m(n,Vr,e.opacity);const[g,b]=n.pageDimensions;n.width=(h-a)/g,n.height=(c-o)/b;const _=m(n,Js,[]);for(let v=0;v<u.length;v+=8)_.push({x:(u[4]-h)/g,y:(c-(1-u[v+5]))/b,width:(u[v+2]-u[v])/g,height:(u[v+5]-u[v+1])/b});return p(A=n,Gc,Yb).call(A),n}serialize(e=!1){if(this.isEmpty()||e)return null;const i=this.getRect(0,0),s=G._colorManager.convert(this.color);return{annotationType:K.HIGHLIGHT,color:s,opacity:r(this,Vr),thickness:r(this,vi),quadPoints:p(this,vp,zv).call(this),outlines:p(this,wp,Wv).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:p(this,Ur,mu).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};let Gt=pt;Bo=new WeakMap,jc=new WeakMap,Js=new WeakMap,Br=new WeakMap,Ho=new WeakMap,Se=new WeakMap,Uc=new WeakMap,zc=new WeakMap,Hr=new WeakMap,Je=new WeakMap,Zt=new WeakMap,_e=new WeakMap,Vo=new WeakMap,Vr=new WeakMap,St=new WeakMap,jo=new WeakMap,vi=new WeakMap,Wc=new WeakMap,Gc=new WeakSet,Yb=function(){const e=new FA(r(this,Js),.001);m(this,Je,e.getOutlines()),({x:this.x,y:this.y,width:this.width,height:this.height}=r(this,Je).box);const i=new FA(r(this,Js),.0025,.001,"ltr"===this._uiManager.direction);m(this,Se,i.getOutlines());const{lastPoint:s}=r(this,Se).box;m(this,Vo,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},$c=new WeakSet,Zb=function({highlightOutlines:e,highlightId:i,clipPathId:s}){var u,g;if(m(this,Je,e),m(this,Se,e.getNewOutline(r(this,vi)/2+1.5,.0025)),i>=0)m(this,Zt,i),m(this,Br,s),this.parent.drawLayer.finalizeLine(i,e),m(this,St,this.parent.drawLayer.highlightOutline(r(this,Se)));else if(this.parent){const b=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(r(this,Zt),e),this.parent.drawLayer.updateBox(r(this,Zt),p(u=pt,Qs,Ll).call(u,r(this,Je).box,(b-this.rotation+360)%360)),this.parent.drawLayer.updateLine(r(this,St),r(this,Se)),this.parent.drawLayer.updateBox(r(this,St),p(g=pt,Qs,Ll).call(g,r(this,Se).box,b))}const{x:a,y:o,width:h,height:c}=e.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=h,this.height=c;break;case 90:{const[b,_]=this.parentDimensions;this.x=o,this.y=1-a,this.width=h*_/b,this.height=c*b/_;break}case 180:this.x=1-a,this.y=1-o,this.width=h,this.height=c;break;case 270:{const[b,_]=this.parentDimensions;this.x=1-o,this.y=a,this.width=h*_/b,this.height=c*b/_;break}}const{lastPoint:d}=r(this,Se).box;m(this,Vo,[(d[0]-a)/h,(d[1]-o)/c])},bp=new WeakSet,Hv=function(e){const i=n=>{this.color=n,this.parent?.drawLayer.changeColor(r(this,Zt),n),r(this,Ho)?.updateColor(n)},s=this.color;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:V.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},_p=new WeakSet,Vv=function(e){const i=r(this,vi),s=n=>{m(this,vi,n),p(this,Ap,jv).call(this,n)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:V.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},Ap=new WeakSet,jv=function(e){if(!r(this,_e))return;p(this,$c,Zb).call(this,{highlightOutlines:r(this,Je).getNewOutline(e/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},qc=new WeakSet,Jb=function(){null===r(this,Zt)||!this.parent||(this.parent.drawLayer.remove(r(this,Zt)),m(this,Zt,null),this.parent.drawLayer.remove(r(this,St)),m(this,St,null))},jr=new WeakSet,gu=function(e=this.parent){null===r(this,Zt)&&(({id:ee(this,Zt)._,clipPathId:ee(this,Br)._}=e.drawLayer.highlight(r(this,Je),this.color,r(this,Vr))),m(this,St,e.drawLayer.highlightOutline(r(this,Se))),r(this,Hr)&&(r(this,Hr).style.clipPath=r(this,Br)))},Qs=new WeakSet,Ll=function({x:e,y:i,width:s,height:n},a){switch(a){case 90:return{x:1-i-n,y:e,width:n,height:s};case 180:return{x:1-e-s,y:1-i-n,width:s,height:n};case 270:return{x:i,y:1-e-s,width:n,height:s}}return{x:e,y:i,width:s,height:n}},yp=new WeakSet,Uv=function(e){pt._keyboardManager.exec(this,e)},Uo=new WeakSet,Yg=function(e){if(!r(this,Bo))return;const i=window.getSelection();e?i.setPosition(r(this,Bo),r(this,jc)):i.setPosition(r(this,Uc),r(this,zc))},Ur=new WeakSet,mu=function(){return r(this,_e)?this.rotation:0},vp=new WeakSet,zv=function(){if(r(this,_e))return null;const[e,i]=this.pageDimensions,[s,n]=this.pageTranslation,a=r(this,Js),o=new Float32Array(8*a.length);let h=0;for(const{x:c,y:d,width:u,height:g}of a){const b=c*e+s,_=(1-d-g)*i+n;o[h]=o[h+4]=b,o[h+1]=o[h+3]=_,o[h+2]=o[h+6]=b+u*e,o[h+5]=o[h+7]=_+g*i,h+=8}return o},wp=new WeakSet,Wv=function(e){return r(this,Je).serialize(e,p(this,Ur,mu).call(this))},Ep=new WeakSet,Gv=function(e,i){this._freeHighlight.add(i)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},xp=new WeakSet,$v=function(e,i){this._freeHighlight.isEmpty()?e.drawLayer.removeFreeHighlight(this._freeHighlightId):e.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},f(Gt,Qs),f(Gt,Ep),f(Gt,xp),R(Gt,"_defaultColor",null),R(Gt,"_defaultOpacity",1),R(Gt,"_defaultThickness",12),R(Gt,"_l10nPromise"),R(Gt,"_type","highlight"),R(Gt,"_editorType",K.HIGHLIGHT),R(Gt,"_freeHighlightId",-1),R(Gt,"_freeHighlight",null),R(Gt,"_freeHighlightClipId","");const Vt=class extends G{constructor(e){super({...e,name:"inkEditor"}),f(this,Cp),f(this,Sp),f(this,Pp),f(this,Tp),f(this,Kc),f(this,Mp),f(this,Xc),f(this,Lp),f(this,kp),f(this,Rp),f(this,Ip),f(this,Dp),f(this,ls),f(this,Yc),f(this,Zc),f(this,Jc),f(this,Wo),f(this,Go),f(this,en),f(this,Qc),f(this,$o),f(this,Np),f(this,ed),f(this,qo),f(this,Yr),f(this,zr,0),f(this,Wr,0),f(this,wi,null),f(this,as,new Path2D),f(this,Pe,!1),f(this,Gr,null),f(this,$r,!1),f(this,qr,!1),f(this,os,null),f(this,zo,null),f(this,Kr,0),f(this,Xr,0),f(this,tn,null),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,i){G.initialize(e,i)}static updateDefaultParams(e,i){switch(e){case V.INK_THICKNESS:Vt._defaultThickness=i;break;case V.INK_COLOR:Vt._defaultColor=i;break;case V.INK_OPACITY:Vt._defaultOpacity=i/100}}updateParams(e,i){switch(e){case V.INK_THICKNESS:p(this,Cp,qv).call(this,i);break;case V.INK_COLOR:p(this,Sp,Kv).call(this,i);break;case V.INK_OPACITY:p(this,Pp,Xv).call(this,i)}}static get defaultPropertiesToUpdate(){return[[V.INK_THICKNESS,Vt._defaultThickness],[V.INK_COLOR,Vt._defaultColor||G._defaultLineColor],[V.INK_OPACITY,Math.round(100*Vt._defaultOpacity)]]}get propertiesToUpdate(){return[[V.INK_THICKNESS,this.thickness||Vt._defaultThickness],[V.INK_COLOR,this.color||Vt._defaultColor||G._defaultLineColor],[V.INK_OPACITY,Math.round(100*(this.opacity??Vt._defaultOpacity))]]}rebuild(){!this.parent||(super.rebuild(),null!==this.div&&(this.canvas||(p(this,Wo,Zg).call(this),p(this,Go,Jg).call(this)),this.isAttachedToDOM||(this.parent.add(this),p(this,en,kl).call(this)),p(this,Yr,bu).call(this)))}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,r(this,wi)&&(clearTimeout(r(this,wi)),m(this,wi,null)),r(this,os)?.disconnect(),m(this,os,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&null===e&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,i]=this.parentDimensions;this.setDimensions(this.width*e,this.height*i)}enableEditMode(){r(this,Pe)||null===this.canvas||(super.enableEditMode(),this._isDraggable=!1,p(this,Yc,e_).call(this))}disableEditMode(){!this.isInEditMode()||null===this.canvas||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),p(this,Zc,i_).call(this))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}commit(){r(this,Pe)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),m(this,Pe,!0),this.div.classList.add("disabled"),p(this,Yr,bu).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){!this._focusEventsAllowed||(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){0!==e.button||!this.isInEditMode()||r(this,Pe)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),p(this,Mp,Zv).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),p(this,Xc,t_).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),p(this,Jc,s_).call(this,e)}canvasPointerleave(e){p(this,Jc,s_).call(this,e)}get isResizable(){return!this.isEmpty()&&r(this,Pe)}render(){if(this.div)return this.div;let e,i;this.width&&(e=this.x,i=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[s,n,a,o]=p(this,Tp,Yv).call(this);if(this.setAt(s,n,0,0),this.setDims(a,o),p(this,Wo,Zg).call(this),this.width){const[h,c]=this.parentDimensions;this.setAspectRatio(this.width*h,this.height*c),this.setAt(e*h,i*c,this.width*h,this.height*c),m(this,qr,!0),p(this,en,kl).call(this),this.setDims(this.width*h,this.height*c),p(this,ls,Ca).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return p(this,Go,Jg).call(this),this.div}setDimensions(e,i){const s=Math.round(e),n=Math.round(i);if(r(this,Kr)===s&&r(this,Xr)===n)return;m(this,Kr,s),m(this,Xr,n),this.canvas.style.visibility="hidden";const[a,o]=this.parentDimensions;this.width=e/a,this.height=i/o,this.fixAndSetPosition(),r(this,Pe)&&p(this,Qc,n_).call(this,e,i),p(this,en,kl).call(this),p(this,ls,Ca).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(e,i,s){var v,y,E;if(e instanceof DA)return null;const n=super.deserialize(e,i,s);n.thickness=e.thickness,n.color=O.makeHexColor(...e.color),n.opacity=e.opacity;const[a,o]=n.pageDimensions,h=n.width*a,c=n.height*o,d=n.parentScale,u=e.thickness/2;m(n,Pe,!0),m(n,Kr,Math.round(h)),m(n,Xr,Math.round(c));const{paths:g,rect:b,rotation:_}=e;for(let{bezier:x}of g){x=p(v=Vt,Fp,n0).call(v,x,b,_);const C=[];n.paths.push(C);let S=d*(x[0]-u),P=d*(x[1]-u);for(let k=2,w=x.length;k<w;k+=6){const W=d*(x[k+4]-u),tt=d*(x[k+5]-u);C.push([[S,P],[d*(x[k]-u),d*(x[k+1]-u)],[d*(x[k+2]-u),d*(x[k+3]-u)],[W,tt]]),S=W,P=tt}const L=p(this,Op,s0).call(this,C);n.bezierPath2D.push(L)}const A=p(y=n,ed,a_).call(y);return m(n,Wr,Math.max(G.MIN_SIZE,A[2]-A[0])),m(n,zr,Math.max(G.MIN_SIZE,A[3]-A[1])),p(E=n,Qc,n_).call(E,h,c),n}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),i=G._colorManager.convert(this.ctx.strokeStyle);return{annotationType:K.INK,color:i,thickness:this.thickness,opacity:this.opacity,paths:p(this,Np,r0).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};let Fe=Vt;zr=new WeakMap,Wr=new WeakMap,wi=new WeakMap,as=new WeakMap,Pe=new WeakMap,Gr=new WeakMap,$r=new WeakMap,qr=new WeakMap,os=new WeakMap,zo=new WeakMap,Kr=new WeakMap,Xr=new WeakMap,tn=new WeakMap,Cp=new WeakSet,qv=function(e){const i=n=>{this.thickness=n,p(this,Yr,bu).call(this)},s=this.thickness;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:V.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Sp=new WeakSet,Kv=function(e){const i=n=>{this.color=n,p(this,ls,Ca).call(this)},s=this.color;this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:V.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Pp=new WeakSet,Xv=function(e){const i=n=>{this.opacity=n,p(this,ls,Ca).call(this)},s=this.opacity;this.addCommands({cmd:i.bind(this,e/=100),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:V.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Tp=new WeakSet,Yv=function(){const{parentRotation:e,parentDimensions:[i,s]}=this;switch(e){case 90:return[0,s,s,i];case 180:return[i,s,i,s];case 270:return[i,0,s,i];default:return[0,0,i,s]}},Kc=new WeakSet,Qb=function(){const{ctx:e,color:i,opacity:s,thickness:n,parentScale:a,scaleFactor:o}=this;e.lineWidth=n*a/o,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${i}${function mw(l){return Math.round(Math.min(255,Math.max(1,255*l))).toString(16).padStart(2,"0")}(s)}`},Mp=new WeakSet,Zv=function(e,i){this.canvas.addEventListener("contextmenu",ve,{signal:this._uiManager._signal}),p(this,Zc,i_).call(this),m(this,Gr,new AbortController);const s=this._uiManager.combinedSignal(r(this,Gr));this.canvas.addEventListener("pointerleave",this.canvasPointerleave.bind(this),{signal:s}),this.canvas.addEventListener("pointermove",this.canvasPointermove.bind(this),{signal:s}),this.canvas.addEventListener("pointerup",this.canvasPointerup.bind(this),{signal:s}),this.isEditing=!0,r(this,qr)||(m(this,qr,!0),p(this,en,kl).call(this),this.thickness||(this.thickness=Vt._defaultThickness),this.color||(this.color=Vt._defaultColor||G._defaultLineColor),this.opacity??(this.opacity=Vt._defaultOpacity)),this.currentPath.push([e,i]),m(this,$r,!1),p(this,Kc,Qb).call(this),m(this,tn,()=>{p(this,Rp,t0).call(this),r(this,tn)&&window.requestAnimationFrame(r(this,tn))}),window.requestAnimationFrame(r(this,tn))},Xc=new WeakSet,t_=function(e,i){const[s,n]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===s&&i===n)return;const a=this.currentPath;let o=r(this,as);if(a.push([e,i]),m(this,$r,!0),a.length<=2)return o.moveTo(...a[0]),void o.lineTo(e,i);3===a.length&&(m(this,as,o=new Path2D),o.moveTo(...a[0])),p(this,Ip,e0).call(this,o,...a.at(-3),...a.at(-2),e,i)},Lp=new WeakSet,Jv=function(){if(0===this.currentPath.length)return;const e=this.currentPath.at(-1);r(this,as).lineTo(...e)},kp=new WeakSet,Qv=function(e,i){let s;if(m(this,tn,null),e=Math.min(Math.max(e,0),this.canvas.width),i=Math.min(Math.max(i,0),this.canvas.height),p(this,Xc,t_).call(this,e,i),p(this,Lp,Jv).call(this),1!==this.currentPath.length)s=p(this,Dp,i0).call(this);else{const c=[e,i];s=[[c,c.slice(),c.slice(),c]]}const n=r(this,as),a=this.currentPath;this.currentPath=[],m(this,as,new Path2D),this.addCommands({cmd:()=>{this.allRawPaths.push(a),this.paths.push(s),this.bezierPath2D.push(n),this._uiManager.rebuild(this)},undo:()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(p(this,Wo,Zg).call(this),p(this,Go,Jg).call(this)),p(this,Yr,bu).call(this))},mustExec:!0})},Rp=new WeakSet,t0=function(){if(!r(this,$r))return;m(this,$r,!1);Math.ceil(this.thickness*this.parentScale);const i=this.currentPath.slice(-3),s=i.map(u=>u[0]),n=i.map(u=>u[1]),{ctx:d}=(Math.min(...s),Math.max(...s),Math.min(...n),Math.max(...n),this);d.save(),d.clearRect(0,0,this.canvas.width,this.canvas.height);for(const u of this.bezierPath2D)d.stroke(u);d.stroke(r(this,as)),d.restore()},Ip=new WeakSet,e0=function(e,i,s,n,a,o,h){const c=(i+n)/2,d=(s+a)/2,u=(n+o)/2,g=(a+h)/2;e.bezierCurveTo(c+2*(n-c)/3,d+2*(a-d)/3,u+2*(n-u)/3,g+2*(a-g)/3,u,g)},Dp=new WeakSet,i0=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const i=[];let s,[n,a]=e[0];for(s=1;s<e.length-2;s++){const[b,_]=e[s],[A,v]=e[s+1],y=(b+A)/2,E=(_+v)/2;i.push([[n,a],[n+2*(b-n)/3,a+2*(_-a)/3],[y+2*(b-y)/3,E+2*(_-E)/3],[y,E]]),[n,a]=[y,E]}const[o,h]=e[s],[c,d]=e[s+1];return i.push([[n,a],[n+2*(o-n)/3,a+2*(h-a)/3],[c+2*(o-c)/3,d+2*(h-d)/3],[c,d]]),i},ls=new WeakSet,Ca=function(){if(this.isEmpty())return void p(this,$o,Qg).call(this);p(this,Kc,Qb).call(this);const{canvas:e,ctx:i}=this;i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,e.width,e.height),p(this,$o,Qg).call(this);for(const s of this.bezierPath2D)i.stroke(s)},Yc=new WeakSet,e_=function(){if(r(this,zo))return;m(this,zo,new AbortController);const e=this._uiManager.combinedSignal(r(this,zo));this.canvas.addEventListener("pointerdown",this.canvasPointerdown.bind(this),{signal:e})},Zc=new WeakSet,i_=function(){this.pointerdownAC?.abort(),this.pointerdownAC=null},Jc=new WeakSet,s_=function(e){r(this,Gr)?.abort(),m(this,Gr,null),p(this,Yc,e_).call(this),r(this,wi)&&clearTimeout(r(this,wi)),m(this,wi,setTimeout(()=>{m(this,wi,null),this.canvas.removeEventListener("contextmenu",ve)},10)),p(this,kp,Qv).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Wo=new WeakSet,Zg=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Go=new WeakSet,Jg=function(){m(this,os,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&this.setDimensions(i.width,i.height)})),r(this,os).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{r(this,os)?.disconnect(),m(this,os,null)},{once:!0})},en=new WeakSet,kl=function(){if(!r(this,qr))return;const[e,i]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*i),p(this,$o,Qg).call(this)},Qc=new WeakSet,n_=function(e,i){const s=p(this,qo,tm).call(this),n=(e-s)/r(this,Wr),a=(i-s)/r(this,zr);this.scaleFactor=Math.min(n,a)},$o=new WeakSet,Qg=function(){const e=p(this,qo,tm).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},Op=new WeakSet,s0=function(e){const i=new Path2D;for(let s=0,n=e.length;s<n;s++){const[a,o,h,c]=e[s];0===s&&i.moveTo(...a),i.bezierCurveTo(o[0],o[1],h[0],h[1],c[0],c[1])}return i},td=new WeakSet,r_=function(e,i,s){const[n,a,o,h]=i;switch(s){case 0:for(let c=0,d=e.length;c<d;c+=2)e[c]+=n,e[c+1]=h-e[c+1];break;case 90:for(let c=0,d=e.length;c<d;c+=2){const u=e[c];e[c]=e[c+1]+n,e[c+1]=u+a}break;case 180:for(let c=0,d=e.length;c<d;c+=2)e[c]=o-e[c],e[c+1]+=a;break;case 270:for(let c=0,d=e.length;c<d;c+=2){const u=e[c];e[c]=o-e[c+1],e[c+1]=h-u}break;default:throw new Error("Invalid rotation")}return e},Fp=new WeakSet,n0=function(e,i,s){const[n,a,o,h]=i;switch(s){case 0:for(let c=0,d=e.length;c<d;c+=2)e[c]-=n,e[c+1]=h-e[c+1];break;case 90:for(let c=0,d=e.length;c<d;c+=2){const u=e[c];e[c]=e[c+1]-a,e[c+1]=u-n}break;case 180:for(let c=0,d=e.length;c<d;c+=2)e[c]=o-e[c],e[c+1]-=a;break;case 270:for(let c=0,d=e.length;c<d;c+=2){const u=e[c];e[c]=h-e[c+1],e[c+1]=o-u}break;default:throw new Error("Invalid rotation")}return e},Np=new WeakSet,r0=function(e,i,s,n){var d,u;const a=[],o=this.thickness/2,h=e*i+o,c=e*s+o;for(const g of this.paths){const b=[],_=[];for(let A=0,v=g.length;A<v;A++){const[y,E,x,C]=g[A];if(y[0]===C[0]&&y[1]===C[1]&&1===v){const j=e*y[0]+h,W=e*y[1]+c;b.push(j,W),_.push(j,W);break}const S=e*y[0]+h,P=e*y[1]+c,L=e*E[0]+h,k=e*E[1]+c,w=e*x[0]+h,T=e*x[1]+c,D=e*C[0]+h,$=e*C[1]+c;0===A&&(b.push(S,P),_.push(S,P)),b.push(L,k,w,T,D,$),_.push(L,k),A===v-1&&_.push(D,$)}a.push({bezier:p(d=Vt,td,r_).call(d,b,n,this.rotation),points:p(u=Vt,td,r_).call(u,_,n,this.rotation)})}return a},ed=new WeakSet,a_=function(){let e=1/0,i=-1/0,s=1/0,n=-1/0;for(const a of this.paths)for(const[o,h,c,d]of a){const u=O.bezierBoundingBox(...o,...h,...c,...d);e=Math.min(e,u[0]),s=Math.min(s,u[1]),i=Math.max(i,u[2]),n=Math.max(n,u[3])}return[e,s,i,n]},qo=new WeakSet,tm=function(){return r(this,Pe)?Math.ceil(this.thickness*this.parentScale):0},Yr=new WeakSet,bu=function(e=!1){if(this.isEmpty())return;if(!r(this,Pe))return void p(this,ls,Ca).call(this);const i=p(this,ed,a_).call(this),s=p(this,qo,tm).call(this);m(this,Wr,Math.max(G.MIN_SIZE,i[2]-i[0])),m(this,zr,Math.max(G.MIN_SIZE,i[3]-i[1]));const n=Math.ceil(s+r(this,Wr)*this.scaleFactor),a=Math.ceil(s+r(this,zr)*this.scaleFactor),[o,h]=this.parentDimensions;this.width=n/o,this.height=a/h,this.setAspectRatio(n,a);const c=this.translationX,d=this.translationY;this.translationX=-i[0],this.translationY=-i[1],p(this,en,kl).call(this),p(this,ls,Ca).call(this),m(this,Kr,n),m(this,Xr,a),this.setDims(n,a);const u=e?s/this.scaleFactor/2:0;this.translate(c-this.translationX-u,d-this.translationY-u)},f(Fe,Op),f(Fe,td),f(Fe,Fp),R(Fe,"_defaultColor",null),R(Fe,"_defaultOpacity",1),R(Fe,"_defaultThickness",1),R(Fe,"_type","ink"),R(Fe,"_editorType",K.INK);const db=class extends G{constructor(e){super({...e,name:"stampEditor"}),f(this,Zr),f(this,Jr),f(this,Xo),f(this,sd),f(this,Bp),f(this,nd),f(this,rd),f(this,Yo),f(this,Hp),f(this,gt,null),f(this,jt,null),f(this,sn,null),f(this,hs,null),f(this,nn,null),f(this,Ko,""),f(this,Ei,null),f(this,cs,null),f(this,xi,null),f(this,Te,!1),f(this,id,!1),m(this,hs,e.bitmapUrl),m(this,nn,e.bitmapFile)}static initialize(e,i){G.initialize(e,i)}static get supportedTypes(){return Y(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return Y(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,i){i.pasteEditor(K.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const i=e.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}mlGuessAltText(e=null,i=!0){var s=this;return(0,I.Z)(function*(){if(s.hasAltTextData())return null;const{mlManager:n}=s._uiManager;if(!n)throw new Error("No ML.");if(!(yield n.isEnabledFor("altText")))throw new Error("ML isn't enabled for alt text.");const{data:a,width:o,height:h}=e||s.copyCanvas(null,!0).imageData,c=yield n.guess({name:"altText",request:{data:a,width:o,height:h,channels:a.length/(o*h)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const d=c.output;return yield s.setGuessedAltText(d),i&&!s.hasAltTextData()&&(s.altTextData={alt:d,decorative:!1}),d})()}remove(){r(this,jt)&&(m(this,gt,null),this._uiManager.imageManager.deleteId(r(this,jt)),r(this,Ei)?.remove(),m(this,Ei,null),r(this,cs)?.disconnect(),m(this,cs,null),r(this,xi)&&(clearTimeout(r(this,xi)),m(this,xi,null))),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(r(this,jt)&&null===r(this,Ei)&&p(this,Xo,em).call(this),this.isAttachedToDOM||this.parent.add(this))):r(this,jt)&&p(this,Xo,em).call(this)}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(r(this,sn)||r(this,gt)||r(this,hs)||r(this,nn)||r(this,jt))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,i;if(this.width&&(e=this.x,i=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),r(this,gt)?p(this,sd,o_).call(this):p(this,Xo,em).call(this),this.width){const[s,n]=this.parentDimensions;this.setAt(e*s,i*n,this.width*s,this.height*n)}return this.div}copyCanvas(e,i=!1){e||(e=224);const{width:s,height:n}=r(this,gt),a=document.createElement("canvas");let o=r(this,gt),h=s,c=n;if(s>e||n>e){const v=Math.min(e/s,e/n);h=Math.floor(s*v),c=Math.floor(n*v),r(this,Te)||(o=p(this,nd,l_).call(this,h,c))}a.width=h,a.height=c;const d=a.getContext("2d");d.filter=this._uiManager.hcmFilter;let u="white",g="#cfcfd8";"none"!==this._uiManager.hcmFilter?g="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(u="#8f8f9d",g="#42414d");const b=15,_=new OffscreenCanvas(30,30),A=_.getContext("2d");if(A.fillStyle=u,A.fillRect(0,0,30,30),A.fillStyle=g,A.fillRect(0,0,b,b),A.fillRect(b,b,b,b),d.fillStyle=d.createPattern(_,"repeat"),d.fillRect(0,0,h,c),i){const v=new OffscreenCanvas(h,c),y=v.getContext("2d",{willReadFrequently:!0});y.drawImage(o,0,0,o.width,o.height,0,0,h,c);const E=y.getImageData(0,0,h,c).data;return d.drawImage(v,0,0),{canvas:a,imageData:{width:h,height:c,data:E}}}return d.drawImage(o,0,0,o.width,o.height,0,0,h,c),{canvas:a,imageData:null}}getImageForAltText(){return r(this,Ei)}static deserialize(e,i,s){if(e instanceof OA)return null;const n=super.deserialize(e,i,s),{rect:a,bitmapUrl:o,bitmapId:h,isSvg:c,accessibilityData:d}=e;h&&s.imageManager.isValidId(h)?m(n,jt,h):m(n,hs,o),m(n,Te,c);const[u,g]=n.pageDimensions;return n.width=(a[2]-a[0])/u,n.height=(a[3]-a[1])/g,d&&(n.altTextData=d),n}serialize(e=!1,i=null){if(this.isEmpty())return null;const s={annotationType:K.STAMP,bitmapId:r(this,jt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:r(this,Te),structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=p(this,Yo,im).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:n,altText:a}=this.serializeAltText(!1);if(!n&&a&&(s.accessibilityData={type:"Figure",alt:a}),null===i)return s;i.stamps||(i.stamps=new Map);const o=r(this,Te)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(i.stamps.has(r(this,jt))){if(r(this,Te)){const h=i.stamps.get(r(this,jt));o>h.area&&(h.area=o,h.serialized.bitmap.close(),h.serialized.bitmap=p(this,Yo,im).call(this,!1))}}else i.stamps.set(r(this,jt),{area:o,serialized:s}),s.bitmap=p(this,Yo,im).call(this,!1);return s}};let ql=db;gt=new WeakMap,jt=new WeakMap,sn=new WeakMap,hs=new WeakMap,nn=new WeakMap,Ko=new WeakMap,Ei=new WeakMap,cs=new WeakMap,xi=new WeakMap,Te=new WeakMap,id=new WeakMap,Zr=new WeakSet,_u=function(e,i=!1){e?(m(this,gt,e.bitmap),i||(m(this,jt,e.id),m(this,Te,e.isSvg)),e.file&&m(this,Ko,e.file.name),p(this,sd,o_).call(this)):this.remove()},Jr=new WeakSet,Au=function(){if(m(this,sn,null),this._uiManager.enableWaiting(!1),r(this,Ei)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,gt))return this._editToolbar.hide(),void this._uiManager.editAltText(this,!0);if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&r(this,gt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Xo=new WeakSet,em=function(){var e=this;if(r(this,jt))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(r(this,jt)).then(n=>p(this,Zr,_u).call(this,n,!0)).finally(()=>p(this,Jr,Au).call(this));if(r(this,hs)){const n=r(this,hs);return m(this,hs,null),this._uiManager.enableWaiting(!0),void m(this,sn,this._uiManager.imageManager.getFromUrl(n).then(a=>p(this,Zr,_u).call(this,a)).finally(()=>p(this,Jr,Au).call(this)))}if(r(this,nn)){const n=r(this,nn);return m(this,nn,null),this._uiManager.enableWaiting(!0),void m(this,sn,this._uiManager.imageManager.getFromFile(n).then(a=>p(this,Zr,_u).call(this,a)).finally(()=>p(this,Jr,Au).call(this)))}const i=document.createElement("input");i.type="file",i.accept=db.supportedTypesStr;const s=this._uiManager._signal;m(this,sn,new Promise(n=>{i.addEventListener("change",(0,I.Z)(function*(){var a;if(i.files&&0!==i.files.length){e._uiManager.enableWaiting(!0);const o=yield e._uiManager.imageManager.getFromFile(i.files[0]);e._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:e._uiManager.useNewAltTextFlow}}),p(a=e,Zr,_u).call(a,o)}else e.remove();n()}),{signal:s}),i.addEventListener("cancel",()=>{this.remove(),n()},{signal:s})}).finally(()=>p(this,Jr,Au).call(this))),i.click()},sd=new WeakSet,o_=function(){const{div:e}=this;let{width:i,height:s}=r(this,gt);const[n,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*n,s=this.height*a;else if(i>o*n||s>o*a){const u=Math.min(o*n/i,o*a/s);i*=u,s*=u}const[h,c]=this.parentDimensions;this.setDims(i*h/n,s*c/a),this._uiManager.enableWaiting(!1);const d=m(this,Ei,document.createElement("canvas"));e.append(d),(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow)&&(e.hidden=!1),p(this,rd,h_).call(this,i,s),p(this,Hp,o0).call(this),r(this,id)||(this.parent.addUndoableEditor(this),m(this,id,!0)),this._reportTelemetry({action:"inserted_image"}),r(this,Ko)&&d.setAttribute("aria-label",r(this,Ko))},Bp=new WeakSet,a0=function(e,i){const[s,n]=this.parentDimensions;this.width=e/s,this.height=i/n,this.setDims(e,i),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,null!==r(this,xi)&&clearTimeout(r(this,xi)),m(this,xi,setTimeout(()=>{m(this,xi,null),p(this,rd,h_).call(this,e,i)},200))},nd=new WeakSet,l_=function(e,i){const{width:s,height:n}=r(this,gt);let a=s,o=n,h=r(this,gt);for(;a>2*e||o>2*i;){const c=a,d=o;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const u=new OffscreenCanvas(a,o);u.getContext("2d").drawImage(h,0,0,c,d,0,0,a,o),h=u.transferToImageBitmap()}return h},rd=new WeakSet,h_=function(e,i){e=Math.ceil(e),i=Math.ceil(i);const s=r(this,Ei);if(!s||s.width===e&&s.height===i)return;s.width=e,s.height=i;const n=r(this,Te)?r(this,gt):p(this,nd,l_).call(this,e,i),a=s.getContext("2d");a.filter=this._uiManager.hcmFilter,a.drawImage(n,0,0,n.width,n.height,0,0,e,i)},Yo=new WeakSet,im=function(e){if(e){if(r(this,Te)){const n=this._uiManager.imageManager.getSvgUrl(r(this,jt));if(n)return n}const i=document.createElement("canvas");return({width:i.width,height:i.height}=r(this,gt)),i.getContext("2d").drawImage(r(this,gt),0,0),i.toDataURL()}if(r(this,Te)){const[i,s]=this.pageDimensions,n=Math.round(this.width*i*Ie.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*Ie.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(n,a);return o.getContext("2d").drawImage(r(this,gt),0,0,r(this,gt).width,r(this,gt).height,0,0,n,a),o.transferToImageBitmap()}return structuredClone(r(this,gt))},Hp=new WeakSet,o0=function(){!this._uiManager._signal||(m(this,cs,new ResizeObserver(e=>{const i=e[0].contentRect;i.width&&i.height&&p(this,Bp,a0).call(this,i.width,i.height)})),r(this,cs).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{r(this,cs)?.disconnect(),m(this,cs,null)},{once:!0}))},R(ql,"_type","stamp"),R(ql,"_editorType",K.STAMP);const fs=class{constructor({uiManager:t,pageIndex:e,div:i,accessibilityManager:s,annotationLayer:n,drawLayer:a,textLayer:o,viewport:h,l10n:c}){f(this,Vp),f(this,ad),f(this,od),f(this,ld),f(this,tl),f(this,Qr,void 0),f(this,Zo,!1),f(this,Ci,null),f(this,rn,null),f(this,ds,null),f(this,Ae,new Map),f(this,an,!1),f(this,Jo,!1),f(this,Qo,!1),f(this,Jt,null),f(this,us,null),f(this,F,void 0);const d=[...r(fs,on).values()];if(!fs._initialized){fs._initialized=!0;for(const u of d)u.initialize(c,t)}t.registerEditorTypes(d),m(this,F,t),this.pageIndex=e,this.div=i,m(this,Qr,s),m(this,Ci,n),this.viewport=h,m(this,Jt,o),this.drawLayer=a,r(this,F).addLayer(this)}get isEmpty(){return 0===r(this,Ae).size}get isInvisible(){return this.isEmpty&&r(this,F).getMode()===K.NONE}updateToolbar(t){r(this,F).updateToolbar(t)}updateMode(t=r(this,F).getMode()){switch(p(this,tl,sm).call(this),t){case K.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case K.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case K.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of r(fs,on).values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===r(this,Jt)?.div}addInkEditorIfNeeded(t){if(r(this,F).getMode()===K.INK){if(!t)for(const i of r(this,Ae).values())if(i.isEmpty())return void i.setInBackground();this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(t){r(this,F).setEditingState(t)}addCommands(t){r(this,F).addCommands(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){r(this,Ci)?.div.classList.toggle("disabled",!t)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const i of r(this,Ae).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(r(this,F).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!r(this,Ci))return;const e=r(this,Ci).getEditableAnnotations();for(const i of e){if(i.hide(),r(this,F).isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=this.deserialize(i);!s||(this.addOrRebuild(s),s.enableEditing())}}disable(){m(this,Qo,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const s of r(this,Ae).values())if(s.disableEditing(),s.annotationElementId){if(null!==s.serialize()){t.set(s.annotationElementId,s);continue}e.set(s.annotationElementId,s),this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(r(this,Ci)){const s=r(this,Ci).getEditableAnnotations();for(const n of s){const{id:a}=n.data;if(r(this,F).isDeletedAnnotationElement(a))continue;let o=e.get(a);o?(o.resetAnnotationElement(n),o.show(!1),n.show()):(o=t.get(a),o&&(r(this,F).addChangedExistingAnnotation(o),o.renderAnnotationElement(n),o.show(!1)),n.show())}}p(this,tl,sm).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of r(fs,on).values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),m(this,Qo,!1)}getEditableAnnotation(t){return r(this,Ci)?.getEditableAnnotation(t)||null}setActiveEditor(t){r(this,F).getActive()!==t&&r(this,F).setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,r(this,Jt)?.div&&!r(this,us)){m(this,us,new AbortController);const t=r(this,F).combinedSignal(r(this,us));r(this,Jt).div.addEventListener("pointerdown",p(this,Vp,l0).bind(this),{signal:t}),r(this,Jt).div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,r(this,Jt)?.div&&r(this,us)&&(r(this,us).abort(),m(this,us,null),r(this,Jt).div.classList.remove("highlighting"))}enableClick(){if(r(this,rn))return;m(this,rn,new AbortController);const t=r(this,F).combinedSignal(r(this,rn));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t}),this.div.addEventListener("pointerup",this.pointerup.bind(this),{signal:t})}disableClick(){r(this,rn)?.abort(),m(this,rn,null)}attach(t){r(this,Ae).set(t.id,t);const{annotationElementId:e}=t;e&&r(this,F).isDeletedAnnotationElement(e)&&r(this,F).removeDeletedAnnotationElement(t)}detach(t){r(this,Ae).delete(t.id),r(this,Qr)?.removePointerInTextLayer(t.contentDiv),!r(this,Qo)&&t.annotationElementId&&r(this,F).addDeletedAnnotationElement(t)}remove(t){this.detach(t),r(this,F).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1,r(this,Jo)||this.addInkEditorIfNeeded(!1)}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(r(this,F).addDeletedAnnotationElement(t.annotationElementId),G.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(t.parent!==this||!t.isAttachedToDOM){if(this.changeParent(t),r(this,F).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(),r(this,F).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!r(this,ds)&&(t._focusEventsAllowed=!1,m(this,ds,setTimeout(()=>{m(this,ds,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:r(this,F)._signal}),e.focus())},0))),t._structTreeParentId=r(this,Qr)?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){this.addCommands({cmd:()=>t._uiManager.rebuild(t),undo:()=>{t.remove()},mustExec:!1})}getNextId(){return r(this,F).getId()}combinedSignal(t){return r(this,F).combinedSignal(t)}canCreateNewEmptyEditor(){return r(this,ad,c_)?.canCreateNewEmptyEditor()}pasteEditor(t,e){r(this,F).updateToolbar(t),r(this,F).updateMode(t);const{offsetX:i,offsetY:s}=p(this,ld,u_).call(this),n=this.getNextId(),a=p(this,od,d_).call(this,{parent:this,id:n,x:i,y:s,uiManager:r(this,F),isCentered:!0,...e});a&&this.add(a)}deserialize(t){return r(fs,on).get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,r(this,F))||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),n=p(this,od,d_).call(this,{parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:r(this,F),isCentered:e,...i});return n&&this.add(n),n}addNewEditor(){this.createAndAddNewEditor(p(this,ld,u_).call(this),!0)}setSelected(t){r(this,F).setSelected(t)}toggleSelected(t){r(this,F).toggleSelected(t)}isSelected(t){return r(this,F).isSelected(t)}unselect(t){r(this,F).unselect(t)}pointerup(t){const{isMac:e}=se.platform;if(!(0!==t.button||t.ctrlKey&&e)&&t.target===this.div&&r(this,an)){if(m(this,an,!1),!r(this,Zo))return void m(this,Zo,!0);if(r(this,F).getMode()===K.STAMP)return void r(this,F).unselectAll();this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(r(this,F).getMode()===K.HIGHLIGHT&&this.enableTextSelection(),r(this,an))return void m(this,an,!1);const{isMac:e}=se.platform;if(0!==t.button||t.ctrlKey&&e||t.target!==this.div)return;m(this,an,!0);const i=r(this,F).getActive();m(this,Zo,!i||i.isEmpty())}findNewParent(t,e,i){const s=r(this,F).findParent(e,i);return null!==s&&s!==this&&(s.changeParent(t),!0)}destroy(){r(this,F).getActive()?.parent===this&&(r(this,F).commitOrRemove(),r(this,F).setActiveEditor(null)),r(this,ds)&&(clearTimeout(r(this,ds)),m(this,ds,null));for(const t of r(this,Ae).values())r(this,Qr)?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,r(this,Ae).clear(),r(this,F).removeLayer(this)}render({viewport:t}){this.viewport=t,On(this.div,t);for(const e of r(this,F).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){r(this,F).commitOrRemove(),p(this,tl,sm).call(this);const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,On(this.div,{rotation:i}),e!==i)for(const s of r(this,Ae).values())s.rotate(i);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return r(this,F).viewParameters.realScale}};let Kl=fs;Qr=new WeakMap,Zo=new WeakMap,Ci=new WeakMap,rn=new WeakMap,ds=new WeakMap,Ae=new WeakMap,an=new WeakMap,Jo=new WeakMap,Qo=new WeakMap,Jt=new WeakMap,us=new WeakMap,F=new WeakMap,on=new WeakMap,Vp=new WeakSet,l0=function(t){r(this,F).unselectAll();const{target:e}=t;if(e===r(this,Jt).div||e.classList.contains("endOfContent")&&r(this,Jt).div.contains(e)){const{isMac:i}=se.platform;if(0!==t.button||t.ctrlKey&&i)return;r(this,F).showAllEditors("highlight",!0,!0),r(this,Jt).div.classList.add("free"),this.toggleDrawing(),Gt.startHighlighting(this,"ltr"===r(this,F).direction,t),r(this,Jt).div.addEventListener("pointerup",()=>{r(this,Jt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:r(this,F)._signal}),t.preventDefault()}},ad=new WeakSet,c_=function(){return r(fs,on).get(r(this,F).getMode())},od=new WeakSet,d_=function(t){const e=r(this,ad,c_);return e?new e.prototype.constructor(t):null},ld=new WeakSet,u_=function(){const{x:t,y:e,width:i,height:s}=this.div.getBoundingClientRect(),n=Math.max(0,t),a=Math.max(0,e),c=(n+Math.min(window.innerWidth,t+i))/2-t,d=(a+Math.min(window.innerHeight,e+s))/2-e,[u,g]=this.viewport.rotation%180==0?[c,d]:[d,c];return{offsetX:u,offsetY:g}},tl=new WeakSet,sm=function(){m(this,Jo,!0);for(const t of r(this,Ae).values())t.isEmpty()&&t.remove();m(this,Jo,!1)},R(Kl,"_initialized",!1),f(Kl,on,new Map([Oe,Fe,ql,Gt].map(t=>[t._editorType,t])));const Kt=class{constructor({pageIndex:t}){f(this,dd),f(this,jp),f(this,Si,null),f(this,hd,0),f(this,Pt,new Map),f(this,ln,new Map),this.pageIndex=t}setParent(t){if(r(this,Si)){if(r(this,Si)!==t){if(r(this,Pt).size>0)for(const e of r(this,Pt).values())e.remove(),t.append(e);m(this,Si,t)}}else m(this,Si,t)}static get _svgFactory(){return Y(this,"_svgFactory",new wm)}highlight(t,e,i,s=!1){const n=ee(this,hd)._++,a=p(this,dd,p_).call(this,t.box);a.classList.add("highlight"),t.free&&a.classList.add("free");const o=Kt._svgFactory.createElement("defs");a.append(o);const h=Kt._svgFactory.createElement("path");o.append(h);const c=`path_p${this.pageIndex}_${n}`;h.setAttribute("id",c),h.setAttribute("d",t.toSVGPath()),s&&r(this,ln).set(n,h);const d=p(this,jp,h0).call(this,o,c),u=Kt._svgFactory.createElement("use");return a.append(u),a.setAttribute("fill",e),a.setAttribute("fill-opacity",i),u.setAttribute("href",`#${c}`),r(this,Pt).set(n,a),{id:n,clipPathId:`url(#${d})`}}highlightOutline(t){const e=ee(this,hd)._++,i=p(this,dd,p_).call(this,t.box);i.classList.add("highlightOutline");const s=Kt._svgFactory.createElement("defs");i.append(s);const n=Kt._svgFactory.createElement("path");s.append(n);const a=`path_p${this.pageIndex}_${e}`;let o;if(n.setAttribute("id",a),n.setAttribute("d",t.toSVGPath()),n.setAttribute("vector-effect","non-scaling-stroke"),t.free){i.classList.add("free");const d=Kt._svgFactory.createElement("mask");s.append(d),o=`mask_p${this.pageIndex}_${e}`,d.setAttribute("id",o),d.setAttribute("maskUnits","objectBoundingBox");const u=Kt._svgFactory.createElement("rect");d.append(u),u.setAttribute("width","1"),u.setAttribute("height","1"),u.setAttribute("fill","white");const g=Kt._svgFactory.createElement("use");d.append(g),g.setAttribute("href",`#${a}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const h=Kt._svgFactory.createElement("use");i.append(h),h.setAttribute("href",`#${a}`),o&&h.setAttribute("mask",`url(#${o})`);const c=h.cloneNode();return i.append(c),h.classList.add("mainOutline"),c.classList.add("secondaryOutline"),r(this,Pt).set(e,i),e}finalizeLine(t,e){const i=r(this,ln).get(t);r(this,ln).delete(t),this.updateBox(t,e.box),i.setAttribute("d",e.toSVGPath())}updateLine(t,e){r(this,Pt).get(t).firstChild.firstChild.setAttribute("d",e.toSVGPath())}removeFreeHighlight(t){this.remove(t),r(this,ln).delete(t)}updatePath(t,e){r(this,ln).get(t).setAttribute("d",e.toSVGPath())}updateBox(t,e){var i;p(i=Kt,cd,f_).call(i,r(this,Pt).get(t),e)}show(t,e){r(this,Pt).get(t).classList.toggle("hidden",!e)}rotate(t,e){r(this,Pt).get(t).setAttribute("data-main-rotation",e)}changeColor(t,e){r(this,Pt).get(t).setAttribute("fill",e)}changeOpacity(t,e){r(this,Pt).get(t).setAttribute("fill-opacity",e)}addClass(t,e){r(this,Pt).get(t).classList.add(e)}removeClass(t,e){r(this,Pt).get(t).classList.remove(e)}remove(t){null!==r(this,Si)&&(r(this,Pt).get(t).remove(),r(this,Pt).delete(t))}destroy(){m(this,Si,null);for(const t of r(this,Pt).values())t.remove();r(this,Pt).clear()}};let $u=Kt;Si=new WeakMap,hd=new WeakMap,Pt=new WeakMap,ln=new WeakMap,cd=new WeakSet,f_=function(t,{x:e=0,y:i=0,width:s=1,height:n=1}={}){const{style:a}=t;a.top=100*i+"%",a.left=100*e+"%",a.width=100*s+"%",a.height=100*n+"%"},dd=new WeakSet,p_=function(t){var i;const e=Kt._svgFactory.create(1,1,!0);return r(this,Si).append(e),e.setAttribute("aria-hidden",!0),p(i=Kt,cd,f_).call(i,e,t),e},jp=new WeakSet,h0=function(t,e){const i=Kt._svgFactory.createElement("clipPath");t.append(i);const s=`clip_${e}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const n=Kt._svgFactory.createElement("use");return i.append(n),n.setAttribute("href",`#${e}`),n.classList.add("clip"),s},f($u,cd);var $E=H.AbortException,qE=H.AnnotationEditorLayer,KE=H.AnnotationEditorParamsType,BA=H.AnnotationEditorType,XE=H.AnnotationEditorUIManager,YE=H.AnnotationLayer,ZE=H.AnnotationMode,JE=H.CMapCompressionType,QE=H.ColorPicker,tx=H.DOMSVGFactory,ex=H.DrawLayer,ix=H.FeatureTest,HA=H.GlobalWorkerOptions,sx=H.ImageKind,nx=H.InvalidPDFException,rx=H.MissingPDFException,ax=H.OPS,ox=H.PDFDataRangeTransport,lx=H.PDFDateString,hx=H.PDFWorker,cx=H.PasswordResponses,dx=H.PermissionFlag,ux=H.PixelsPerInch,fx=H.RenderingCancelledException,px=H.TextLayer,gx=H.UnexpectedResponseException,mx=H.Util,VA=H.VerbosityLevel,bx=H.XfaLayer,_x=H.build,Ax=H.createValidAbsoluteUrl,yx=H.fetchData,jA=H.getDocument,vx=H.getFilenameFromUrl,wx=H.getPdfFilenameFromUrl,Ex=H.getXfaPageViewport,xx=H.isDataScheme,Cx=H.isPdfFile,Sx=H.noContextMenu,Px=H.normalizeUnicode,Tx=H.setLayerDimensions,Mx=H.shadow,qu=H.version;function UA(l){this.wrapped=l}function zA(l){return new UA(l)}function Xl(l){var t,e;function s(a,o){try{var h=l[a](o),c=h.value,d=c instanceof UA;Promise.resolve(d?c.wrapped:c).then(function(u){d?s("return"===a?"return":"next",u):n(h.done?"return":"normal",u)},function(u){s("throw",u)})}catch(u){n("throw",u)}}function n(a,o){switch(a){case"return":t.resolve({value:o,done:!0});break;case"throw":t.reject(o);break;default:t.resolve({value:o,done:!1})}(t=t.next)?s(t.key,t.arg):e=null}this._invoke=function i(a,o){return new Promise(function(h,c){var d={key:a,arg:o,resolve:h,reject:c,next:null};e?e=e.next=d:(t=e=d,s(a,o))})},"function"!=typeof l.return&&(this.return=void 0)}function WA(l){return function(){return new Xl(l.apply(this,arguments))}}function Ku(l){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var i=e.done;return Promise.resolve(e.value).then(function(s){return{value:s,done:i}})}return(Ku=function(i){this.s=i,this.n=i.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(i){var s=this.s.return;return void 0===s?Promise.resolve({value:i,done:!0}):t(s.apply(this.s,arguments))},throw:function(i){var s=this.s.return;return void 0===s?Promise.reject(i):t(s.apply(this.s,arguments))}},new Ku(l)}Xl.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Xl.prototype.next=function(l){return this._invoke("next",l)},Xl.prototype.throw=function(l){return this._invoke("throw",l)},Xl.prototype.return=function(l){return this._invoke("return",l)};var Yl={d:(l,t)=>{for(var e in t)Yl.o(t,e)&&!Yl.o(l,e)&&Object.defineProperty(l,e,{enumerable:!0,get:t[e]})},o:(l,t)=>Object.prototype.hasOwnProperty.call(l,t)},lt=globalThis.pdfjsViewer={};Yl.d(lt,{AnnotationLayerBuilder:()=>ly,DownloadManager:()=>SC,EventBus:()=>dy,FindState:()=>Ps,GenericL10n:()=>Be,LinkTarget:()=>Hn,PDFFindController:()=>fC,PDFHistory:()=>vS,PDFLinkService:()=>Jl,PDFPageView:()=>Iy,PDFScriptingManager:()=>IS,PDFSinglePageViewer:()=>NS,PDFViewer:()=>Fy,ProgressBar:()=>Wx,RenderingStates:()=>ct,ScrollMode:()=>Z,SimpleLinkService:()=>Wm,SpreadMode:()=>$t,StructTreeLayerBuilder:()=>ky,TextLayerBuilder:()=>Ts,XfaLayerBuilder:()=>Ry,parseQueryString:()=>Xu});const ct={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},Z={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},$t={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};class Ox{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return 1!==this.sx||1!==this.sy}}function XA(l,t,e=!1){let i=l.offsetParent;if(!i)return void console.error("offsetParent is not set -- cannot scroll");let s=l.offsetTop+l.clientTop,n=l.offsetLeft+l.clientLeft;for(;i.clientHeight===i.scrollHeight&&i.clientWidth===i.scrollWidth||e&&(i.classList.contains("markedContent")||"hidden"===getComputedStyle(i).overflow);)if(s+=i.offsetTop,n+=i.offsetLeft,i=i.offsetParent,!i)return;t&&(void 0!==t.top&&(s+=t.top),void 0!==t.left&&(n+=t.left,i.scrollLeft=n)),i.scrollTop=s}function Xu(l){const t=new Map;for(const[e,i]of new URLSearchParams(l))t.set(e.toLowerCase(),i);return t}const YA=/[\x00-\x1F]/g;function Yu(l,t=!1){return YA.test(l)?t?l.replaceAll(YA,e=>"\0"===e?"":" "):l.replaceAll("\0",""):l}function Zl(l,t,e=0){let i=e,s=l.length-1;if(s<0||!t(l[s]))return l.length;if(t(l[i]))return i;for(;i<s;){const n=i+s>>1;t(l[n])?s=n:i=n+1}return i}function ZA(l){if(Math.floor(l)===l)return[l,1];const t=1/l;if(t>8)return[1,8];if(Math.floor(t)===t)return[1,t];const i=l>1?t:l;let h,s=0,n=1,a=1,o=1;for(;;){const c=s+a,d=n+o;if(d>8)break;i<=c/d?(a=c,o=d):(s=c,n=d)}return h=i-s/n<a/o-i?i===l?[s,n]:[n,s]:i===l?[a,o]:[o,a],h}function Zu(l,t){return l-l%t}function JA(l){return Number.isInteger(l)&&l%90==0}function QA(l){return l.width<=l.height}new Promise(function(l){window.requestAnimationFrame(l)});const Ux=document.documentElement.style;class Wx{constructor(t){f(this,hn,null),f(this,ta,null),f(this,cn,0),f(this,el,null),f(this,ea,!0),m(this,hn,t.classList),m(this,el,t.style)}get percent(){return r(this,cn)}set percent(t){m(this,cn,function zx(l,t,e){return Math.min(Math.max(l,t),e)}(t,0,100)),isNaN(t)?r(this,hn).add("indeterminate"):(r(this,hn).remove("indeterminate"),r(this,el).setProperty("--progressBar-percent",`${r(this,cn)}%`))}setWidth(t){if(!t)return;const i=t.parentNode.offsetWidth-t.offsetWidth;i>0&&r(this,el).setProperty("--progressBar-end-offset",`${i}px`)}setDisableAutoFetch(t=5e3){100===r(this,cn)||isNaN(r(this,cn))||(r(this,ta)&&clearTimeout(r(this,ta)),this.show(),m(this,ta,setTimeout(()=>{m(this,ta,null),this.hide()},t)))}hide(){!r(this,ea)||(m(this,ea,!1),r(this,hn).add("hidden"))}show(){r(this,ea)||(m(this,ea,!0),r(this,hn).remove("hidden"))}}hn=new WeakMap,ta=new WeakMap,cn=new WeakMap,el=new WeakMap,ea=new WeakMap;function Ju(l){return function $x(l){return l<11904}(l)?function qx(l){return 0==(65408&l)}(l)?function Yx(l){return 32===l||9===l||13===l||10===l}(l)?0:function Kx(l){return l>=97&&l<=122||l>=65&&l<=90}(l)||function Xx(l){return l>=48&&l<=57}(l)||95===l?1:2:function eC(l){return 3584==(65408&l)}(l)?7:160===l?0:1:function Zx(l){return l>=13312&&l<=40959||l>=63744&&l<=64255}(l)?3:function Jx(l){return l>=12448&&l<=12543}(l)?4:function Qx(l){return l>=12352&&l<=12447}(l)?5:function tC(l){return l>=65376&&l<=65439}(l)?6:1}let ty;const Ps={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},ey={"\u2010":"-","\u2018":"'","\u2019":"'","\u201a":"'","\u201b":"'","\u201c":'"',"\u201d":'"',"\u201e":'"',"\u201f":'"',"\xbc":"1/4","\xbd":"1/2","\xbe":"3/4"},iy=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let sy;const aC=/\p{M}+/gu,oC=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,lC=/([^\p{M}])\p{M}*$/u,hC=/^\p{M}*([^\p{M}])/u,cC=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,ny=new Map,ry=new Map;let jm=null,Um=null;function zm(l){const t=[];let e,i;for(;null!==(e=cC.exec(l));){let{index:b}=e;for(const _ of e[0]){let A=ny.get(_);A||(A=_.normalize("NFD").length,ny.set(_,A)),t.push([A,b++])}}if(0===t.length&&jm)i=jm;else if(t.length>0&&Um)i=Um;else{const y=`([${Object.keys(ey).join("")}])|([${function iC(){return ty||(ty="\xa0\xa8\xaa\xaf\xb2-\xb5\xb8-\xba\xbc-\xbe\u0132-\u0133\u013f-\u0140\u0149\u017f\u01c4-\u01cc\u01f1-\u01f3\u02b0-\u02b8\u02d8-\u02dd\u02e0-\u02e4\u0374\u037a\u037e\u0384-\u0385\u0387\u03d0-\u03d6\u03f0-\u03f2\u03f4-\u03f5\u03f9\u0587\u0675-\u0678\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e33\u0eb3\u0edc-\u0edd\u0f0c\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u10fc\u1d2c-\u1d2e\u1d30-\u1d3a\u1d3c-\u1d4d\u1d4f-\u1d6a\u1d78\u1d9b-\u1dbf\u1e9a-\u1e9b\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbd-\u1fc1\u1fc9\u1fcb\u1fcd-\u1fcf\u1fd3\u1fdb\u1fdd-\u1fdf\u1fe3\u1feb\u1fed-\u1fef\u1ff9\u1ffb\u1ffd-\u1ffe\u2000-\u200a\u2011\u2017\u2024-\u2026\u202f\u2033-\u2034\u2036-\u2037\u203c\u203e\u2047-\u2049\u2057\u205f\u2070-\u2071\u2074-\u208e\u2090-\u209c\u20a8\u2100-\u2103\u2105-\u2107\u2109-\u2113\u2115-\u2116\u2119-\u211d\u2120-\u2122\u2124\u2126\u2128\u212a-\u212d\u212f-\u2131\u2133-\u2139\u213b-\u2140\u2145-\u2149\u2150-\u217f\u2189\u222c-\u222d\u222f-\u2230\u2329-\u232a\u2460-\u24ea\u2a0c\u2a74-\u2a76\u2adc\u2c7c-\u2c7d\u2d6f\u2e9f\u2ef3\u2f00-\u2fd5\u3000\u3036\u3038-\u303a\u309b-\u309c\u309f\u30ff\u3131-\u318e\u3192-\u319f\u3200-\u321e\u3220-\u3247\u3250-\u327e\u3280-\u33ff\ua69c-\ua69d\ua770\ua7f2-\ua7f4\ua7f8-\ua7f9\uab5c-\uab5f\uab69\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfc\ufe10-\ufe19\ufe30-\ufe44\ufe47-\ufe52\ufe54-\ufe66\ufe68-\ufe6b\ufe70-\ufe72\ufe74\ufe76-\ufefc\uff01-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc\uffe0-\uffe6"),ty}()}])|((?:\u3099|\u309a)\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|((?:\\p{Ideographic}|[\u3040-\u30ff])\\n)|(\\n)`;i=0===t.length?jm=new RegExp(y+"|(\\u0000)","gum"):Um=new RegExp(y+"|([\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f])","gum")}const s=[];for(;null!==(e=aC.exec(l));)s.push([e[0].length,e.index]);let n=l.normalize("NFD");const a=[[0,0]];let o=0,h=0,c=0,d=0,u=0,g=!1;return n=n.replace(i,(b,_,A,v,y,E,x,C,S,P)=>{if(P-=d,_){const L=ey[_],k=L.length;for(let w=1;w<k;w++)a.push([P-c+w,c-w]);return c-=k-1,L}if(A){let L=ry.get(A);L||(L=A.normalize("NFKC"),ry.set(A,L));const k=L.length;for(let w=1;w<k;w++)a.push([P-c+w,c-w]);return c-=k-1,L}if(v)return g=!0,P+u===s[o]?.[1]?++o:(a.push([P-1-c+1,c-1]),c-=1,d+=1),a.push([P-c+1,c]),d+=1,u+=1,v.charAt(0);if(y){const L=y.endsWith("\n"),k=L?y.length-2:y.length;g=!0;let w=k;P+u===s[o]?.[1]&&(w-=s[o][0],++o);for(let T=1;T<=w;T++)a.push([P-1-c+T,c-T]);return c-=w,d+=w,L?(a.push([(P+=k-1)-c+1,1+c]),c+=1,d+=1,u+=1,y.slice(0,k)):y}if(E)return a.push([P-c+(E.length-2),1+c]),c+=1,d+=1,u+=1,E.slice(0,-2);if(x)return a.push([P-c+(x.length-1),c]),d+=1,u+=1,x.slice(0,-1);if(C)return a.push([P-c+1,c-1]),c-=1,d+=1,u+=1," ";if(P+u===t[h]?.[1]){const L=t[h][0]-1;++h;for(let k=1;k<=L;k++)a.push([P-(c-k),c-k]);c-=L,d+=L}return S}),a.push([n.length,c]),[n,a,g]}class fC{constructor({linkService:t,eventBus:e,updateMatchesCountOnProgress:i=!0}){f(this,Up),f(this,ud),f(this,fd),f(this,zp),f(this,Wp),f(this,pd),f(this,Gp),f(this,$p),f(this,sl),f(this,sa),f(this,dn),f(this,qp),f(this,gd),f(this,md),f(this,nl),f(this,Kp),f(this,bd),f(this,_d),f(this,na),f(this,Ft,null),f(this,il,!0),f(this,ia,0),this._linkService=t,this._eventBus=e,m(this,il,i),this.onIsPageVisible=null,p(this,ud,g_).call(this),e._on("find",p(this,Up,c0).bind(this)),e._on("findbarclose",p(this,Kp,m0).bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return r(this,Ft)}setDocument(t){this._pdfDocument&&p(this,ud,g_).call(this),t&&(this._pdfDocument=t,this._firstPageCapability.resolve())}scrollMatchIntoView({element:t=null,selectedLeft:e=0,pageIndex:i=-1,matchIndex:s=-1}){this._scrollMatches&&t&&-1!==s&&s===this._selected.matchIdx&&-1!==i&&i===this._selected.pageIdx&&(this._scrollMatches=!1,XA(t,{top:-50,left:e+-400},!0))}match(t,e,i){const s=this._hasDiacritics[i];let n=!1;if("string"==typeof t?[n,t]=p(this,pd,b_).call(this,t,s):t=t.sort().reverse().map(u=>{const[g,b]=p(this,pd,b_).call(this,u,s);return n||(n=g),`(${b})`}).join("|"),!t)return;const{caseSensitive:a,entireWord:o}=r(this,Ft);t=new RegExp(t,`g${n?"u":""}${a?"":"i"}`);const c=[];let d;for(;null!==(d=t.exec(e));)o&&!p(this,Wp,u0).call(this,e,d.index,d[0].length)||c.push({index:d.index,length:d[0].length});return c}}Ft=new WeakMap,il=new WeakMap,ia=new WeakMap,Up=new WeakSet,c0=function(t){if(!t)return;const e=this._pdfDocument,{type:i}=t;(null===r(this,Ft)||p(this,zp,d0).call(this,t))&&(this._dirtyMatch=!0),m(this,Ft,t),"highlightallchange"!==i&&p(this,na,vu).call(this,Ps.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||e&&this._pdfDocument!==e)return;p(this,$p,p0).call(this);const s=!this._highlightMatches,n=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),i?this._dirtyMatch?p(this,dn,Rl).call(this):"again"===i?(p(this,dn,Rl).call(this),s&&r(this,Ft).highlightAll&&p(this,sa,yu).call(this)):"highlightallchange"===i?(n?p(this,dn,Rl).call(this):this._highlightMatches=!0,p(this,sa,yu).call(this)):p(this,dn,Rl).call(this):this._findTimeout=setTimeout(()=>{p(this,dn,Rl).call(this),this._findTimeout=null},250)})},ud=new WeakSet,g_=function(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],m(this,ia,0),m(this,Ft,null),this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()},fd=new WeakSet,m_=function(){const{query:t}=r(this,Ft);return"string"==typeof t?(t!==this._rawQuery&&(this._rawQuery=t,[this._normalizedQuery]=zm(t)),this._normalizedQuery):(t||[]).filter(e=>!!e).map(e=>zm(e)[0])},zp=new WeakSet,d0=function(t){const e=t.query,i=r(this,Ft).query,s=typeof e;if(s!==typeof i)return!0;if("string"===s){if(e!==i)return!0}else if(JSON.stringify(e)!==JSON.stringify(i))return!0;switch(t.type){case"again":const a=this._selected.pageIdx+1,o=this._linkService;return a>=1&&a<=o.pagesCount&&a!==o.page&&!(this.onIsPageVisible?.(a)??1);case"highlightallchange":return!1}return!0},Wp=new WeakSet,u0=function(t,e,i){let s=t.slice(0,e).match(lC);if(s){const n=t.charCodeAt(e),a=s[1].charCodeAt(0);if(Ju(n)===Ju(a))return!1}if(s=t.slice(e+i).match(hC),s){const n=t.charCodeAt(e+i-1),a=s[1].charCodeAt(0);if(Ju(n)===Ju(a))return!1}return!0},pd=new WeakSet,b_=function(t,e){const{matchDiacritics:i}=r(this,Ft);let s=!1;const n="[ ]*";return(t=t.replaceAll(oC,(a,o,h,c,d,u)=>o?`[ ]*\\${o}[ ]*`:h?`[ ]*${h}[ ]*`:c?"[ ]+":i?d||u:d?iy.has(d.charCodeAt(0))?d:"":e?(s=!0,`${u}\\p{M}*`):u)).endsWith(n)&&(t=t.slice(0,t.length-n.length)),i&&e&&(sy||(sy=String.fromCharCode(...iy)),s=!0,t=`${t}(?=[${sy}]|[^\\p{M}]|$)`),[s,t]},Gp=new WeakSet,f0=function(t){const e=r(this,fd,m_);if(0===e.length)return;const s=this.match(e,this._pageContents[t],t),n=this._pageMatches[t]=[],a=this._pageMatchesLength[t]=[],o=this._pageDiffs[t];s?.forEach(({index:c,length:d})=>{const[u,g]=function uC(l,t,e){if(!l)return[t,e];const i=t,s=t+e-1;let n=Zl(l,d=>d[0]>=i);l[n][0]>i&&--n;let a=Zl(l,d=>d[0]>=s,n);l[a][0]>s&&--a;const o=i+l[n][1];return[o,s+l[a][1]+1-o]}(o,c,d);g&&(n.push(u),a.push(g))}),r(this,Ft).highlightAll&&p(this,sl,nm).call(this,t),this._resumePageIdx===t&&(this._resumePageIdx=null,p(this,gd,__).call(this));const h=n.length;this._matchesCountTotal+=h,r(this,il)?h>0&&p(this,_d,v_).call(this):++ee(this,ia)._===this._linkService.pagesCount&&p(this,_d,v_).call(this)},$p=new WeakSet,p0=function(){if(this._extractTextPromises.length>0)return;let t=Promise.resolve();const e={disableNormalization:!0};for(let i=0,s=this._linkService.pagesCount;i<s;i++){const{promise:n,resolve:a}=Promise.withResolvers();this._extractTextPromises[i]=n,t=t.then(()=>this._pdfDocument.getPage(i+1).then(o=>o.getTextContent(e)).then(o=>{const h=[];for(const c of o.items)h.push(c.str),c.hasEOL&&h.push("\n");[this._pageContents[i],this._pageDiffs[i],this._hasDiacritics[i]]=zm(h.join("")),a()},o=>{console.error(`Unable to get text content for page ${i+1}`,o),this._pageContents[i]="",this._pageDiffs[i]=null,this._hasDiacritics[i]=!1,a()}))}},sl=new WeakSet,nm=function(t){this._scrollMatches&&this._selected.pageIdx===t&&(this._linkService.page=t+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:t})},sa=new WeakSet,yu=function(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})},dn=new WeakSet,Rl=function(){const t=r(this,Ft).findPrevious,e=this._linkService.page-1,i=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=e,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,m(this,ia,0),this._matchesCountTotal=0,p(this,sa,yu).call(this);for(let a=0;a<i;a++)this._pendingFindMatches.has(a)||(this._pendingFindMatches.add(a),this._extractTextPromises[a].then(()=>{this._pendingFindMatches.delete(a),p(this,Gp,f0).call(this,a)}))}if(0===r(this,fd,m_).length)return void p(this,na,vu).call(this,Ps.FOUND);if(this._resumePageIdx)return;const n=this._offset;if(this._pagesToSearch=i,null!==n.matchIdx){const a=this._pageMatches[n.pageIdx].length;if(!t&&n.matchIdx+1<a||t&&n.matchIdx>0)return n.matchIdx=t?n.matchIdx-1:n.matchIdx+1,void p(this,nl,rm).call(this,!0);p(this,md,A_).call(this,t)}p(this,gd,__).call(this)},qp=new WeakSet,g0=function(t){const e=this._offset,i=t.length,s=r(this,Ft).findPrevious;return i?(e.matchIdx=s?i-1:0,p(this,nl,rm).call(this,!0),!0):(p(this,md,A_).call(this,s),!!(e.wrapped&&(e.matchIdx=null,this._pagesToSearch<0))&&(p(this,nl,rm).call(this,!1),!0))},gd=new WeakSet,__=function(){null!==this._resumePageIdx&&console.error("There can only be one pending page.");let t=null;do{const e=this._offset.pageIdx;if(t=this._pageMatches[e],!t){this._resumePageIdx=e;break}}while(!p(this,qp,g0).call(this,t))},md=new WeakSet,A_=function(t){const e=this._offset,i=this._linkService.pagesCount;e.pageIdx=t?e.pageIdx-1:e.pageIdx+1,e.matchIdx=null,this._pagesToSearch--,(e.pageIdx>=i||e.pageIdx<0)&&(e.pageIdx=t?i-1:0,e.wrapped=!0)},nl=new WeakSet,rm=function(t=!1){let e=Ps.NOT_FOUND;const i=this._offset.wrapped;if(this._offset.wrapped=!1,t){const s=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,e=i?Ps.WRAPPED:Ps.FOUND,-1!==s&&s!==this._selected.pageIdx&&p(this,sl,nm).call(this,s)}p(this,na,vu).call(this,e,r(this,Ft).findPrevious),-1!==this._selected.pageIdx&&(this._scrollMatches=!0,p(this,sl,nm).call(this,this._selected.pageIdx))},Kp=new WeakSet,m0=function(t){const e=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||e&&this._pdfDocument!==e||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),p(this,na,vu).call(this,Ps.FOUND),this._highlightMatches=!1,p(this,sa,yu).call(this))})},bd=new WeakSet,y_=function(){const{pageIdx:t,matchIdx:e}=this._selected;let i=0,s=this._matchesCountTotal;if(-1!==e){for(let n=0;n<t;n++)i+=this._pageMatches[n]?.length||0;i+=e+1}return(i<1||i>s)&&(i=s=0),{current:i,total:s}},_d=new WeakSet,v_=function(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:p(this,bd,y_).call(this)})},na=new WeakSet,vu=function(t,e=!1){!r(this,il)&&(r(this,ia)!==this._linkService.pagesCount||t===Ps.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:t,previous:e,entireWord:r(this,Ft)?.entireWord??null,matchesCount:p(this,bd,y_).call(this),rawQuery:r(this,Ft)?.query??null})};const Hn={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},ub=class{constructor({eventBus:t,externalLinkTarget:e=null,externalLinkRel:i=null,ignoreDestinationZoom:s=!1}={}){R(this,"externalLinkEnabled",!0),this.eventBus=t,this.externalLinkTarget=e,this.externalLinkRel=i,this._ignoreDestinationZoom=s,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(t,e=null){this.baseUrl=e,this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setHistory(t){this.pdfHistory=t}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(t){this.pdfDocument&&(this.pdfViewer.currentPageNumber=t)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(t){this.pdfDocument&&(this.pdfViewer.pagesRotation=t)}get isInPresentationMode(){return!!this.pdfDocument&&this.pdfViewer.isInPresentationMode}goToDestination(t){var e=this;return(0,I.Z)(function*(){if(!e.pdfDocument)return;let i,s,n;if("string"==typeof t?(i=t,s=yield e.pdfDocument.getDestination(t)):(i=null,s=yield t),!Array.isArray(s))return void console.error(`goToDestination: "${s}" is not a valid destination array, for dest="${t}".`);const[a]=s;if(a&&"object"==typeof a){if(n=e.pdfDocument.cachedPageNumber(a),!n)try{n=(yield e.pdfDocument.getPageIndex(a))+1}catch{return void console.error(`goToDestination: "${a}" is not a valid page reference, for dest="${t}".`)}}else Number.isInteger(a)&&(n=a+1);!n||n<1||n>e.pagesCount?console.error(`goToDestination: "${n}" is not a valid page number, for dest="${t}".`):(e.pdfHistory&&(e.pdfHistory.pushCurrentPosition(),e.pdfHistory.push({namedDest:i,explicitDest:s,pageNumber:n})),e.pdfViewer.scrollPageIntoView({pageNumber:n,destArray:s,ignoreDestinationZoom:e._ignoreDestinationZoom}))})()}goToPage(t){if(!this.pdfDocument)return;const e="string"==typeof t&&this.pdfViewer.pageLabelToPageNumber(t)||0|t;Number.isInteger(e)&&e>0&&e<=this.pagesCount?(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(e)),this.pdfViewer.scrollPageIntoView({pageNumber:e})):console.error(`PDFLinkService.goToPage: "${t}" is not a valid page.`)}addLinkAttributes(t,e,i=!1){if(!e||"string"!=typeof e)throw new Error('A valid "url" parameter must provided.');const s=i?Hn.BLANK:this.externalLinkTarget,n=this.externalLinkRel;this.externalLinkEnabled?t.href=t.title=e:(t.href="",t.title=`Disabled: ${e}`,t.onclick=()=>!1);let a="";switch(s){case Hn.NONE:break;case Hn.SELF:a="_self";break;case Hn.BLANK:a="_blank";break;case Hn.PARENT:a="_parent";break;case Hn.TOP:a="_top"}t.target=a,t.rel="string"==typeof n?n:"noopener noreferrer nofollow"}getDestinationHash(t){if("string"==typeof t){if(t.length>0)return this.getAnchorUrl("#"+escape(t))}else if(Array.isArray(t)){const e=JSON.stringify(t);if(e.length>0)return this.getAnchorUrl("#"+escape(e))}return this.getAnchorUrl("")}getAnchorUrl(t){return this.baseUrl?this.baseUrl+t:t}setHash(t){var s;if(!this.pdfDocument)return;let e,i;if(t.includes("=")){const n=Xu(t);if(n.has("search")){const a=n.get("search").replaceAll('"',""),o="true"===n.get("phrase");this.eventBus.dispatch("findfromurlhash",{source:this,query:o?a:a.match(/\S+/g)})}if(n.has("page")&&(e=0|n.get("page")||1),n.has("zoom")){const a=n.get("zoom").split(","),o=a[0],h=parseFloat(o);o.includes("Fit")?"Fit"===o||"FitB"===o?i=[null,{name:o}]:"FitH"===o||"FitBH"===o||"FitV"===o||"FitBV"===o?i=[null,{name:o},a.length>1?0|a[1]:null]:"FitR"===o?5!==a.length?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):i=[null,{name:o},0|a[1],0|a[2],0|a[3],0|a[4]]:console.error(`PDFLinkService.setHash: "${o}" is not a valid zoom value.`):i=[null,{name:"XYZ"},a.length>1?0|a[1]:null,a.length>2?0|a[2]:null,h?h/100:o]}return i?this.pdfViewer.scrollPageIntoView({pageNumber:e||this.page,destArray:i,allowNegativeOffset:!0}):e&&(this.page=e),n.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:n.get("pagemode")}),void(n.has("nameddest")&&this.goToDestination(n.get("nameddest")))}i=unescape(t);try{i=JSON.parse(i),Array.isArray(i)||(i=i.toString())}catch{}"string"==typeof i||p(s=ub,Xp,b0).call(s,i)?this.goToDestination(i):console.error(`PDFLinkService.setHash: "${unescape(t)}" is not a valid destination.`)}executeNamedAction(t){if(this.pdfDocument){switch(t){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1}this.eventBus.dispatch("namedaction",{source:this,action:t})}}executeSetOCGState(t){var e=this;return(0,I.Z)(function*(){if(!e.pdfDocument)return;const i=e.pdfDocument,s=yield e.pdfViewer.optionalContentConfigPromise;i===e.pdfDocument&&(s.setOCGState(t),e.pdfViewer.optionalContentConfigPromise=Promise.resolve(s))})()}};let Jl=ub;Xp=new WeakSet,b0=function(t){if(!Array.isArray(t)||t.length<2)return!1;const[e,i,...s]=t;if(("object"!=typeof e||!Number.isInteger(e?.num)||!Number.isInteger(e?.gen))&&!Number.isInteger(e)||"object"!=typeof i||"string"!=typeof i?.name)return!1;const n=s.length;let a=!0;switch(i.name){case"XYZ":if(n<2||n>3)return!1;break;case"Fit":case"FitB":return 0===n;case"FitH":case"FitBH":case"FitV":case"FitBV":if(n>1)return!1;break;case"FitR":if(4!==n)return!1;a=!1;break;default:return!1}for(const o of s)if(!("number"==typeof o||a&&null===o))return!1;return!0},f(Jl,Xp);class Wm extends Jl{setDocument(t,e=null){}}const{AbortException:gC,AnnotationEditorLayer:mC,AnnotationEditorType:ue,AnnotationEditorUIManager:bC,AnnotationLayer:_C,AnnotationMode:Hi,createValidAbsoluteUrl:AC,DrawLayer:yC,fetchData:ay,getPdfFilenameFromUrl:vC,isPdfFile:wC,normalizeUnicode:EC,PermissionFlag:Qu,PixelsPerInch:Vi,RenderingCancelledException:Gm,setLayerDimensions:xC,shadow:tf,TextLayer:CC,version:oy,XfaLayer:$m}=globalThis.pdfjsLib;class ly{constructor({pdfPage:t,linkService:e,downloadManager:i,annotationStorage:s=null,imageResourcesPath:n="",renderForms:a=!0,enableScripting:o=!1,hasJSActionsPromise:h=null,fieldObjectsPromise:c=null,annotationCanvasMap:d=null,accessibilityManager:u=null,annotationEditorUIManager:g=null,onAppend:b=null}){f(this,yd),f(this,Ad,null),f(this,un,null),this.pdfPage=t,this.linkService=e,this.downloadManager=i,this.imageResourcesPath=n,this.renderForms=a,this.annotationStorage=s,this.enableScripting=o,this._hasJSActionsPromise=h||Promise.resolve(!1),this._fieldObjectsPromise=c||Promise.resolve(null),this._annotationCanvasMap=d,this._accessibilityManager=u,this._annotationEditorUIManager=g,m(this,Ad,b),this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=e.eventBus}render(t,e="display"){var i=this;return(0,I.Z)(function*(){var h,c;if(i.div){if(i._cancelled||!i.annotationLayer)return;return void i.annotationLayer.update({viewport:t.clone({dontFlip:!0})})}const[s,n,a]=yield Promise.all([i.pdfPage.getAnnotations({intent:e}),i._hasJSActionsPromise,i._fieldObjectsPromise]);if(i._cancelled)return;const o=i.div=document.createElement("div");o.className="annotationLayer",null==(h=r(i,Ad))||h.call(i,o),0!==s.length?(i.annotationLayer=new _C({div:o,accessibilityManager:i._accessibilityManager,annotationCanvasMap:i._annotationCanvasMap,annotationEditorUIManager:i._annotationEditorUIManager,page:i.pdfPage,viewport:t.clone({dontFlip:!0})}),yield i.annotationLayer.render({annotations:s,imageResourcesPath:i.imageResourcesPath,renderForms:i.renderForms,linkService:i.linkService,downloadManager:i.downloadManager,annotationStorage:i.annotationStorage,enableScripting:i.enableScripting,hasJSActions:n,fieldObjects:a}),i.linkService.isInPresentationMode&&p(c=i,yd,w_).call(c,3),r(i,un)||(m(i,un,new AbortController),i._eventBus?._on("presentationmodechanged",d=>{var u;p(u=i,yd,w_).call(u,d.state)},{signal:r(i,un).signal}))):i.hide()})()}cancel(){this._cancelled=!0,r(this,un)?.abort(),m(this,un,null)}hide(){!this.div||(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}}function hy(l,t){const e=document.createElement("a");if(!e.click)throw new Error('DownloadManager: "a.click()" is not supported.');e.href=l,e.target="_parent","download"in e&&(e.download=t),(document.body||document.documentElement).append(e),e.click(),e.remove()}Ad=new WeakMap,un=new WeakMap,yd=new WeakSet,w_=function(t){if(!this.div)return;let e=!1;switch(t){case 3:e=!0;break;case 1:break;default:return}for(const i of this.div.childNodes)i.hasAttribute("data-internal-link")||(i.inert=e)};class SC{constructor(){f(this,fb,new WeakMap)}downloadData(t,e,i){hy(URL.createObjectURL(new Blob([t],{type:i})),e)}openOrDownloadData(t,e,i=null){const n=wC(e)?"application/pdf":"";return this.downloadData(t,e,n),!1}download(t,e,i){let s;if(t)s=URL.createObjectURL(new Blob([t],{type:"application/pdf"}));else{if(!AC(e,"http://example.com"))return void console.error(`download - not a valid URL: ${e}`);s=e+"#pdfjs.action=download"}hy(s,i)}}fb=new WeakMap;function qm(){return(qm=(0,I.Z)(function*({target:l,name:t,delay:e=0}){if("object"!=typeof l||!t||"string"!=typeof t||!(Number.isInteger(e)&&e>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");const{promise:i,resolve:s}=Promise.withResolvers(),n=new AbortController;function a(c){n.abort(),clearTimeout(h),s(c)}l[l instanceof dy?"_on":"addEventListener"](t,a.bind(null,"event"),{signal:n.signal});const h=setTimeout(a.bind(null,"timeout"),e);return i})).apply(this,arguments)}class dy{constructor(){f(this,rl,Object.create(null))}on(t,e,i=null){this._on(t,e,{external:!0,once:i?.once,signal:i?.signal})}off(t,e,i=null){this._off(t,e)}dispatch(t,e){const i=r(this,rl)[t];if(!i||0===i.length)return;let s;for(const{listener:n,external:a,once:o}of i.slice(0))o&&this._off(t,n),a?(s||(s=[])).push(n):n(e);if(s){for(const n of s)n(e);s=null}}_on(t,e,i=null){var a;let s=null;if(i?.signal instanceof AbortSignal){const{signal:o}=i;if(o.aborted)return void console.error("Cannot use an `aborted` signal.");const h=()=>this._off(t,e);s=()=>o.removeEventListener("abort",h),o.addEventListener("abort",h)}((a=r(this,rl))[t]||(a[t]=[])).push({listener:e,external:!0===i?.external,once:!0===i?.once,rmAbort:s})}_off(t,e,i=null){const s=r(this,rl)[t];if(s)for(let n=0,a=s.length;n<a;n++){const o=s[n];if(o.listener===e)return o.rmAbort?.(),void s.splice(n,1)}}}rl=new WeakMap,new WeakMap,new WeakMap,new WeakMap;class ef{constructor(t){this.value=t}valueOf(){return this.value}}class At extends ef{constructor(t="???"){super(t)}toString(t){return`{${this.value}}`}}class ji extends ef{constructor(t,e={}){super(t),this.opts=e}toString(t){try{return t.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(e){return t.reportError(e),this.value.toString(10)}}}class Ql extends ef{constructor(t,e={}){super(t),this.opts=e}toString(t){try{return t.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(e){return t.reportError(e),new Date(this.value).toISOString()}}}function LC(l,t,e){return e===t||e instanceof ji&&t instanceof ji&&e.value===t.value||t instanceof ji&&"string"==typeof e&&e===l.memoizeIntlObject(Intl.PluralRules,t.opts).select(t.value)}function fy(l,t,e){return t[e]?Ma(l,t[e].value):(l.reportError(new RangeError("No default")),new At)}function Km(l,t){const e=[],i=Object.create(null);for(const s of t)"narg"===s.type?i[s.name]=th(l,s.value):e.push(th(l,s));return{positional:e,named:i}}function th(l,t){switch(t.type){case"str":return t.value;case"num":return new ji(t.value,{minimumFractionDigits:t.precision});case"var":return function kC(l,{name:t}){let e;if(l.params){if(!Object.prototype.hasOwnProperty.call(l.params,t))return new At(`$${t}`);e=l.params[t]}else{if(!l.args||!Object.prototype.hasOwnProperty.call(l.args,t))return l.reportError(new ReferenceError(`Unknown variable: $${t}`)),new At(`$${t}`);e=l.args[t]}if(e instanceof ef)return e;switch(typeof e){case"string":return e;case"number":return new ji(e);case"object":if(e instanceof Date)return new Ql(e.getTime());default:return l.reportError(new TypeError(`Variable type not supported: $${t}, ${typeof e}`)),new At(`$${t}`)}}(l,t);case"mesg":return function RC(l,{name:t,attr:e}){const i=l.bundle._messages.get(t);if(!i)return l.reportError(new ReferenceError(`Unknown message: ${t}`)),new At(t);if(e){const s=i.attributes[e];return s?Ma(l,s):(l.reportError(new ReferenceError(`Unknown attribute: ${e}`)),new At(`${t}.${e}`))}return i.value?Ma(l,i.value):(l.reportError(new ReferenceError(`No value: ${t}`)),new At(t))}(l,t);case"term":return function IC(l,{name:t,attr:e,args:i}){const s=`-${t}`,n=l.bundle._terms.get(s);if(!n)return l.reportError(new ReferenceError(`Unknown term: ${s}`)),new At(s);if(e){const o=n.attributes[e];if(o){l.params=Km(l,i).named;const h=Ma(l,o);return l.params=null,h}return l.reportError(new ReferenceError(`Unknown attribute: ${e}`)),new At(`${s}.${e}`)}l.params=Km(l,i).named;const a=Ma(l,n.value);return l.params=null,a}(l,t);case"func":return function DC(l,{name:t,args:e}){let i=l.bundle._functions[t];if(!i)return l.reportError(new ReferenceError(`Unknown function: ${t}()`)),new At(`${t}()`);if("function"!=typeof i)return l.reportError(new TypeError(`Function ${t}() is not callable`)),new At(`${t}()`);try{let s=Km(l,e);return i(s.positional,s.named)}catch(s){return l.reportError(s),new At(`${t}()`)}}(l,t);case"select":return function OC(l,{selector:t,variants:e,star:i}){let s=th(l,t);if(s instanceof At)return fy(l,e,i);for(const n of e)if(LC(l,s,th(l,n.key)))return Ma(l,n.value);return fy(l,e,i)}(l,t);default:return new At}}function py(l,t){if(l.dirty.has(t))return l.reportError(new RangeError("Cyclic reference")),new At;l.dirty.add(t);const e=[],i=l.bundle._useIsolating&&t.length>1;for(const s of t)if("string"!=typeof s){if(l.placeables++,l.placeables>100)throw l.dirty.delete(t),new RangeError(`Too many placeables expanded: ${l.placeables}, max allowed is 100`);i&&e.push("\u2068"),e.push(th(l,s).toString(l)),i&&e.push("\u2069")}else e.push(l.bundle._transform(s));return l.dirty.delete(t),e.join("")}function Ma(l,t){return"string"==typeof t?l.bundle._transform(t):py(l,t)}class FC{constructor(t,e,i){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=t,this.errors=e,this.args=i}reportError(t){if(!(this.errors&&t instanceof Error))throw t;this.errors.push(t)}memoizeIntlObject(t,e){let i=this.bundle._intls.get(t);i||(i={},this.bundle._intls.set(t,i));let s=JSON.stringify(e);return i[s]||(i[s]=new t(this.bundle.locales,e)),i[s]}}function sf(l,t){const e=Object.create(null);for(const[i,s]of Object.entries(l))t.includes(i)&&(e[i]=s.valueOf());return e}const gy=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function NC(l,t){let e=l[0];if(e instanceof At)return new At(`NUMBER(${e.valueOf()})`);if(e instanceof ji)return new ji(e.valueOf(),{...e.opts,...sf(t,gy)});if(e instanceof Ql)return new ji(e.valueOf(),{...sf(t,gy)});throw new TypeError("Invalid argument to NUMBER")}const my=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function BC(l,t){let e=l[0];if(e instanceof At)return new At(`DATETIME(${e.valueOf()})`);if(e instanceof Ql)return new Ql(e.valueOf(),{...e.opts,...sf(t,my)});if(e instanceof ji)return new Ql(e.valueOf(),{...sf(t,my)});throw new TypeError("Invalid argument to DATETIME")}const by=new Map;class VC{constructor(t,{functions:e,useIsolating:i=!0,transform:s=(n=>n)}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(t)?t:[t],this._functions={NUMBER:NC,DATETIME:BC,...e},this._useIsolating=i,this._transform=s,this._intls=function HC(l){const t=Array.isArray(l)?l.join(" "):l;let e=by.get(t);return void 0===e&&(e=new Map,by.set(t,e)),e}(t)}hasMessage(t){return this._messages.has(t)}getMessage(t){return this._messages.get(t)}addResource(t,{allowOverrides:e=!1}={}){const i=[];for(let s=0;s<t.body.length;s++){let n=t.body[s];if(n.id.startsWith("-")){if(!1===e&&this._terms.has(n.id)){i.push(new Error(`Attempt to override an existing term: "${n.id}"`));continue}this._terms.set(n.id,n)}else{if(!1===e&&this._messages.has(n.id)){i.push(new Error(`Attempt to override an existing message: "${n.id}"`));continue}this._messages.set(n.id,n)}}return i}formatPattern(t,e=null,i=null){if("string"==typeof t)return this._transform(t);let s=new FC(this,i,e);try{return py(s,t).toString(s)}catch(n){if(s.errors&&n instanceof Error)return s.errors.push(n),(new At).toString(s);throw n}}}const Xm=/^(-?[a-zA-Z][\w-]*) *= */gm,_y=/\.([a-zA-Z][\w-]*) *= */y,jC=/\*?\[/y,Ym=/(-?[0-9]+(?:\.([0-9]+))?)/y,UC=/([a-zA-Z][\w-]*)/y,Ay=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,zC=/^[A-Z][A-Z0-9_-]*$/,nf=/([^{}\n\r]+)/y,WC=/([^\\"\n\r]*)/y,yy=/\\([\\"])/y,vy=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,GC=/^\n+/,wy=/ +$/,$C=/ *\r?\n/g,qC=/( *)$/,KC=/{\s*/y,Ey=/\s*}/y,XC=/\[\s*/y,YC=/\s*] */y,ZC=/\s*\(\s*/y,JC=/\s*->\s*/y,QC=/\s*:\s*/y,tS=/\s*,?\s*/y,eS=/\s+/y;class iS{constructor(t){this.body=[],Xm.lastIndex=0;let e=0;for(;;){let w=Xm.exec(t);if(null===w)break;e=Xm.lastIndex;try{this.body.push(h(w[1]))}catch(T){if(T instanceof SyntaxError)continue;throw T}}function i(w){return w.lastIndex=e,w.test(t)}function s(w,T){if(t[e]===w)return e++,!0;if(T)throw new T(`Expected ${w}`);return!1}function n(w,T){if(i(w))return e=w.lastIndex,!0;if(T)throw new T(`Expected ${w.toString()}`);return!1}function a(w){w.lastIndex=e;let T=w.exec(t);if(null===T)throw new SyntaxError(`Expected ${w.toString()}`);return e=w.lastIndex,T}function o(w){return a(w)[1]}function h(w){let T=d(),D=function c(){let w=Object.create(null);for(;i(_y);){let T=o(_y),D=d();if(null===D)throw new SyntaxError("Expected attribute value");w[T]=D}return w}();if(null===T&&0===Object.keys(D).length)throw new SyntaxError("Expected message value or attributes");return{id:w,value:T,attributes:D}}function d(){let w;if(i(nf)&&(w=o(nf)),"{"===t[e]||"}"===t[e])return u(w?[w]:[],1/0);let T=P();return T?w?u([w,T],T.length):(T.value=L(T.value,GC),u([T],T.length)):w?L(w,wy):null}function u(w=[],T){for(;;){if(i(nf)){w.push(o(nf));continue}if("{"===t[e]){w.push(g());continue}if("}"===t[e])throw new SyntaxError("Unbalanced closing brace");let W=P();if(!W)break;w.push(W),T=Math.min(T,W.length)}let D=w.length-1,$=w[D];"string"==typeof $&&(w[D]=L($,wy));let j=[];for(let W of w)W instanceof xy&&(W=W.value.slice(0,W.value.length-T)),W&&j.push(W);return j}function g(){n(KC,SyntaxError);let w=b();if(n(Ey))return w;if(n(JC)){let T=function v(){let D,w=[],T=0;for(;i(jC);){s("*")&&(D=T);let $=y(),j=d();if(null===j)throw new SyntaxError("Expected variant value");w[T++]={key:$,value:j}}if(0===T)return null;if(void 0===D)throw new SyntaxError("Expected default variant");return{variants:w,star:D}}();return n(Ey,SyntaxError),{type:"select",selector:w,...T}}throw new SyntaxError("Unclosed placeable")}function b(){if("{"===t[e])return g();if(i(Ay)){let[,w,T,D=null]=a(Ay);if("$"===w)return{type:"var",name:T};if(n(ZC)){let $=function _(){let w=[];for(;;){switch(t[e]){case")":return e++,w;case void 0:throw new SyntaxError("Unclosed argument list")}w.push(A()),n(tS)}}();if("-"===w)return{type:"term",name:T,attr:D,args:$};if(zC.test(T))return{type:"func",name:T,args:$};throw new SyntaxError("Function names must be all upper-case")}return"-"===w?{type:"term",name:T,attr:D,args:[]}:{type:"mesg",name:T,attr:D}}return E()}function A(){let w=b();return"mesg"!==w.type?w:n(QC)?{type:"narg",name:w.name,value:E()}:w}function y(){let w;return n(XC,SyntaxError),w=i(Ym)?x():{type:"str",value:o(UC)},n(YC,SyntaxError),w}function E(){if(i(Ym))return x();if('"'===t[e])return function C(){s('"',SyntaxError);let w="";for(;;){if(w+=o(WC),"\\"!==t[e]){if(s('"'))return{type:"str",value:w};throw new SyntaxError("Unclosed string literal")}w+=S()}}();throw new SyntaxError("Invalid expression")}function x(){let[,w,T=""]=a(Ym),D=T.length;return{type:"num",value:parseFloat(w),precision:D}}function S(){if(i(yy))return o(yy);if(i(vy)){let[,w,T]=a(vy),D=parseInt(w||T,16);return D<=55295||57344<=D?String.fromCodePoint(D):"\ufffd"}throw new SyntaxError("Unknown escape sequence")}function P(){let w=e;switch(n(eS),t[e]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return k(t.slice(w,e))}return" "===t[e-1]&&k(t.slice(w,e))}function L(w,T){return w.replace(T,"")}function k(w){let T=w.replace($C,"\n"),D=qC.exec(w)[1].length;return new xy(T,D)}}}class xy{constructor(t,e){this.value=t,this.length=e}}const sS=/<|&#?\w+;/,nS={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},rS={"http://www.w3.org/1999/xhtml":{global:["title","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function aS(l,t){const{value:e}=t;if("string"==typeof e)if("title"===l.localName&&"http://www.w3.org/1999/xhtml"===l.namespaceURI)l.textContent=e;else if(sS.test(e)){const i=l.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");i.innerHTML=e,function oS(l,t){for(const e of l.childNodes)if(e.nodeType!==e.TEXT_NODE){if(e.hasAttribute("data-l10n-name")){const i=hS(t,e);l.replaceChild(i,e);continue}if(dS(e)){const i=cS(e);l.replaceChild(i,e);continue}console.warn(`An element of forbidden type "${e.localName}" was found in the translation. Only safe text-level elements and elements with data-l10n-name are allowed.`),l.replaceChild(Zm(e),e)}t.textContent="",t.appendChild(l)}(i.content,l)}else l.textContent=e;Cy(t,l)}function lS(l,t){if(!l)return!1;for(let e of l)if(e.name===t)return!0;return!1}function Cy(l,t){const e=t.hasAttribute("data-l10n-attrs")?t.getAttribute("data-l10n-attrs").split(",").map(i=>i.trim()):null;for(const i of Array.from(t.attributes))Sy(i.name,t,e)&&!lS(l.attributes,i.name)&&t.removeAttribute(i.name);if(l.attributes)for(const i of Array.from(l.attributes))Sy(i.name,t,e)&&t.getAttribute(i.name)!==i.value&&t.setAttribute(i.name,i.value)}function hS(l,t){const e=t.getAttribute("data-l10n-name"),i=l.querySelector(`[data-l10n-name="${e}"]`);return i?i.localName!==t.localName?(console.warn(`An element named "${e}" was found in the translation but its type ${t.localName} didn't match the element found in the source (${i.localName}).`),Zm(t)):(l.removeChild(i),Py(t,i.cloneNode(!1))):(console.warn(`An element named "${e}" wasn't found in the source.`),Zm(t))}function cS(l){const t=l.ownerDocument.createElement(l.localName);return Py(l,t)}function Zm(l){return l.ownerDocument.createTextNode(l.textContent)}function dS(l){const t=nS[l.namespaceURI];return t&&t.includes(l.localName)}function Sy(l,t,e=null){if(e&&e.includes(l))return!0;const i=rS[t.namespaceURI];if(!i)return!1;const s=l.toLowerCase(),n=t.localName;if(i.global.includes(s))return!0;if(!i[n])return!1;if(i[n].includes(s))return!0;if("http://www.w3.org/1999/xhtml"===t.namespaceURI&&"input"===n&&"value"===s){const a=t.type.toLowerCase();if("submit"===a||"button"===a||"reset"===a)return!0}return!1}function Py(l,t){return t.textContent=l.textContent,Cy(l,t),t}class uS extends Array{static from(t){return t instanceof this?t:new this(t)}}Symbol;class fS extends uS{constructor(t){if(super(),Symbol.asyncIterator in Object(t))this.iterator=t[Symbol.asyncIterator]();else{if(!(Symbol.iterator in Object(t)))throw new TypeError("Argument must implement the iteration protocol.");this.iterator=t[Symbol.iterator]()}}[Symbol.asyncIterator](){const t=this;let e=0;return{next:()=>(0,I.Z)(function*(){return t.length<=e&&t.push(t.iterator.next()),t[e++]})()}}touchNext(t=1){var e=this;return(0,I.Z)(function*(){let i=0;for(;i++<t;){const s=e[e.length-1];if(s&&(yield s).done)break;e.push(e.iterator.next())}return e[e.length-1]})()}}function gS(l,t,e,i){return e.value?l.formatPattern(e.value,i,t):null}function mS(l,t,e,i){const s={value:null,attributes:null};e.value&&(s.value=l.formatPattern(e.value,i,t));let n=Object.keys(e.attributes);if(n.length>0){s.attributes=new Array(n.length);for(let[a,o]of n.entries()){let h=l.formatPattern(e.attributes[o],i,t);s.attributes[a]={name:o,value:h}}}return s}function bS(l,t,e,i){const s=[],n=new Set;return e.forEach(({id:a,args:o},h)=>{if(void 0!==i[h])return;let c=t.getMessage(a);if(c){if(s.length=0,i[h]=l(t,s,c,o),s.length>0&&typeof console<"u"){const d=t.locales[0],u=s.join(", ");console.warn(`[fluent][resolver] errors in ${d}/${a}: ${u}.`)}}else n.add(a)}),n}const Vn="data-l10n-id",eh="data-l10n-args",_S=`[${Vn}]`;class AS extends class pS{constructor(t=[],e){this.resourceIds=t,this.generateBundles=e,this.onChange(!0)}addResourceIds(t,e=!1){return this.resourceIds.push(...t),this.onChange(e),this.resourceIds.length}removeResourceIds(t){return this.resourceIds=this.resourceIds.filter(e=>!t.includes(e)),this.onChange(),this.resourceIds.length}formatWithFallback(t,e){var i=this;return(0,I.Z)(function*(){const s=[];let n=!1;var h,a=!1,o=!1;try{for(var d,c=function Lx(l){var t,e,i,s=2;for(typeof Symbol<"u"&&(e=Symbol.asyncIterator,i=Symbol.iterator);s--;){if(e&&null!=(t=l[e]))return t.call(l);if(i&&null!=(t=l[i]))return new Ku(t.call(l));e="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(i.bundles);a=!(d=yield c.next()).done;a=!1){const u=d.value;n=!0;const g=bS(e,u,t,s);if(0===g.size)break;if(typeof console<"u"){const b=u.locales[0],_=Array.from(g).join(", ");console.warn(`[fluent] Missing translations in ${b}: ${_}`)}}}catch(u){o=!0,h=u}finally{try{a&&null!=c.return&&(yield c.return())}finally{if(o)throw h}}return!n&&typeof console<"u"&&console.warn(`[fluent] Request for keys failed because no resource bundles got generated.\n  keys: ${JSON.stringify(t)}.\n  resourceIds: ${JSON.stringify(i.resourceIds)}.`),s})()}formatMessages(t){return this.formatWithFallback(t,mS)}formatValues(t){return this.formatWithFallback(t,gS)}formatValue(t,e){var i=this;return(0,I.Z)(function*(){const[s]=yield i.formatValues([{id:t,args:e}]);return s})()}handleEvent(){this.onChange()}onChange(t=!1){this.bundles=fS.from(this.generateBundles(this.resourceIds)),t&&this.bundles.touchNext(2)}}{constructor(t,e){super(t,e),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[Vn,eh]}}onChange(t=!1){super.onChange(t),this.roots&&this.translateRoots()}setAttributes(t,e,i){return t.setAttribute(Vn,e),i?t.setAttribute(eh,JSON.stringify(i)):t.removeAttribute(eh),t}getAttributes(t){return{id:t.getAttribute(Vn),args:JSON.parse(t.getAttribute(eh)||null)}}connectRoot(t){for(const e of this.roots)if(e===t||e.contains(t)||t.contains(e))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==t.ownerDocument.defaultView)throw new Error("Cannot connect a root:\n          DOMLocalization already has a root from a different window.")}else this.windowElement=t.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver(e=>this.translateMutations(e));this.roots.add(t),this.mutationObserver.observe(t,this.observerConfig)}disconnectRoot(t){return this.roots.delete(t),this.pauseObserving(),0===this.roots.size?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){const t=Array.from(this.roots);return Promise.all(t.map(e=>this.translateFragment(e)))}pauseObserving(){!this.mutationObserver||(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(const t of this.roots)this.mutationObserver.observe(t,this.observerConfig)}translateMutations(t){for(const e of t)switch(e.type){case"attributes":e.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(e.target);break;case"childList":for(const i of e.addedNodes)if(i.nodeType===i.ELEMENT_NODE)if(i.childElementCount)for(const s of this.getTranslatables(i))this.pendingElements.add(s);else i.hasAttribute(Vn)&&this.pendingElements.add(i)}this.pendingElements.size>0&&null===this.pendingrAF&&(this.pendingrAF=this.windowElement.requestAnimationFrame(()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null}))}translateFragment(t){return this.translateElements(this.getTranslatables(t))}translateElements(t){var e=this;return(0,I.Z)(function*(){if(!t.length)return;const i=t.map(e.getKeysForElement),s=yield e.formatMessages(i);return e.applyTranslations(t,s)})()}applyTranslations(t,e){this.pauseObserving();for(let i=0;i<t.length;i++)void 0!==e[i]&&aS(t[i],e[i]);this.resumeObserving()}getTranslatables(t){const e=Array.from(t.querySelectorAll(_S));return"function"==typeof t.hasAttribute&&t.hasAttribute(Vn)&&e.push(t),e}getKeysForElement(t){return{id:t.getAttribute(Vn),args:JSON.parse(t.getAttribute(eh)||null)}}}const eg=class{constructor({lang:t,isRTL:e},i=null){var s,n;f(this,vd,void 0),f(this,al,new Set),f(this,ol,void 0),f(this,le,void 0),m(this,ol,p(s=eg,Qp,_0).call(s,t)),m(this,le,i),m(this,vd,e??p(n=eg,tg,A0).call(n,r(this,ol))?"rtl":"ltr")}_setL10n(t){m(this,le,t)}getLanguage(){return r(this,ol)}getDirection(){return r(this,vd)}get(t,e=null,i){var s=this;return(0,I.Z)(function*(){return Array.isArray(t)?(t=t.map(o=>({id:o})),(yield r(s,le).formatMessages(t)).map(o=>o.value)):(yield r(s,le).formatMessages([{id:t,args:e}]))[0]?.value||i})()}translate(t){var e=this;return(0,I.Z)(function*(){r(e,al).add(t);try{r(e,le).connectRoot(t),yield r(e,le).translateRoots()}catch{}})()}translateOnce(t){var e=this;return(0,I.Z)(function*(){try{yield r(e,le).translateElements([t])}catch(i){console.error(`translateOnce: "${i}".`)}})()}destroy(){var t=this;return(0,I.Z)(function*(){for(const e of r(t,al))r(t,le).disconnectRoot(e);r(t,al).clear(),r(t,le).pauseObserving()})()}pause(){r(this,le).pauseObserving()}resume(){r(this,le).resumeObserving()}};let ih=eg;function Ty(l,t){const e=new iS(t),i=new VC(l),s=i.addResource(e);return s.length&&console.error("L10n errors",s),i}vd=new WeakMap,al=new WeakMap,ol=new WeakMap,le=new WeakMap,Qp=new WeakSet,_0=function(t){return{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[t=t?.toLowerCase()||"en-us"]||t},tg=new WeakSet,A0=function(t){const e=t.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(e)},f(ih,Qp),f(ih,tg);const ll=class extends ih{constructor(t){super({lang:t});const e=t?p(ll,ig,y0).bind(ll,"en-us",this.getLanguage()):p(ll,rg,E0).bind(ll,this.getLanguage());this._setL10n(new AS([],e))}};let Be=ll;function Qm(){return document.location.hash}ig=new WeakSet,y0=function(t,e){var i=this;return WA(function*(){var o,h,c;const{baseURL:s,paths:n}=yield zA(p(o=i,ng,w0).call(o)),a=[e];if(t!==e){const d=e.split("-",1)[0];d!==e&&a.push(d),a.push(t)}for(const d of a){const u=yield zA(p(h=i,sg,v0).call(h,d,s,n));u?yield u:"en-us"===d&&(yield p(c=i,wd,E_).call(c,d))}})()},sg=new WeakSet,v0=function(t,e,i){return(0,I.Z)(function*(){const s=i[t];if(!s)return null;const n=new URL(s,e),a=yield ay(n,"text");return Ty(t,a)})()},ng=new WeakSet,w0=function(){return(0,I.Z)(function*(){try{const{href:t}=document.querySelector('link[type="application/l10n"]'),e=yield ay(t,"json");return{baseURL:t.replace(/[^/]*$/,"")||"./",paths:e}}catch{}return{baseURL:"./",paths:Object.create(null)}})()},rg=new WeakSet,E0=function(t){var e=this;return WA(function*(){var i;yield p(i=e,wd,E_).call(i,t)})()},wd=new WeakSet,E_=function(t){return(0,I.Z)(function*(){return Ty(t,'pdfjs-previous-button =\n    .title = Previous Page\npdfjs-previous-button-label = Previous\npdfjs-next-button =\n    .title = Next Page\npdfjs-next-button-label = Next\npdfjs-page-input =\n    .title = Page\npdfjs-of-pages = of { $pagesCount }\npdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })\npdfjs-zoom-out-button =\n    .title = Zoom Out\npdfjs-zoom-out-button-label = Zoom Out\npdfjs-zoom-in-button =\n    .title = Zoom In\npdfjs-zoom-in-button-label = Zoom In\npdfjs-zoom-select =\n    .title = Zoom\npdfjs-presentation-mode-button =\n    .title = Switch to Presentation Mode\npdfjs-presentation-mode-button-label = Presentation Mode\npdfjs-open-file-button =\n    .title = Open File\npdfjs-open-file-button-label = Open\npdfjs-print-button =\n    .title = Print\npdfjs-print-button-label = Print\npdfjs-save-button =\n    .title = Save\npdfjs-save-button-label = Save\npdfjs-download-button =\n    .title = Download\npdfjs-download-button-label = Download\npdfjs-bookmark-button =\n    .title = Current Page (View URL from Current Page)\npdfjs-bookmark-button-label = Current Page\npdfjs-tools-button =\n    .title = Tools\npdfjs-tools-button-label = Tools\npdfjs-first-page-button =\n    .title = Go to First Page\npdfjs-first-page-button-label = Go to First Page\npdfjs-last-page-button =\n    .title = Go to Last Page\npdfjs-last-page-button-label = Go to Last Page\npdfjs-page-rotate-cw-button =\n    .title = Rotate Clockwise\npdfjs-page-rotate-cw-button-label = Rotate Clockwise\npdfjs-page-rotate-ccw-button =\n    .title = Rotate Counterclockwise\npdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise\npdfjs-cursor-text-select-tool-button =\n    .title = Enable Text Selection Tool\npdfjs-cursor-text-select-tool-button-label = Text Selection Tool\npdfjs-cursor-hand-tool-button =\n    .title = Enable Hand Tool\npdfjs-cursor-hand-tool-button-label = Hand Tool\npdfjs-scroll-page-button =\n    .title = Use Page Scrolling\npdfjs-scroll-page-button-label = Page Scrolling\npdfjs-scroll-vertical-button =\n    .title = Use Vertical Scrolling\npdfjs-scroll-vertical-button-label = Vertical Scrolling\npdfjs-scroll-horizontal-button =\n    .title = Use Horizontal Scrolling\npdfjs-scroll-horizontal-button-label = Horizontal Scrolling\npdfjs-scroll-wrapped-button =\n    .title = Use Wrapped Scrolling\npdfjs-scroll-wrapped-button-label = Wrapped Scrolling\npdfjs-spread-none-button =\n    .title = Do not join page spreads\npdfjs-spread-none-button-label = No Spreads\npdfjs-spread-odd-button =\n    .title = Join page spreads starting with odd-numbered pages\npdfjs-spread-odd-button-label = Odd Spreads\npdfjs-spread-even-button =\n    .title = Join page spreads starting with even-numbered pages\npdfjs-spread-even-button-label = Even Spreads\npdfjs-document-properties-button =\n    .title = Document Properties\u2026\npdfjs-document-properties-button-label = Document Properties\u2026\npdfjs-document-properties-file-name = File name:\npdfjs-document-properties-file-size = File size:\npdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)\npdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)\npdfjs-document-properties-title = Title:\npdfjs-document-properties-author = Author:\npdfjs-document-properties-subject = Subject:\npdfjs-document-properties-keywords = Keywords:\npdfjs-document-properties-creation-date = Creation Date:\npdfjs-document-properties-modification-date = Modification Date:\npdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }\npdfjs-document-properties-creator = Creator:\npdfjs-document-properties-producer = PDF Producer:\npdfjs-document-properties-version = PDF Version:\npdfjs-document-properties-page-count = Page Count:\npdfjs-document-properties-page-size = Page Size:\npdfjs-document-properties-page-size-unit-inches = in\npdfjs-document-properties-page-size-unit-millimeters = mm\npdfjs-document-properties-page-size-orientation-portrait = portrait\npdfjs-document-properties-page-size-orientation-landscape = landscape\npdfjs-document-properties-page-size-name-a-three = A3\npdfjs-document-properties-page-size-name-a-four = A4\npdfjs-document-properties-page-size-name-letter = Letter\npdfjs-document-properties-page-size-name-legal = Legal\npdfjs-document-properties-page-size-dimension-string = { $width } \xd7 { $height } { $unit } ({ $orientation })\npdfjs-document-properties-page-size-dimension-name-string = { $width } \xd7 { $height } { $unit } ({ $name }, { $orientation })\npdfjs-document-properties-linearized = Fast Web View:\npdfjs-document-properties-linearized-yes = Yes\npdfjs-document-properties-linearized-no = No\npdfjs-document-properties-close-button = Close\npdfjs-print-progress-message = Preparing document for printing\u2026\npdfjs-print-progress-percent = { $progress }%\npdfjs-print-progress-close-button = Cancel\npdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.\npdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.\npdfjs-toggle-sidebar-button =\n    .title = Toggle Sidebar\npdfjs-toggle-sidebar-notification-button =\n    .title = Toggle Sidebar (document contains outline/attachments/layers)\npdfjs-toggle-sidebar-button-label = Toggle Sidebar\npdfjs-document-outline-button =\n    .title = Show Document Outline (double-click to expand/collapse all items)\npdfjs-document-outline-button-label = Document Outline\npdfjs-attachments-button =\n    .title = Show Attachments\npdfjs-attachments-button-label = Attachments\npdfjs-layers-button =\n    .title = Show Layers (double-click to reset all layers to the default state)\npdfjs-layers-button-label = Layers\npdfjs-thumbs-button =\n    .title = Show Thumbnails\npdfjs-thumbs-button-label = Thumbnails\npdfjs-current-outline-item-button =\n    .title = Find Current Outline Item\npdfjs-current-outline-item-button-label = Current Outline Item\npdfjs-findbar-button =\n    .title = Find in Document\npdfjs-findbar-button-label = Find\npdfjs-additional-layers = Additional Layers\npdfjs-thumb-page-title =\n    .title = Page { $page }\npdfjs-thumb-page-canvas =\n    .aria-label = Thumbnail of Page { $page }\npdfjs-find-input =\n    .title = Find\n    .placeholder = Find in document\u2026\npdfjs-find-previous-button =\n    .title = Find the previous occurrence of the phrase\npdfjs-find-previous-button-label = Previous\npdfjs-find-next-button =\n    .title = Find the next occurrence of the phrase\npdfjs-find-next-button-label = Next\npdfjs-find-highlight-checkbox = Highlight All\npdfjs-find-match-case-checkbox-label = Match Case\npdfjs-find-match-diacritics-checkbox-label = Match Diacritics\npdfjs-find-entire-word-checkbox-label = Whole Words\npdfjs-find-reached-top = Reached top of document, continued from bottom\npdfjs-find-reached-bottom = Reached end of document, continued from top\npdfjs-find-match-count =\n    { $total ->\n        [one] { $current } of { $total } match\n       *[other] { $current } of { $total } matches\n    }\npdfjs-find-match-count-limit =\n    { $limit ->\n        [one] More than { $limit } match\n       *[other] More than { $limit } matches\n    }\npdfjs-find-not-found = Phrase not found\npdfjs-page-scale-width = Page Width\npdfjs-page-scale-fit = Page Fit\npdfjs-page-scale-auto = Automatic Zoom\npdfjs-page-scale-actual = Actual Size\npdfjs-page-scale-percent = { $scale }%\npdfjs-page-landmark =\n    .aria-label = Page { $page }\npdfjs-loading-error = An error occurred while loading the PDF.\npdfjs-invalid-file-error = Invalid or corrupted PDF file.\npdfjs-missing-file-error = Missing PDF file.\npdfjs-unexpected-response-error = Unexpected server response.\npdfjs-rendering-error = An error occurred while rendering the page.\npdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }\npdfjs-text-annotation-type =\n    .alt = [{ $type } Annotation]\npdfjs-password-label = Enter the password to open this PDF file.\npdfjs-password-invalid = Invalid password. Please try again.\npdfjs-password-ok-button = OK\npdfjs-password-cancel-button = Cancel\npdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.\npdfjs-editor-free-text-button =\n    .title = Text\npdfjs-editor-free-text-button-label = Text\npdfjs-editor-ink-button =\n    .title = Draw\npdfjs-editor-ink-button-label = Draw\npdfjs-editor-stamp-button =\n    .title = Add or edit images\npdfjs-editor-stamp-button-label = Add or edit images\npdfjs-editor-highlight-button =\n    .title = Highlight\npdfjs-editor-highlight-button-label = Highlight\npdfjs-highlight-floating-button1 =\n    .title = Highlight\n    .aria-label = Highlight\npdfjs-highlight-floating-button-label = Highlight\npdfjs-editor-remove-ink-button =\n    .title = Remove drawing\npdfjs-editor-remove-freetext-button =\n    .title = Remove text\npdfjs-editor-remove-stamp-button =\n    .title = Remove image\npdfjs-editor-remove-highlight-button =\n    .title = Remove highlight\npdfjs-editor-free-text-color-input = Color\npdfjs-editor-free-text-size-input = Size\npdfjs-editor-ink-color-input = Color\npdfjs-editor-ink-thickness-input = Thickness\npdfjs-editor-ink-opacity-input = Opacity\npdfjs-editor-stamp-add-image-button =\n    .title = Add image\npdfjs-editor-stamp-add-image-button-label = Add image\npdfjs-editor-free-highlight-thickness-input = Thickness\npdfjs-editor-free-highlight-thickness-title =\n    .title = Change thickness when highlighting items other than text\npdfjs-free-text =\n    .aria-label = Text Editor\npdfjs-free-text-default-content = Start typing\u2026\npdfjs-ink =\n    .aria-label = Draw Editor\npdfjs-ink-canvas =\n    .aria-label = User-created image\npdfjs-editor-alt-text-button-label = Alt text\npdfjs-editor-alt-text-edit-button-label = Edit alt text\npdfjs-editor-alt-text-dialog-label = Choose an option\npdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people can\u2019t see the image or when it doesn\u2019t load.\npdfjs-editor-alt-text-add-description-label = Add a description\npdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.\npdfjs-editor-alt-text-mark-decorative-label = Mark as decorative\npdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.\npdfjs-editor-alt-text-cancel-button = Cancel\npdfjs-editor-alt-text-save-button = Save\npdfjs-editor-alt-text-decorative-tooltip = Marked as decorative\npdfjs-editor-alt-text-textarea =\n    .placeholder = For example, \u201cA young man sits down at a table to eat a meal\u201d\npdfjs-editor-resizer-top-left =\n    .aria-label = Top left corner \u2014 resize\npdfjs-editor-resizer-top-middle =\n    .aria-label = Top middle \u2014 resize\npdfjs-editor-resizer-top-right =\n    .aria-label = Top right corner \u2014 resize\npdfjs-editor-resizer-middle-right =\n    .aria-label = Middle right \u2014 resize\npdfjs-editor-resizer-bottom-right =\n    .aria-label = Bottom right corner \u2014 resize\npdfjs-editor-resizer-bottom-middle =\n    .aria-label = Bottom middle \u2014 resize\npdfjs-editor-resizer-bottom-left =\n    .aria-label = Bottom left corner \u2014 resize\npdfjs-editor-resizer-middle-left =\n    .aria-label = Middle left \u2014 resize\npdfjs-editor-highlight-colorpicker-label = Highlight color\npdfjs-editor-colorpicker-button =\n    .title = Change color\npdfjs-editor-colorpicker-dropdown =\n    .aria-label = Color choices\npdfjs-editor-colorpicker-yellow =\n    .title = Yellow\npdfjs-editor-colorpicker-green =\n    .title = Green\npdfjs-editor-colorpicker-blue =\n    .title = Blue\npdfjs-editor-colorpicker-pink =\n    .title = Pink\npdfjs-editor-colorpicker-red =\n    .title = Red\npdfjs-editor-highlight-show-all-button-label = Show all\npdfjs-editor-highlight-show-all-button =\n    .title = Show all\npdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)\npdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)\npdfjs-editor-new-alt-text-textarea =\n    .placeholder = Write your description here\u2026\npdfjs-editor-new-alt-text-description = Short description for people who can\u2019t see the image or when the image doesn\u2019t load.\npdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.\npdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more\npdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically\npdfjs-editor-new-alt-text-not-now-button = Not now\npdfjs-editor-new-alt-text-error-title = Couldn\u2019t create alt text automatically\npdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.\npdfjs-editor-new-alt-text-error-close-button = Close\npdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)\n    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)\npdfjs-editor-new-alt-text-added-button-label = Alt text added\npdfjs-editor-new-alt-text-missing-button-label = Missing alt text\npdfjs-editor-new-alt-text-to-review-button-label = Review alt text\npdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }\npdfjs-image-alt-text-settings-button =\n    .title = Image alt text settings\npdfjs-image-alt-text-settings-button-label = Image alt text settings\npdfjs-editor-alt-text-settings-dialog-label = Image alt text settings\npdfjs-editor-alt-text-settings-automatic-title = Automatic alt text\npdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically\npdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who can\u2019t see the image or when the image doesn\u2019t load.\npdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)\npdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.\npdfjs-editor-alt-text-settings-delete-model-button = Delete\npdfjs-editor-alt-text-settings-download-model-button = Download\npdfjs-editor-alt-text-settings-downloading-model-button = Downloading\u2026\npdfjs-editor-alt-text-settings-editor-title = Alt text editor\npdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image\npdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.\npdfjs-editor-alt-text-settings-close-button = Close')})()},f(Be,ig),f(Be,sg),f(Be,ng),f(Be,rg),f(Be,wd);class vS{constructor({linkService:t,eventBus:e}){f(this,Qe),f(this,hl),f(this,cl),f(this,ra),f(this,dl),f(this,Ed),f(this,ag),f(this,og),f(this,xd),f(this,lg),f(this,hg),f(this,fn,null),this.linkService=t,this.eventBus=e,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",i=>{this._isPagesLoaded=!!i.pagesCount},{once:!0})})}initialize({fingerprint:t,resetHistory:e=!1,updateUrl:i=!1}){if(!t||"string"!=typeof t)return void console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');this._initialized&&this.reset();const s=""!==this._fingerprint&&this._fingerprint!==t;this._fingerprint=t,this._updateUrl=!0===i,this._initialized=!0,p(this,lg,S0).call(this);const n=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=Qm(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!p(this,ra,wu).call(this,n,!0)||e){const{hash:o,page:h,rotation:c}=p(this,Ed,x_).call(this,!0);return!o||s||e?void p(this,Qe,ys).call(this,null,!0):void p(this,Qe,ys).call(this,{hash:o,page:h,rotation:c},!0)}const a=n.destination;p(this,dl,lm).call(this,a,n.uid,!0),void 0!==a.rotation&&(this._initialRotation=a.rotation),a.dest?(this._initialBookmark=JSON.stringify(a.dest),this._destination.page=null):a.hash?this._initialBookmark=a.hash:a.page&&(this._initialBookmark=`page=${a.page}`)}reset(){this._initialized&&(p(this,xd,C_).call(this),this._initialized=!1,p(this,hg,P0).call(this)),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:t=null,explicitDest:e,pageNumber:i}){if(!this._initialized)return;if(t&&"string"!=typeof t)return void console.error(`PDFHistory.push: "${t}" is not a valid namedDest parameter.`);if(!Array.isArray(e))return void console.error(`PDFHistory.push: "${e}" is not a valid explicitDest parameter.`);if(!p(this,cl,om).call(this,i)&&(null!==i||this._destination))return void console.error(`PDFHistory.push: "${i}" is not a valid pageNumber parameter.`);const s=t||JSON.stringify(e);if(!s)return;let n=!1;if(this._destination&&(function wS(l,t){return"string"==typeof l&&"string"==typeof t&&(l===t||Xu(l).get("nameddest")===t)}(this._destination.hash,s)||function ES(l,t){function e(i,s){if(typeof i!=typeof s||Array.isArray(i)||Array.isArray(s))return!1;if(null!==i&&"object"==typeof i&&null!==s){if(Object.keys(i).length!==Object.keys(s).length)return!1;for(const n in i)if(!e(i[n],s[n]))return!1;return!0}return i===s||Number.isNaN(i)&&Number.isNaN(s)}if(!Array.isArray(l)||!Array.isArray(t)||l.length!==t.length)return!1;for(let i=0,s=l.length;i<s;i++)if(!e(l[i],t[i]))return!1;return!0}(this._destination.dest,e))){if(this._destination.page)return;n=!0}this._popStateInProgress&&!n||(p(this,Qe,ys).call(this,{dest:e,hash:s,page:i,rotation:this.linkService.rotation},n),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(t){if(this._initialized){if(!p(this,cl,om).call(this,t))return void console.error(`PDFHistory.pushPage: "${t}" is not a valid page number.`);this._destination?.page!==t&&(this._popStateInProgress||(p(this,Qe,ys).call(this,{dest:null,hash:`page=${t}`,page:t,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||p(this,hl,am).call(this)}back(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;p(this,ra,wu).call(this,t)&&t.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;p(this,ra,wu).call(this,t)&&t.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}}fn=new WeakMap,Qe=new WeakSet,ys=function(t,e=!1){const i=e||!this._destination,s={fingerprint:this._fingerprint,uid:i?this._uid:this._uid+1,destination:t};let n;if(p(this,dl,lm).call(this,t,s.uid),this._updateUrl&&t?.hash){const a=document.location.href.split("#",1)[0];a.startsWith("file://")||(n=`${a}#${t.hash}`)}i?window.history.replaceState(s,"",n):window.history.pushState(s,"",n)},hl=new WeakSet,am=function(t=!1){if(!this._position)return;let e=this._position;if(t&&(e=Object.assign(Object.create(null),this._position),e.temporary=!0),!this._destination)return void p(this,Qe,ys).call(this,e);if(this._destination.temporary)return void p(this,Qe,ys).call(this,e,!0);if(this._destination.hash===e.hash||!this._destination.page&&this._numPositionUpdates<=50)return;let i=!1;if(this._destination.page>=e.first&&this._destination.page<=e.page){if(void 0!==this._destination.dest||!this._destination.first)return;i=!0}p(this,Qe,ys).call(this,e,i)},cl=new WeakSet,om=function(t){return Number.isInteger(t)&&t>0&&t<=this.linkService.pagesCount},ra=new WeakSet,wu=function(t,e=!1){if(!t)return!1;if(t.fingerprint!==this._fingerprint){if(!e)return!1;{if("string"!=typeof t.fingerprint||t.fingerprint.length!==this._fingerprint.length)return!1;const[i]=performance.getEntriesByType("navigation");if("reload"!==i?.type)return!1}}return!(!Number.isInteger(t.uid)||t.uid<0||null===t.destination||"object"!=typeof t.destination)},dl=new WeakSet,lm=function(t,e,i=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),i&&t?.temporary&&delete t.temporary,this._destination=t,this._uid=e,this._maxUid=Math.max(this._maxUid,e),this._numPositionUpdates=0},Ed=new WeakSet,x_=function(t=!1){const e=unescape(Qm()).substring(1),i=Xu(e),s=i.get("nameddest")||"";let n=0|i.get("page");return(!p(this,cl,om).call(this,n)||t&&s.length>0)&&(n=null),{hash:e,page:n,rotation:this.linkService.rotation}},ag=new WeakSet,x0=function({location:t}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:t.pdfOpenParams.substring(1),page:this.linkService.page,first:t.pageNumber,rotation:t.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||p(this,hl,am).call(this,!0),this._updateViewareaTimeout=null},1e3))},og=new WeakSet,C0=function({state:t}){const e=Qm(),i=this._currentHash!==e;if(this._currentHash=e,!t){this._uid++;const{hash:n,page:a,rotation:o}=p(this,Ed,x_).call(this);return void p(this,Qe,ys).call(this,{hash:n,page:a,rotation:o},!0)}if(!p(this,ra,wu).call(this,t))return;this._popStateInProgress=!0,i&&(this._blockHashChange++,function PC(l){return qm.apply(this,arguments)}({target:window,name:"hashchange",delay:1e3}).then(()=>{this._blockHashChange--}));const s=t.destination;p(this,dl,lm).call(this,s,t.uid,!0),JA(s.rotation)&&(this.linkService.rotation=s.rotation),s.dest?this.linkService.goToDestination(s.dest):s.hash?this.linkService.setHash(s.hash):s.page&&(this.linkService.page=s.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})},xd=new WeakSet,C_=function(){(!this._destination||this._destination.temporary)&&p(this,hl,am).call(this)},lg=new WeakSet,S0=function(){if(r(this,fn))return;m(this,fn,new AbortController);const{signal:t}=r(this,fn);this.eventBus._on("updateviewarea",p(this,ag,x0).bind(this),{signal:t}),window.addEventListener("popstate",p(this,og,C0).bind(this),{signal:t}),window.addEventListener("pagehide",p(this,xd,C_).bind(this),{signal:t})},hg=new WeakSet,P0=function(){r(this,fn)?.abort(),m(this,fn,null)};class xS{constructor(t){f(this,Cd,null),f(this,Sd,null),f(this,Pd,null),f(this,Td,null),f(this,ul,void 0),this.pdfPage=t.pdfPage,this.accessibilityManager=t.accessibilityManager,this.l10n=t.l10n,this.l10n||(this.l10n=new Be),this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,m(this,ul,t.uiManager),m(this,Cd,t.annotationLayer||null),m(this,Td,t.textLayer||null),m(this,Sd,t.drawLayer||null),m(this,Pd,t.onAppend||null)}render(t,e="display"){var i=this;return(0,I.Z)(function*(){var o;if("display"!==e||i._cancelled)return;const s=t.clone({dontFlip:!0});if(i.div)return i.annotationEditorLayer.update({viewport:s}),void i.show();const n=i.div=document.createElement("div");n.className="annotationEditorLayer",n.hidden=!0,n.dir=r(i,ul).direction,null==(o=r(i,Pd))||o.call(i,n),i.annotationEditorLayer=new mC({uiManager:r(i,ul),div:n,accessibilityManager:i.accessibilityManager,pageIndex:i.pdfPage.pageNumber-1,l10n:i.l10n,viewport:s,annotationLayer:r(i,Cd),textLayer:r(i,Td),drawLayer:r(i,Sd)}),i.annotationEditorLayer.render({viewport:s,div:n,annotations:null,intent:e}),i.show()})()}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){!this.div||(this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1)}}Cd=new WeakMap,Sd=new WeakMap,Pd=new WeakMap,Td=new WeakMap,ul=new WeakMap;{var tb=new Map;const l=navigator.userAgent||"",t=navigator.platform||"",e=navigator.maxTouchPoints||1,i=/Android/.test(l);(/\b(iPad|iPhone|iPod)(?=;)/.test(l)||"MacIntel"===t&&e>1||i)&&tb.set("maxCanvasPixels",5242880),i&&tb.set("useSystemFonts",!1)}const eb={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},ni={allowedGlobalEvents:{value:null,kind:1},canvasMaxAreaInBytes:{value:-1,kind:5},isInAutomation:{value:!1,kind:1},localeProperties:{value:{lang:navigator.language||"en-US"},kind:1},nimbusDataStr:{value:"",kind:1},supportsCaretBrowsingMode:{value:!1,kind:1},supportsDocumentFonts:{value:!0,kind:1},supportsIntegratedFind:{value:!1,kind:1},supportsMouseWheelZoomCtrlKey:{value:!0,kind:1},supportsMouseWheelZoomMetaKey:{value:!0,kind:1},supportsPinchToZoom:{value:!0,kind:1},toolbarDensity:{value:0,kind:17},altTextLearnMoreUrl:{value:"",kind:130},annotationEditorMode:{value:0,kind:130},annotationMode:{value:2,kind:130},cursorToolOnLoad:{value:0,kind:130},debuggerSrc:{value:"./debugger.mjs",kind:2},defaultZoomDelay:{value:400,kind:130},defaultZoomValue:{value:"",kind:130},disableHistory:{value:!1,kind:2},disablePageLabels:{value:!1,kind:130},enableAltText:{value:!1,kind:130},enableAltTextModelDownload:{value:!0,kind:146},enableGuessAltText:{value:!0,kind:146},enableHighlightFloatingButton:{value:!1,kind:130},enableNewAltTextWhenAddingImage:{value:!0,kind:130},enablePermissions:{value:!1,kind:130},enablePrintAutoRotate:{value:!0,kind:130},enableScripting:{value:!0,kind:130},enableUpdatedAddImage:{value:!1,kind:130},externalLinkRel:{value:"noopener noreferrer nofollow",kind:2},externalLinkTarget:{value:0,kind:130},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F",kind:130},historyUpdateUrl:{value:!1,kind:130},ignoreDestinationZoom:{value:!1,kind:130},imageResourcesPath:{value:"./images/",kind:2},maxCanvasPixels:{value:2**25,kind:2},forcePageColors:{value:!1,kind:130},pageColorsBackground:{value:"Canvas",kind:130},pageColorsForeground:{value:"CanvasText",kind:130},pdfBugEnabled:{value:!1,kind:130},printResolution:{value:150,kind:2},sidebarViewOnLoad:{value:-1,kind:130},scrollModeOnLoad:{value:-1,kind:130},spreadModeOnLoad:{value:-1,kind:130},textLayerMode:{value:1,kind:130},viewOnLoad:{value:0,kind:130},cMapPacked:{value:!0,kind:4},cMapUrl:{value:"../web/cmaps/",kind:4},disableAutoFetch:{value:!1,kind:132},disableFontFace:{value:!1,kind:132},disableRange:{value:!1,kind:132},disableStream:{value:!1,kind:132},docBaseUrl:{value:"",kind:4},enableHWA:{value:!0,kind:134},enableXfa:{value:!0,kind:132},fontExtraProperties:{value:!1,kind:4},isEvalSupported:{value:!0,kind:4},isOffscreenCanvasSupported:{value:!0,kind:4},maxImageSize:{value:-1,kind:4},pdfBug:{value:!1,kind:4},standardFontDataUrl:{value:"../web/standard_fonts/",kind:4},useSystemFonts:{value:void 0,kind:4,type:eb.BOOLEAN+eb.UNDEFINED},verbosity:{value:1,kind:4},workerPort:{value:null,kind:8},workerSrc:{value:"../build/pdf.worker.mjs",kind:8},defaultUrl:{value:"compressed.tracemonkey-pldi-09.pdf",kind:2},sandboxBundleSrc:{value:"../build/pdf.sandbox.mjs",kind:2},viewerCssTheme:{value:0,kind:130},enableFakeMLManager:{value:!0,kind:2},disablePreferences:{value:!1,kind:2}},gn=class{static get(t){return r(this,pn).get(t)}static getAll(t=null,e=!1){const i=Object.create(null);for(const s in ni){const n=ni[s];t&&!(t&n.kind)||(i[s]=e?n.value:r(this,pn).get(s))}return i}static set(t,e){this.setAll({[t]:e})}static setAll(t,e=!1){let i;this._hasInvokedSet||(this._hasInvokedSet=!0);for(const s in t){const n=ni[s],a=t[s];if(!n||!(typeof a==typeof n.value||eb[(typeof a).toUpperCase()]&n.type))continue;const{kind:o}=n;e&&!(1&o||128&o)||(this.eventBus&&16&o&&(i||(i=new Map)).set(s,a),r(this,pn).set(s,a))}if(i)for(const[s,n]of i)this.eventBus.dispatch(s.toLowerCase(),{source:this,value:n})}};let La=gn;pn=new WeakMap,pb=new WeakMap,R(La,"eventBus"),f(La,pn,new Map),f(La,pb,(()=>{for(const t in ni)r(gn,pn).set(t,ni[t].value);for(const[t,e]of tb)r(gn,pn).set(t,e);gn._hasInvokedSet=!1,gn._checkDisablePreferences=()=>!!gn.get("disablePreferences")||(gn._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)})());class CS{constructor(t){f(this,Pi,null),this.pageIndex=t.pageIndex}render(t="display"){var e=this;return(0,I.Z)(function*(){"display"!==t||r(e,Pi)||e._cancelled||m(e,Pi,new yC({pageIndex:e.pageIndex}))})()}cancel(){this._cancelled=!0,r(this,Pi)&&(r(this,Pi).destroy(),m(this,Pi,null))}setParent(t){r(this,Pi)?.setParent(t)}getDrawLayer(){return r(this,Pi)}}Pi=new WeakMap;const Ly={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},SS=/^H(\d+)$/;class ky{constructor(){f(this,Md),f(this,Ld),f(this,Me,void 0)}get renderingDone(){return void 0!==r(this,Me)}render(t){if(void 0!==r(this,Me))return r(this,Me);const e=p(this,Ld,P_).call(this,t);return e?.classList.add("structTree"),m(this,Me,e)}hide(){r(this,Me)&&!r(this,Me).hidden&&(r(this,Me).hidden=!0)}show(){r(this,Me)?.hidden&&(r(this,Me).hidden=!1)}}Me=new WeakMap,Md=new WeakSet,S_=function(t,e){const{alt:i,id:s,lang:n}=t;void 0!==i&&e.setAttribute("aria-label",Yu(i)),void 0!==s&&e.setAttribute("aria-owns",s),void 0!==n&&e.setAttribute("lang",Yu(n,!0))},Ld=new WeakSet,P_=function(t){if(!t)return null;const e=document.createElement("span");if("role"in t){const{role:i}=t,s=i.match(SS);s?(e.setAttribute("role","heading"),e.setAttribute("aria-level",s[1])):Ly[i]&&e.setAttribute("role",Ly[i])}if(p(this,Md,S_).call(this,t,e),t.children)if(1===t.children.length&&"id"in t.children[0])p(this,Md,S_).call(this,t.children[0],e);else for(const i of t.children)e.append(p(this,Ld,P_).call(this,i));return e};const Rd=class{constructor(){f(this,kd),f(this,ps,!1),f(this,Le,null),f(this,gs,new Map),f(this,mn,new Map)}setTextMapping(t){m(this,Le,t)}enable(){if(r(this,ps))throw new Error("TextAccessibilityManager is already enabled.");if(!r(this,Le))throw new Error("Text divs and strings have not been set.");if(m(this,ps,!0),m(this,Le,r(this,Le).slice()),r(this,Le).sort(p(Rd,fl,hm)),r(this,gs).size>0){const t=r(this,Le);for(const[e,i]of r(this,gs))document.getElementById(e)?p(this,kd,T_).call(this,e,t[i]):r(this,gs).delete(e)}for(const[t,e]of r(this,mn))this.addPointerInTextLayer(t,e);r(this,mn).clear()}disable(){!r(this,ps)||(r(this,mn).clear(),m(this,Le,null),m(this,ps,!1))}removePointerInTextLayer(t){if(!r(this,ps))return void r(this,mn).delete(t);const e=r(this,Le);if(!e||0===e.length)return;const{id:i}=t,s=r(this,gs).get(i);if(void 0===s)return;const n=e[s];r(this,gs).delete(i);let a=n.getAttribute("aria-owns");a?.includes(i)&&(a=a.split(" ").filter(o=>o!==i).join(" "),a?n.setAttribute("aria-owns",a):(n.removeAttribute("aria-owns"),n.setAttribute("role","presentation")))}addPointerInTextLayer(t,e){const{id:i}=t;if(!i)return null;if(!r(this,ps))return r(this,mn).set(t,e),null;e&&this.removePointerInTextLayer(t);const s=r(this,Le);if(!s||0===s.length)return null;const n=Zl(s,c=>{var d;return p(d=Rd,fl,hm).call(d,t,c)<0}),a=Math.max(0,n-1),o=s[a];p(this,kd,T_).call(this,i,o),r(this,gs).set(i,a);const h=o.parentNode;return h?.classList.contains("markedContent")?h.id:null}moveElementInDOM(t,e,i,s){const n=this.addPointerInTextLayer(i,s);if(!t.hasChildNodes())return t.append(e),n;const a=Array.from(t.childNodes).filter(c=>c!==e);if(0===a.length)return n;const o=i||e,h=Zl(a,c=>{var d;return p(d=Rd,fl,hm).call(d,o,c)<0});return 0===h?a[0].before(e):a[h-1].after(e),n}};let rf=Rd;ps=new WeakMap,Le=new WeakMap,gs=new WeakMap,mn=new WeakMap,fl=new WeakSet,hm=function(t,e){const i=t.getBoundingClientRect(),s=e.getBoundingClientRect();if(0===i.width&&0===i.height)return 1;if(0===s.width&&0===s.height)return-1;const o=i.y+i.height/2,d=s.y+s.height/2;return o<=s.y&&d>=i.y+i.height?-1:d<=i.y&&o>=s.y+s.height?1:i.x+i.width/2-(s.x+s.width/2)},kd=new WeakSet,T_=function(t,e){const i=e.getAttribute("aria-owns");i?.includes(t)||e.setAttribute("aria-owns",i?`${i} ${t}`:t),e.removeAttribute("role")},f(rf,fl);class PS{constructor({findController:t,eventBus:e,pageIndex:i}){f(this,bn,null),this.findController=t,this.matches=[],this.eventBus=e,this.pageIdx=i,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(t,e){this.textDivs=t,this.textContentItemsStr=e}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,r(this,bn)||(m(this,bn,new AbortController),this.eventBus._on("updatetextlayermatches",t=>{(t.pageIndex===this.pageIdx||-1===t.pageIndex)&&this._updateMatches()},{signal:r(this,bn).signal})),this._updateMatches()}disable(){!this.enabled||(this.enabled=!1,r(this,bn)?.abort(),m(this,bn,null),this._updateMatches(!0))}_convertMatches(t,e){if(!t)return[];const{textContentItemsStr:i}=this;let s=0,n=0;const a=i.length-1,o=[];for(let h=0,c=t.length;h<c;h++){let d=t[h];for(;s!==a&&d>=n+i[s].length;)n+=i[s].length,s++;s===i.length&&console.error("Could not find a matching mapping");const u={begin:{divIdx:s,offset:d-n}};for(d+=e[h];s!==a&&d>n+i[s].length;)n+=i[s].length,s++;u.end={divIdx:s,offset:d-n},o.push(u)}return o}_renderMatches(t){if(0===t.length)return;const{findController:e,pageIdx:i}=this,{textContentItemsStr:s,textDivs:n}=this,a=i===e.selected.pageIdx,o=e.selected.matchIdx;let c=null;function u(y,E){const x=y.divIdx;return n[x].textContent="",g(x,0,y.offset,E)}function g(y,E,x,C){let S=n[y];if(S.nodeType===Node.TEXT_NODE){const k=document.createElement("span");S.before(k),k.append(S),n[y]=k,S=k}const P=s[y].substring(E,x),L=document.createTextNode(P);if(C){const k=document.createElement("span");return k.className=`${C} appended`,k.append(L),S.append(k),C.includes("selected")?k.offsetLeft:0}return S.append(L),0}let b=o,_=b+1;if(e.state.highlightAll)b=0,_=t.length;else if(!a)return;let A=-1,v=-1;for(let y=b;y<_;y++){const E=t[y],x=E.begin;if(x.divIdx===A&&x.offset===v)continue;A=x.divIdx,v=x.offset;const C=E.end,S=a&&y===o,P=S?" selected":"";let L=0;if(c&&x.divIdx===c.divIdx?g(c.divIdx,c.offset,x.offset):(null!==c&&g(c.divIdx,c.offset,undefined),u(x)),x.divIdx===C.divIdx)L=g(x.divIdx,x.offset,C.offset,"highlight"+P);else{L=g(x.divIdx,x.offset,undefined,"highlight begin"+P);for(let k=x.divIdx+1,w=C.divIdx;k<w;k++)n[k].className="highlight middle"+P;u(C,"highlight end"+P)}c=C,S&&e.scrollMatchIntoView({element:n[x.divIdx],selectedLeft:L,pageIndex:i,matchIndex:o})}c&&g(c.divIdx,c.offset,undefined)}_updateMatches(t=!1){if(!this.enabled&&!t)return;const{findController:e,matches:i,pageIdx:s}=this,{textContentItemsStr:n,textDivs:a}=this;let o=-1;for(const d of i){for(let g=Math.max(o,d.begin.divIdx),b=d.end.divIdx;g<=b;g++){const _=a[g];_.textContent=n[g],_.className=""}o=d.end.divIdx+1}e?.highlightMatches&&!t&&(this.matches=this._convertMatches(e.pageMatches[s]||null,e.pageMatchesLength[s]||null),this._renderMatches(this.matches))}}bn=new WeakMap;const Od=class{constructor({pdfPage:t,highlighter:e=null,accessibilityManager:i=null,enablePermissions:s=!1,onAppend:n=null}){f(this,cg),f(this,Id,!1),f(this,Dd,null),f(this,aa,!1),f(this,Ti,null),this.pdfPage=t,this.highlighter=e,this.accessibilityManager=i,m(this,Id,!0===s),m(this,Dd,n),this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}render(t,e=null){var i=this;return(0,I.Z)(function*(){var o,h;if(r(i,aa)&&r(i,Ti))return r(i,Ti).update({viewport:t,onBefore:i.hide.bind(i)}),void i.show();i.cancel(),m(i,Ti,new CC({textContentSource:i.pdfPage.streamTextContent(e||{includeMarkedContent:!0,disableNormalization:!0}),container:i.div,viewport:t}));const{textDivs:s,textContentItemsStr:n}=r(i,Ti);i.highlighter?.setTextMapping(s,n),i.accessibilityManager?.setTextMapping(s),yield r(i,Ti).render(),m(i,aa,!0);const a=document.createElement("div");a.className="endOfContent",i.div.append(a),p(o=i,cg,T0).call(o,a),null==(h=r(i,Dd))||h.call(i,i.div),i.highlighter?.enable(),i.accessibilityManager?.enable()})()}hide(){!this.div.hidden&&r(this,aa)&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&r(this,aa)&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){var t;r(this,Ti)?.cancel(),m(this,Ti,null),this.highlighter?.disable(),this.accessibilityManager?.disable(),p(t=Od,dg,M0).call(t,this.div)}};let Ts=Od;Id=new WeakMap,Dd=new WeakMap,aa=new WeakMap,Ti=new WeakMap,he=new WeakMap,_n=new WeakMap,cg=new WeakSet,T0=function(t){var i;const{div:e}=this;e.addEventListener("mousedown",()=>{e.classList.add("selecting")}),e.addEventListener("copy",s=>{if(!r(this,Id)){const n=document.getSelection();s.clipboardData.setData("text/plain",Yu(EC(n.toString())))}s.preventDefault(),s.stopPropagation()}),r(Od,he).set(e,t),p(i=Od,ug,L0).call(i)},dg=new WeakSet,M0=function(t){r(this,he).delete(t),0===r(this,he).size&&(r(this,_n)?.abort(),m(this,_n,null))},ug=new WeakSet,L0=function(){if(r(this,_n))return;m(this,_n,new AbortController);const{signal:t}=r(this,_n),e=(a,o)=>{o.append(a),a.style.width="",a.style.height="",o.classList.remove("selecting")};let i=!1;var s,n;document.addEventListener("pointerdown",()=>{i=!0},{signal:t}),document.addEventListener("pointerup",()=>{i=!1,r(this,he).forEach(e)},{signal:t}),window.addEventListener("blur",()=>{i=!1,r(this,he).forEach(e)},{signal:t}),document.addEventListener("keyup",()=>{i||r(this,he).forEach(e)},{signal:t}),document.addEventListener("selectionchange",()=>{const a=document.getSelection();if(0===a.rangeCount)return void r(this,he).forEach(e);const o=new Set;for(let b=0;b<a.rangeCount;b++){const _=a.getRangeAt(b);for(const A of r(this,he).keys())!o.has(A)&&_.intersectsNode(A)&&o.add(A)}for(const[b,_]of r(this,he))o.has(b)?b.classList.add("selecting"):e(_,b);if(s??(s="none"===getComputedStyle(r(this,he).values().next().value).getPropertyValue("-moz-user-select")),s)return;const h=a.getRangeAt(0),c=n&&(0===h.compareBoundaryPoints(Range.END_TO_END,n)||0===h.compareBoundaryPoints(Range.START_TO_END,n));let d=c?h.startContainer:h.endContainer;d.nodeType===Node.TEXT_NODE&&(d=d.parentNode);const u=d.parentElement.closest(".textLayer"),g=r(this,he).get(u);g&&(g.style.width=u.style.width,g.style.height=u.style.height,d.parentElement.insertBefore(g,c?d:d.nextSibling)),n=h.cloneRange()},{signal:t})},f(Ts,dg),f(Ts,ug),f(Ts,he,new Map),f(Ts,_n,null);class Ry{constructor({pdfPage:t,annotationStorage:e=null,linkService:i,xfaHtml:s=null}){this.pdfPage=t,this.annotationStorage=e,this.linkService=i,this.xfaHtml=s,this.div=null,this._cancelled=!1}render(t,e="display"){var i=this;return(0,I.Z)(function*(){if("print"===e){const a={viewport:t.clone({dontFlip:!0}),div:i.div,xfaHtml:i.xfaHtml,annotationStorage:i.annotationStorage,linkService:i.linkService,intent:e};return i.div=document.createElement("div"),a.div=i.div,$m.render(a)}const s=yield i.pdfPage.getXfa();if(i._cancelled||!s)return{textDivs:[]};const n={viewport:t.clone({dontFlip:!0}),div:i.div,xfaHtml:s,annotationStorage:i.annotationStorage,linkService:i.linkService,intent:e};return i.div?$m.update(n):(i.div=document.createElement("div"),n.div=i.div,$m.render(n))})()}cancel(){this._cancelled=!0}hide(){!this.div||(this.div.hidden=!0)}}const TS={annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new Wm}},MS=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]);class Iy{constructor(t){f(this,wn),f(this,ml),f(this,da),f(this,Hd),f(this,Vd),f(this,jd),f(this,Ud),f(this,zd),f(this,fg),f(this,pg),f(this,Wd),f(this,oa,Hi.ENABLE_FORMS),f(this,Fd,!1),f(this,la,!1),f(this,Nd,!1),f(this,An,null),f(this,yn,null),f(this,Bd,null),f(this,ha,null),f(this,pl,ct.INITIAL),f(this,gl,1),f(this,ms,{directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0}),f(this,ca,new WeakMap),f(this,vn,[null,null,null,null]);const e=t.container,i=t.defaultViewport;this.id=t.id,this.renderingId="page"+this.id,m(this,An,t.layerProperties||TS),this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=t.scale||1,this.viewport=i,this.pdfPageRotate=i.rotation,this._optionalContentConfigPromise=t.optionalContentConfigPromise||null,m(this,gl,t.textLayerMode??1),m(this,oa,t.annotationMode??Hi.ENABLE_FORMS),this.imageResourcesPath=t.imageResourcesPath||"",this.maxCanvasPixels=t.maxCanvasPixels??La.get("maxCanvasPixels"),this.pageColors=t.pageColors||null,m(this,Fd,t.enableHWA||!1),this.eventBus=t.eventBus,this.renderingQueue=t.renderingQueue,this.l10n=t.l10n,this.l10n||(this.l10n=new Be),this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=e,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null;const s=document.createElement("div");if(s.className="page",s.setAttribute("data-page-number",this.id),s.setAttribute("role","region"),s.setAttribute("data-l10n-id","pdfjs-page-landmark"),s.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=s,p(this,ml,cm).call(this),e?.append(s),this._isStandalone){e?.style.setProperty("--scale-factor",this.scale*Vi.PDF_TO_CSS_UNITS);const{optionalContentConfigPromise:n}=t;n&&n.then(a=>{n===this._optionalContentConfigPromise&&(r(this,ms).initialOptionalContent=a.hasInitialVisibility)}),t.l10n||this.l10n.translate(this.div)}}get renderingState(){return r(this,pl)}set renderingState(t){if(t!==r(this,pl))switch(m(this,pl,t),r(this,yn)&&(clearTimeout(r(this,yn)),m(this,yn,null)),t){case ct.PAUSED:this.div.classList.remove("loading");break;case ct.RUNNING:this.div.classList.add("loadingIcon"),m(this,yn,setTimeout(()=>{this.div.classList.add("loading"),m(this,yn,null)},0));break;case ct.INITIAL:case ct.FINISHED:this.div.classList.remove("loadingIcon","loading")}}setPdfPage(t){this._isStandalone&&("CanvasText"===this.pageColors?.foreground||"Canvas"===this.pageColors?.background)&&(this._container?.style.setProperty("--hcm-highlight-filter",t.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",t.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=t,this.pdfPageRotate=t.rotate,this.viewport=t.getViewport({scale:this.scale*Vi.PDF_TO_CSS_UNITS,rotation:(this.rotation+this.pdfPageRotate)%360}),p(this,ml,cm).call(this),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return tf(this,"_textHighlighter",new PS({pageIndex:this.id-1,eventBus:this.eventBus,findController:r(this,An).findController}))}_resetZoomLayer(t=!1){if(!this.zoomLayer)return;const e=this.zoomLayer.firstChild;r(this,ca).delete(e),e.width=0,e.height=0,t&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:t=!1,keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:i=!1,keepXfaLayer:s=!1,keepTextLayer:n=!1}={}){this.cancelRendering({keepAnnotationLayer:e,keepAnnotationEditorLayer:i,keepXfaLayer:s,keepTextLayer:n}),this.renderingState=ct.INITIAL;const a=this.div,o=a.childNodes,h=t&&this.zoomLayer||null,c=e&&this.annotationLayer?.div||null,d=i&&this.annotationEditorLayer?.div||null,u=s&&this.xfaLayer?.div||null,g=n&&this.textLayer?.div||null;for(let b=o.length-1;b>=0;b--){const _=o[b];switch(_){case h:case c:case d:case u:case g:continue}_.remove();const A=r(this,vn).indexOf(_);A>=0&&(r(this,vn)[A]=null)}a.removeAttribute("data-loaded"),c&&this.annotationLayer.hide(),d&&this.annotationEditorLayer.hide(),u&&this.xfaLayer.hide(),g&&this.textLayer.hide(),this.structTreeLayer?.hide(),h||(this.canvas&&(r(this,ca).delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}toggleEditingMode(t){!this.hasEditableAnnotations()||(m(this,Nd,t),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0}))}update({scale:t=0,rotation:e=null,optionalContentConfigPromise:i=null,drawingDelay:s=-1}){if(this.scale=t||this.scale,"number"==typeof e&&(this.rotation=e),i instanceof Promise&&(this._optionalContentConfigPromise=i,i.then(a=>{i===this._optionalContentConfigPromise&&(r(this,ms).initialOptionalContent=a.hasInitialVisibility)})),r(this,ms).directDrawing=!0,this.viewport=this.viewport.clone({scale:this.scale*Vi.PDF_TO_CSS_UNITS,rotation:(this.rotation+this.pdfPageRotate)%360}),p(this,ml,cm).call(this),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.canvas){let a=!1;if(r(this,la))if(0===this.maxCanvasPixels)a=!0;else if(this.maxCanvasPixels>0){const{width:h,height:c}=this.viewport,{sx:d,sy:u}=this.outputScale;a=(Math.floor(h)*d|0)*(Math.floor(c)*u|0)>this.maxCanvasPixels}const o=s>=0&&s<1e3;if(o||a){if(o&&!a&&this.renderingState!==ct.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:s}),this.renderingState=ct.FINISHED,r(this,ms).directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!o,hideTextLayer:o}),o)return;return void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:r(this,ha)})}!this.zoomLayer&&!this.canvas.hidden&&(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:e=!1,keepXfaLayer:i=!1,keepTextLayer:s=!1,cancelExtraDelay:n=0}={}){this.renderTask&&(this.renderTask.cancel(n),this.renderTask=null),this.resume=null,this.textLayer&&(!s||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationLayer&&(!t||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.annotationEditorLayer&&(!e||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!i||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:t,redrawAnnotationLayer:e=!1,redrawAnnotationEditorLayer:i=!1,redrawXfaLayer:s=!1,redrawTextLayer:n=!1,hideTextLayer:a=!1}){if(!t.hasAttribute("zooming")){t.setAttribute("zooming",!0);const{style:h}=t;h.width=h.height=""}const o=r(this,ca).get(t);if(this.viewport!==o){const h=this.viewport.rotation-o.rotation,c=Math.abs(h);let d=1,u=1;if(90===c||270===c){const{width:g,height:b}=this.viewport;d=b/g,u=g/b}t.style.transform=`rotate(${h}deg) scale(${d}, ${u})`}e&&this.annotationLayer&&p(this,Hd,M_).call(this),i&&this.annotationEditorLayer&&(this.drawLayer&&p(this,jd,k_).call(this),p(this,Vd,L_).call(this)),s&&this.xfaLayer&&p(this,Ud,R_).call(this),this.textLayer&&(a?(this.textLayer.hide(),this.structTreeLayer?.hide()):n&&p(this,zd,I_).call(this))}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(t,e){return this.viewport.convertToPdfPoint(t,e)}draw(){var t=this;return(0,I.Z)(function*(){var L,k;t.renderingState!==ct.INITIAL&&(console.error("Must be in new state before drawing"),t.reset());const{div:e,l10n:i,pageColors:s,pdfPage:n,viewport:a}=t;if(!n)throw t.renderingState=ct.FINISHED,new Error("pdfPage is not loaded");t.renderingState=ct.RUNNING;const o=document.createElement("div");if(o.classList.add("canvasWrapper"),p(L=t,wn,Il).call(L,o,"canvasWrapper"),!t.textLayer&&0!==r(t,gl)&&!n.isPureXfa&&(t._accessibilityManager||(t._accessibilityManager=new rf),t.textLayer=new Ts({pdfPage:n,highlighter:t._textHighlighter,accessibilityManager:t._accessibilityManager,enablePermissions:2===r(t,gl),onAppend:w=>{var T;t.l10n.pause(),p(T=t,wn,Il).call(T,w,"textLayer"),t.l10n.resume()}})),!t.annotationLayer&&r(t,oa)!==Hi.DISABLE){const{annotationStorage:w,annotationEditorUIManager:T,downloadManager:D,enableScripting:$,fieldObjectsPromise:j,hasJSActionsPromise:W,linkService:tt}=r(t,An);t._annotationCanvasMap||(t._annotationCanvasMap=new Map),t.annotationLayer=new ly({pdfPage:n,annotationStorage:w,imageResourcesPath:t.imageResourcesPath,renderForms:r(t,oa)===Hi.ENABLE_FORMS,linkService:tt,downloadManager:D,enableScripting:$,hasJSActionsPromise:W,fieldObjectsPromise:j,annotationCanvasMap:t._annotationCanvasMap,accessibilityManager:t._accessibilityManager,annotationEditorUIManager:T,onAppend:mt=>{var B;p(B=t,wn,Il).call(B,mt,"annotationLayer")}})}const{width:c,height:d}=a,u=document.createElement("canvas");u.setAttribute("role","presentation"),u.hidden=!0;const g=!(!s?.background||!s?.foreground);let b=w=>{(!g||w)&&(u.hidden=!1,b=null)};o.append(u),t.canvas=u;const _=u.getContext("2d",{alpha:!1,willReadFrequently:!r(t,Fd)}),A=t.outputScale=new Ox;if(0===t.maxCanvasPixels){const w=1/t.scale;A.sx*=w,A.sy*=w,m(t,la,!0)}else if(t.maxCanvasPixels>0){const T=Math.sqrt(t.maxCanvasPixels/(c*d));A.sx>T||A.sy>T?(A.sx=T,A.sy=T,m(t,la,!0)):m(t,la,!1)}const v=ZA(A.sx),y=ZA(A.sy);u.width=Zu(c*A.sx,v[0]),u.height=Zu(d*A.sy,y[0]);const{style:E}=u;E.width=Zu(c,v[1])+"px",E.height=Zu(d,y[1])+"px",r(t,ca).set(u,a);const C={canvasContext:_,transform:A.scaled?[A.sx,0,0,A.sy,0,0]:null,viewport:a,annotationMode:r(t,oa),optionalContentConfigPromise:t._optionalContentConfigPromise,annotationCanvasMap:t._annotationCanvasMap,pageColors:s,isEditing:r(t,Nd)},S=t.renderTask=n.render(C);S.onContinue=w=>{if(b?.(!1),t.renderingQueue&&!t.renderingQueue.isHighestPriority(t))return t.renderingState=ct.PAUSED,void(t.resume=()=>{t.renderingState=ct.RUNNING,w()});w()};const P=S.promise.then((0,I.Z)(function*(){var T,D,$,j,W;b?.(!0),yield p(T=t,Wd,D_).call(T,S),p(D=t,zd,I_).call(D),t.annotationLayer&&(yield p($=t,Hd,M_).call($));const{annotationEditorUIManager:w}=r(t,An);!w||(t.drawLayer||(t.drawLayer=new CS({pageIndex:t.id})),yield p(j=t,jd,k_).call(j),t.drawLayer.setParent(o),t.annotationEditorLayer||(t.annotationEditorLayer=new xS({uiManager:w,pdfPage:n,l10n:i,accessibilityManager:t._accessibilityManager,annotationLayer:t.annotationLayer?.annotationLayer,textLayer:t.textLayer,drawLayer:t.drawLayer.getDrawLayer(),onAppend:tt=>{var mt;p(mt=t,wn,Il).call(mt,tt,"annotationEditorLayer")}})),p(W=t,Vd,L_).call(W))}),w=>{var T;return w instanceof Gm||b?.(!0),p(T=t,Wd,D_).call(T,S,w)});if(n.isPureXfa){if(!t.xfaLayer){const{annotationStorage:w,linkService:T}=r(t,An);t.xfaLayer=new Ry({pdfPage:n,annotationStorage:w,linkService:T})}p(k=t,Ud,R_).call(k)}return e.setAttribute("data-loaded",!0),t.eventBus.dispatch("pagerender",{source:t,pageNumber:t.id}),P})()}setPageLabel(t){this.pageLabel="string"==typeof t?t:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:t,initialOptionalContent:e,regularAnnotations:i}=r(this,ms);return t&&e&&i?this.canvas:null}}function ib(){return(ib=(0,I.Z)(function*(l){const e="".split("#",1)[0];let{info:i,metadata:s,contentDispositionFilename:n,contentLength:a}=yield l.getMetadata();if(!a){const{length:o}=yield l.getDownloadInfo();a=o}return{...i,baseURL:e,filesize:a,filename:n||vC(""),metadata:s?.getRaw(),authors:s?.get("dc:creator"),numPages:l.numPages,URL:""}})).apply(this,arguments)}oa=new WeakMap,Fd=new WeakMap,la=new WeakMap,Nd=new WeakMap,An=new WeakMap,yn=new WeakMap,Bd=new WeakMap,ha=new WeakMap,pl=new WeakMap,gl=new WeakMap,ms=new WeakMap,ca=new WeakMap,vn=new WeakMap,wn=new WeakSet,Il=function(t,e){const i=MS.get(e),s=r(this,vn)[i];if(r(this,vn)[i]=t,s)s.replaceWith(t);else{for(let n=i-1;n>=0;n--){const a=r(this,vn)[n];if(a)return void a.after(t)}this.div.prepend(t)}},ml=new WeakSet,cm=function(){const{viewport:t}=this;if(this.pdfPage){if(r(this,Bd)===t.rotation)return;m(this,Bd,t.rotation)}xC(this.div,t,!0,!1)},da=new WeakSet,Eu=function(t,e){this.eventBus.dispatch(t,{source:this,pageNumber:this.id,error:e})},Hd=new WeakSet,M_=function(){var t=this;return(0,I.Z)(function*(){var i;let e=null;try{yield t.annotationLayer.render(t.viewport,"display")}catch(s){console.error(`#renderAnnotationLayer: "${s}".`),e=s}finally{p(i=t,da,Eu).call(i,"annotationlayerrendered",e)}})()},Vd=new WeakSet,L_=function(){var t=this;return(0,I.Z)(function*(){var i;let e=null;try{yield t.annotationEditorLayer.render(t.viewport,"display")}catch(s){console.error(`#renderAnnotationEditorLayer: "${s}".`),e=s}finally{p(i=t,da,Eu).call(i,"annotationeditorlayerrendered",e)}})()},jd=new WeakSet,k_=function(){var t=this;return(0,I.Z)(function*(){try{yield t.drawLayer.render("display")}catch(e){console.error(`#renderDrawLayer: "${e}".`)}})()},Ud=new WeakSet,R_=function(){var t=this;return(0,I.Z)(function*(){var i,s,n;let e=null;try{const a=yield t.xfaLayer.render(t.viewport,"display");a?.textDivs&&t._textHighlighter&&p(i=t,pg,R0).call(i,a.textDivs)}catch(a){console.error(`#renderXfaLayer: "${a}".`),e=a}finally{t.xfaLayer?.div&&(t.l10n.pause(),p(s=t,wn,Il).call(s,t.xfaLayer.div,"xfaLayer"),t.l10n.resume()),p(n=t,da,Eu).call(n,"xfalayerrendered",e)}})()},zd=new WeakSet,I_=function(){var t=this;return(0,I.Z)(function*(){var i,s;if(!t.textLayer)return;let e=null;try{yield t.textLayer.render(t.viewport)}catch(n){if(n instanceof gC)return;console.error(`#renderTextLayer: "${n}".`),e=n}p(i=t,da,Eu).call(i,"textlayerrendered",e),p(s=t,fg,k0).call(s)})()},fg=new WeakSet,k0=function(){var t=this;return(0,I.Z)(function*(){if(!t.textLayer)return;t.structTreeLayer||(t.structTreeLayer=new ky);const e=yield t.structTreeLayer.renderingDone?null:t.pdfPage.getStructTree(),i=t.structTreeLayer?.render(e);i&&(t.l10n.pause(),t.canvas?.append(i),t.l10n.resume()),t.structTreeLayer?.show()})()},pg=new WeakSet,R0=function(t){var e=this;return(0,I.Z)(function*(){const i=yield e.pdfPage.getTextContent(),s=[];for(const n of i.items)s.push(n.str);e._textHighlighter.setTextMapping(t,s),e._textHighlighter.enable()})()},Wd=new WeakSet,D_=function(t,e=null){var i=this;return(0,I.Z)(function*(){if(t===i.renderTask&&(i.renderTask=null),e instanceof Gm)m(i,ha,null);else if(m(i,ha,e),i.renderingState=ct.FINISHED,i._resetZoomLayer(!0),r(i,ms).regularAnnotations=!t.separateAnnots,i.eventBus.dispatch("pagerendered",{source:i,pageNumber:i.id,cssTransform:!1,timestamp:performance.now(),error:r(i,ha)}),e)throw e})()};class kS{constructor(t){this._ready=new Promise((e,i)=>{import(t).then(n=>{e(n.QuickJSSandbox())}).catch(i)})}createSandbox(t){var e=this;return(0,I.Z)(function*(){(yield e._ready).create(t)})()}dispatchEventInSandbox(t){var e=this;return(0,I.Z)(function*(){const i=yield e._ready;setTimeout(()=>i.dispatchEvent(t),0)})()}destroySandbox(){var t=this;return(0,I.Z)(function*(){(yield t._ready).nukeSandbox()})()}}Mi=new WeakMap,ua=new WeakMap,Gd=new WeakMap,fa=new WeakMap,pa=new WeakMap,$d=new WeakMap,Qt=new WeakMap,bs=new WeakMap,bl=new WeakMap,Tt=new WeakMap,ke=new WeakMap,gg=new WeakSet,I0=function(t){var e=this;return(0,I.Z)(function*(){const i=r(e,bs),s=i.isInPresentationMode||i.isChangingPresentationMode,{id:n,siblings:a,command:o,value:h}=t;if(!n){switch(o){case"clear":console.clear();break;case"error":console.error(h);break;case"layout":if(!s){const d=function Gx(l){let t=Z.VERTICAL,e=$t.NONE;switch(l){case"SinglePage":t=Z.PAGE;break;case"OneColumn":break;case"TwoPageLeft":t=Z.PAGE;case"TwoColumnLeft":e=$t.ODD;break;case"TwoPageRight":t=Z.PAGE;case"TwoColumnRight":e=$t.EVEN}return{scrollMode:t,spreadMode:e}}(h);i.spreadMode=d.spreadMode}break;case"page-num":i.currentPageNumber=h+1;break;case"print":yield i.pagesPromise,r(e,pa).dispatch("print",{source:e});break;case"println":console.log(h);break;case"zoom":s||(i.currentScaleValue=h);break;case"SaveAs":r(e,pa).dispatch("download",{source:e});break;case"FirstPage":i.currentPageNumber=1;break;case"LastPage":i.currentPageNumber=i.pagesCount;break;case"NextPage":i.nextPage();break;case"PrevPage":i.previousPage();break;case"ZoomViewIn":s||i.increaseScale();break;case"ZoomViewOut":s||i.decreaseScale();break;case"WillPrintFinished":r(e,ke)?.resolve(),m(e,ke,null)}return}if(s&&t.focus)return;delete t.id,delete t.siblings;const c=a?[n,...a]:[n];for(const d of c){const u=document.querySelector(`[data-element-id="${d}"]`);u?u.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:t})):r(e,Qt)?.annotationStorage.setValue(d,t)}})()},_l=new WeakSet,dm=function(t,e=!1){var i=this;return(0,I.Z)(function*(){const s=r(i,Qt),n=i._visitedPages;if(e&&m(i,Mi,Promise.withResolvers()),!r(i,Mi))return;const a=r(i,bs).getPageView(t-1);if(a?.renderingState!==ct.FINISHED)return void i._pageOpenPending.add(t);i._pageOpenPending.delete(t);const o=(0,I.Z)(function*(){const h=yield n.has(t)?null:a.pdfPage?.getJSActions();s===r(i,Qt)&&(yield r(i,Tt)?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:t,actions:h}))})();n.set(t,o)})()},qd=new WeakSet,O_=function(t){var e=this;return(0,I.Z)(function*(){const i=r(e,Qt),s=e._visitedPages;if(!r(e,Mi)||e._pageOpenPending.has(t))return;const n=s.get(t);!n||(s.set(t,null),yield n,i===r(e,Qt)&&(yield r(e,Tt)?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:t})))})()},mg=new WeakSet,D0=function(){if(m(this,ua,Promise.withResolvers()),r(this,Tt))throw new Error("#initScripting: Scripting already exists.");return r(this,$d).createScripting()},ga=new WeakSet,xu=function(){var t=this;return(0,I.Z)(function*(){if(!r(t,Tt))return m(t,Qt,null),void r(t,ua)?.resolve();r(t,Mi)&&(yield Promise.race([r(t,Mi).promise,new Promise(e=>{setTimeout(e,1e3)})]).catch(()=>{}),m(t,Mi,null)),m(t,Qt,null);try{yield r(t,Tt).destroySandbox()}catch{}r(t,ke)?.reject(new Error("Scripting destroyed.")),m(t,ke,null),r(t,fa)?.abort(),m(t,fa,null),t._pageOpenPending.clear(),t._visitedPages.clear(),m(t,Tt,null),m(t,bl,!1),r(t,ua)?.resolve()})()};class IS extends class RS{constructor({eventBus:t,externalServices:e=null,docProperties:i=null}){f(this,gg),f(this,_l),f(this,qd),f(this,mg),f(this,ga),f(this,Mi,null),f(this,ua,null),f(this,Gd,null),f(this,fa,null),f(this,pa,null),f(this,$d,null),f(this,Qt,null),f(this,bs,null),f(this,bl,!1),f(this,Tt,null),f(this,ke,null),m(this,pa,t),m(this,$d,e),m(this,Gd,i)}setViewer(t){m(this,bs,t)}setDocument(t){var e=this;return(0,I.Z)(function*(){var h,c,d,u,g,b,_;if(r(e,Qt)&&(yield p(h=e,ga,xu).call(h)),m(e,Qt,t),!t)return;const[i,s,n]=yield Promise.all([t.getFieldObjects(),t.getCalculationOrderIds(),t.getJSActions()]);if(!i&&!n)return void(yield p(c=e,ga,xu).call(c));if(t!==r(e,Qt))return;try{m(e,Tt,p(d=e,mg,D0).call(d))}catch(A){return console.error(`setDocument: "${A.message}".`),void(yield p(u=e,ga,xu).call(u))}const a=r(e,pa);m(e,fa,new AbortController);const{signal:o}=r(e,fa);a._on("updatefromsandbox",A=>{var v;A?.source===window&&p(v=e,gg,I0).call(v,A.detail)},{signal:o}),a._on("dispatcheventinsandbox",A=>{r(e,Tt)?.dispatchEventInSandbox(A.detail)},{signal:o}),a._on("pagechanging",({pageNumber:A,previous:v})=>{var y,E;A!==v&&(p(y=e,qd,O_).call(y,v),p(E=e,_l,dm).call(E,A))},{signal:o}),a._on("pagerendered",({pageNumber:A})=>{var v;!e._pageOpenPending.has(A)||A===r(e,bs).currentPageNumber&&p(v=e,_l,dm).call(v,A)},{signal:o}),a._on("pagesdestroy",(0,I.Z)(function*(){var A;yield p(A=e,qd,O_).call(A,r(e,bs).currentPageNumber),yield r(e,Tt)?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),r(e,Mi)?.resolve()}),{signal:o});try{const A=yield r(g=e,Gd).call(g,t);if(t!==r(e,Qt))return;yield r(e,Tt).createSandbox({objects:i,calculationOrder:s,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...A,actions:n}}),a.dispatch("sandboxcreated",{source:e})}catch(A){return console.error(`setDocument: "${A.message}".`),void(yield p(b=e,ga,xu).call(b))}yield r(e,Tt)?.dispatchEventInSandbox({id:"doc",name:"Open"}),yield p(_=e,_l,dm).call(_,r(e,bs).currentPageNumber,!0),Promise.resolve().then(()=>{t===r(e,Qt)&&m(e,bl,!0)})})()}dispatchWillSave(){var t=this;return(0,I.Z)(function*(){return r(t,Tt)?.dispatchEventInSandbox({id:"doc",name:"WillSave"})})()}dispatchDidSave(){var t=this;return(0,I.Z)(function*(){return r(t,Tt)?.dispatchEventInSandbox({id:"doc",name:"DidSave"})})()}dispatchWillPrint(){var t=this;return(0,I.Z)(function*(){if(r(t,Tt)){yield r(t,ke)?.promise,m(t,ke,Promise.withResolvers());try{yield r(t,Tt).dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(e){throw r(t,ke).resolve(),m(t,ke,null),e}yield r(t,ke).promise}})()}dispatchDidPrint(){var t=this;return(0,I.Z)(function*(){return r(t,Tt)?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})})()}get destroyPromise(){return r(this,ua)?.promise||null}get ready(){return r(this,bl)}get _pageOpenPending(){return tf(this,"_pageOpenPending",new Set)}get _visitedPages(){return tf(this,"_visitedPages",new Map)}}{constructor(t){t.externalServices||window.addEventListener("updatefromsandbox",e=>{t.eventBus.dispatch("updatefromsandbox",{source:window,detail:e.detail})}),t.externalServices||(t.externalServices={createScripting:()=>new kS(t.sandboxBundleSrc)}),t.docProperties||(t.docProperties=e=>function LS(l){return ib.apply(this,arguments)}(e)),super(t)}}class OS{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(t){this.pdfViewer=t}setThumbnailViewer(t){this.pdfThumbnailViewer=t}isHighestPriority(t){return this.highestPriorityPage===t.renderingId}renderHighestPriority(t){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(t)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),3e4)))}getHighestPriority(t,e,i,s=!1){const n=t.views,a=n.length;if(0===a)return null;for(let u=0;u<a;u++){const g=n[u].view;if(!this.isViewFinished(g))return g}const o=t.first.id,h=t.last.id;if(h-o+1>a){const u=t.ids;for(let g=1,b=h-o;g<b;g++){const _=i?o+g:h-g;if(u.has(_))continue;const A=e[_-1];if(!this.isViewFinished(A))return A}}let c=i?h:o-2,d=e[c];return d&&!this.isViewFinished(d)||s&&(c+=i?1:-1,d=e[c],d&&!this.isViewFinished(d))?d:null}isViewFinished(t){return t.renderingState===ct.FINISHED}renderView(t){switch(t.renderingState){case ct.FINISHED:return!1;case ct.PAUSED:this.highestPriorityPage=t.renderingId,t.resume();break;case ct.RUNNING:this.highestPriorityPage=t.renderingId;break;case ct.INITIAL:this.highestPriorityPage=t.renderingId,t.draw().finally(()=>{this.renderHighestPriority()}).catch(e=>{e instanceof Gm||console.error(`renderView: "${e}"`)})}return!0}}function Oy(l){return Object.values(ue).includes(l)&&l!==ue.DISABLE}class FS{constructor(t){f(this,Kd),f(this,_s,new Set),f(this,ma,0),m(this,ma,t)}push(t){const e=r(this,_s);e.has(t)&&e.delete(t),e.add(t),e.size>r(this,ma)&&p(this,Kd,F_).call(this)}resize(t,e=null){m(this,ma,t);const i=r(this,_s);if(e){const s=i.size;let n=1;for(const a of i)if(e.has(a.id)&&(i.delete(a),i.add(a)),++n>s)break}for(;i.size>r(this,ma);)p(this,Kd,F_).call(this)}has(t){return r(this,_s).has(t)}[Symbol.iterator](){return r(this,_s).keys()}}_s=new WeakMap,ma=new WeakMap,Kd=new WeakSet,F_=function(){const t=r(this,_s).keys().next().value;t?.destroy(),r(this,_s).delete(t)};class Fy{constructor(t){f(this,bg),f(this,_g),f(this,Ag),f(this,va),f(this,El),f(this,yg),f(this,nu),f(this,vg),f(this,ki),f(this,ru),f(this,wg),f(this,Eg),f(this,xg),f(this,au),f(this,Cg),f(this,xl),f(this,En,null),f(this,Xd,null),f(this,Yd,null),f(this,Li,ue.NONE),f(this,ye,null),f(this,ba,Hi.ENABLE_FORMS),f(this,Zd,null),f(this,Jd,!1),f(this,Qd,!1),f(this,tu,!1),f(this,eu,!1),f(this,iu,!1),f(this,xn,null),f(this,_a,null),f(this,Cn,null),f(this,Aa,null),f(this,Al,!1),f(this,Sn,null),f(this,yl,!1),f(this,su,0),f(this,vl,new ResizeObserver(p(this,Cg,z0).bind(this))),f(this,ya,null),f(this,Pn,null),f(this,wl,1);const e="4.6.82";if(oy!==e)throw new Error(`The API version "${oy}" does not match the Viewer version "${e}".`);if(this.container=t.container,this.viewer=t.viewer||t.container.firstElementChild,"DIV"!==this.container?.tagName||"DIV"!==this.viewer?.tagName)throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&"absolute"!==getComputedStyle(this.container).position)throw new Error("The `container` must be absolutely positioned.");r(this,vl).observe(this.container),this.eventBus=t.eventBus,this.linkService=t.linkService||new Wm,this.downloadManager=t.downloadManager||null,this.findController=t.findController||null,m(this,Xd,t.altTextManager||null),this.findController&&(this.findController.onIsPageVisible=s=>this._getVisiblePages().ids.has(s)),this._scriptingManager=t.scriptingManager||null,m(this,wl,t.textLayerMode??1),m(this,ba,t.annotationMode??Hi.ENABLE_FORMS),m(this,Li,t.annotationEditorMode??ue.NONE),m(this,Yd,t.annotationEditorHighlightColors||null),m(this,Qd,!0===t.enableHighlightFloatingButton),m(this,eu,!0===t.enableUpdatedAddImage),m(this,iu,!0===t.enableNewAltTextWhenAddingImage),this.imageResourcesPath=t.imageResourcesPath||"",this.enablePrintAutoRotate=t.enablePrintAutoRotate||!1,this.removePageBorders=t.removePageBorders||!1,this.maxCanvasPixels=t.maxCanvasPixels,this.l10n=t.l10n,this.l10n||(this.l10n=new Be),m(this,tu,t.enablePermissions||!1),this.pageColors=t.pageColors||null,m(this,_a,t.mlManager||null),m(this,Jd,t.enableHWA||!1),this.defaultRenderingQueue=!t.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new OS,this.renderingQueue.setViewer(this)):this.renderingQueue=t.renderingQueue;const{abortSignal:i}=t;i?.addEventListener("abort",()=>{r(this,vl).disconnect(),m(this,vl,null)},{once:!0}),this.scroll=function Fx(l,t,e){const i=function(a){n||(n=window.requestAnimationFrame(function(){n=null;const h=l.scrollLeft,c=s.lastX;h!==c&&(s.right=h>c),s.lastX=h;const d=l.scrollTop,u=s.lastY;d!==u&&(s.down=d>u),s.lastY=d,t(s)}))},s={right:!0,down:!0,lastX:l.scrollLeft,lastY:l.scrollTop,_eventHandler:i};let n=null;return l.addEventListener("scroll",i,{useCapture:!0,signal:e}),e?.addEventListener("abort",()=>window.cancelAnimationFrame(n),{once:!0}),s}(this.container,this._scrollUpdate.bind(this),i),this.presentationModeState=0,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),p(this,au,H_).call(this),this.eventBus._on("thumbnailrendered",({pageNumber:s,pdfPage:n})=>{const a=this._pages[s-1];r(this,En).has(a)||n?.cleanup()}),t.l10n||this.l10n.translate(this.container)}get pagesCount(){return this._pages.length}getPageView(t){return this._pages[t]}getCachedPageViews(){return new Set(r(this,En))}get pageViewsReady(){return this._pages.every(t=>t?.pdfPage)}get renderForms(){return r(this,ba)===Hi.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(t){if(!Number.isInteger(t))throw new Error("Invalid page number.");!this.pdfDocument||this._setCurrentPageNumber(t,!0)||console.error(`currentPageNumber: "${t}" is not a valid page.`)}_setCurrentPageNumber(t,e=!1){if(this._currentPageNumber===t)return e&&p(this,ru,B_).call(this),!0;if(!(0<t&&t<=this.pagesCount))return!1;const i=this._currentPageNumber;return this._currentPageNumber=t,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:t,pageLabel:this._pageLabels?.[t-1]??null,previous:i}),e&&p(this,ru,B_).call(this),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(t){if(!this.pdfDocument)return;let e=0|t;if(this._pageLabels){const i=this._pageLabels.indexOf(t);i>=0&&(e=i+1)}this._setCurrentPageNumber(e,!0)||console.error(`currentPageLabel: "${t}" is not a valid page.`)}get currentScale(){return 0!==this._currentScale?this._currentScale:1}set currentScale(t){if(isNaN(t))throw new Error("Invalid numeric scale.");!this.pdfDocument||p(this,ki,Rn).call(this,t,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(t){!this.pdfDocument||p(this,ki,Rn).call(this,t,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!JA(t))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||((t%=360)<0&&(t+=360),this._pagesRotation===t))return;this._pagesRotation=t;const e=this._currentPageNumber;this.refresh(!0,{rotation:t}),this._currentScaleValue&&p(this,ki,Rn).call(this,this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:t,pageNumber:e}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){const t=this;return tf(this,"_layerProperties",{get annotationEditorUIManager(){return r(t,ye)},get annotationStorage(){return t.pdfDocument?.annotationStorage},get downloadManager(){return t.downloadManager},get enableScripting(){return!!t._scriptingManager},get fieldObjectsPromise(){return t.pdfDocument?.getFieldObjects()},get findController(){return t.findController},get hasJSActionsPromise(){return t.pdfDocument?.hasJSActions()},get linkService(){return t.linkService}})}getAllText(){var t=this;return(0,I.Z)(function*(){const e=[],i=[];for(let s=1,n=t.pdfDocument.numPages;s<=n;++s){if(r(t,yl))return null;i.length=0;const a=yield t.pdfDocument.getPage(s),{items:o}=yield a.getTextContent();for(const h of o)h.str&&i.push(h.str),h.hasEOL&&i.push("\n");e.push(Yu(i.join("")))}return e.join("\n")})()}setDocument(t){var e=this;if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),r(this,ye)?.destroy(),m(this,ye,null)),this.pdfDocument=t,!t)return;const i=t.numPages,s=t.getPage(1),n=t.getOptionalContentConfig({intent:"display"}),a=r(this,tu)?t.getPermissions():Promise.resolve(),{eventBus:o,pageColors:h,viewer:c}=this;m(this,xn,new AbortController);const{signal:d}=r(this,xn);if(i>1e4){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const b=this._scrollMode=Z.PAGE;o.dispatch("scrollmodechanged",{source:this,mode:b})}this._pagesCapability.promise.then(()=>{o.dispatch("pagesloaded",{source:this,pagesCount:i})},()=>{}),o._on("pagerender",b=>{const _=this._pages[b.pageNumber-1];!_||r(this,En).push(_)},{signal:d});const g=b=>{b.cssTransform||(this._onePageRenderedCapability.resolve({timestamp:b.timestamp}),o._off("pagerendered",g))};o._on("pagerendered",g,{signal:d}),Promise.all([s,a]).then(([b,_])=>{if(t!==this.pdfDocument)return;this._firstPageCapability.resolve(b),this._optionalContentConfigPromise=n;const{annotationEditorMode:A,annotationMode:v,textLayerMode:y}=p(this,bg,O0).call(this,_);if(0!==y){const S=m(this,Sn,document.createElement("div"));S.id="hiddenCopyElement",c.before(S)}if("function"==typeof AbortSignal.any&&A!==ue.DISABLE){const S=A;t.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):Oy(S)?(m(this,ye,new bC(this.container,c,r(this,Xd),o,t,h,r(this,Yd),r(this,Qd),r(this,eu),r(this,iu),r(this,_a))),o.dispatch("annotationeditoruimanager",{source:this,uiManager:r(this,ye)}),S!==ue.NONE&&(S===ue.STAMP&&r(this,_a)?.loadModel("altText"),r(this,ye).updateMode(S))):console.error(`Invalid AnnotationEditor mode: ${S}`)}const E=this._scrollMode===Z.PAGE?null:c,x=this.currentScale,C=b.getViewport({scale:x*Vi.PDF_TO_CSS_UNITS});c.style.setProperty("--scale-factor",C.scale),("CanvasText"===h?.foreground||"Canvas"===h?.background)&&(c.style.setProperty("--hcm-highlight-filter",t.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),c.style.setProperty("--hcm-highlight-selected-filter",t.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let S=1;S<=i;++S){const P=new Iy({container:E,eventBus:o,id:S,scale:x,defaultViewport:C.clone(),optionalContentConfigPromise:n,renderingQueue:this.renderingQueue,textLayerMode:y,annotationMode:v,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,pageColors:h,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:r(this,Jd)});this._pages.push(P)}this._pages[0]?.setPdfPage(b),this._scrollMode===Z.PAGE?p(this,va,Cu).call(this):this._spreadMode!==$t.NONE&&this._updateSpreadMode(),p(this,_g,F0).call(this,d).then((0,I.Z)(function*(){if(t!==e.pdfDocument)return;if(e.findController?.setDocument(t),e._scriptingManager?.setDocument(t),r(e,Sn)&&document.addEventListener("copy",p(e,Ag,N0).bind(e,y),{signal:d}),r(e,ye)&&o.dispatch("annotationeditormodechanged",{source:e,mode:r(e,Li)}),t.loadingParams.disableAutoFetch||i>5e3)return void e._pagesCapability.resolve();let S=i-1;if(S<=0)e._pagesCapability.resolve();else for(let P=2;P<=i;++P){const L=t.getPage(P).then(k=>{const w=e._pages[P-1];w.pdfPage||w.setPdfPage(k),0==--S&&e._pagesCapability.resolve()},k=>{console.error(`Unable to get page ${P} to initialize viewer`,k),0==--S&&e._pagesCapability.resolve()});P%250==0&&(yield L)}})),o.dispatch("pagesinit",{source:this}),t.getMetadata().then(({info:S})=>{t===this.pdfDocument&&S.Language&&(c.lang=S.Language)}),this.defaultRenderingQueue&&this.update()}).catch(b=>{console.error("Unable to initialize viewer",b),this._pagesCapability.reject(b)})}setPageLabels(t){if(this.pdfDocument){t?Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let e=0,i=this._pages.length;e<i;e++)this._pages[e].setPageLabel(this._pageLabels?.[e]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=0,this._currentScaleValue=null,this._pageLabels=null,m(this,En,new FS(10)),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=Z.VERTICAL,this._previousScrollMode=Z.UNKNOWN,this._spreadMode=$t.NONE,m(this,ya,{previousPageNumber:1,scrollDown:!0,pages:[]}),r(this,xn)?.abort(),m(this,xn,null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),r(this,Sn)?.remove(),m(this,Sn,null),p(this,xl,fm).call(this)}_scrollUpdate(){0!==this.pagesCount&&this.update()}pageLabelToPageNumber(t){if(!this._pageLabels)return null;const e=this._pageLabels.indexOf(t);return e<0?null:e+1}scrollPageIntoView({pageNumber:t,destArray:e=null,allowNegativeOffset:i=!1,ignoreDestinationZoom:s=!1}){if(!this.pdfDocument)return;const n=Number.isInteger(t)&&this._pages[t-1];if(!n)return void console.error(`scrollPageIntoView: "${t}" is not a valid pageNumber parameter.`);if(this.isInPresentationMode||!e)return void this._setCurrentPageNumber(t,!0);let d,u,a=0,o=0,h=0,c=0;const g=n.rotation%180!=0,b=(g?n.height:n.width)/n.scale/Vi.PDF_TO_CSS_UNITS,_=(g?n.width:n.height)/n.scale/Vi.PDF_TO_CSS_UNITS;let A=0;switch(e[1].name){case"XYZ":a=e[2],o=e[3],A=e[4],a=null!==a?a:0,o=null!==o?o:_;break;case"Fit":case"FitB":A="page-fit";break;case"FitH":case"FitBH":o=e[2],A="page-width",null===o&&this._location?(a=this._location.left,o=this._location.top):("number"!=typeof o||o<0)&&(o=_);break;case"FitV":case"FitBV":a=e[2],h=b,c=_,A="page-height";break;case"FitR":a=e[2],o=e[3],h=e[4]-a,c=e[5]-o;let x=40,C=5;this.removePageBorders&&(x=C=0),d=(this.container.clientWidth-x)/h/Vi.PDF_TO_CSS_UNITS,u=(this.container.clientHeight-C)/c/Vi.PDF_TO_CSS_UNITS,A=Math.min(Math.abs(d),Math.abs(u));break;default:return void console.error(`scrollPageIntoView: "${e[1].name}" is not a valid destination type.`)}if(s||(A&&A!==this._currentScale?this.currentScaleValue=A:0===this._currentScale&&(this.currentScaleValue="auto")),"page-fit"===A&&!e[4])return void p(this,El,um).call(this,n);const v=[n.viewport.convertToViewportPoint(a,o),n.viewport.convertToViewportPoint(a+h,o+c)];let y=Math.min(v[0][0],v[1][0]),E=Math.min(v[0][1],v[1][1]);i||(y=Math.max(y,0),E=Math.max(E,0)),p(this,El,um).call(this,n,{left:y,top:E})}_updateLocation(t){const e=this._currentScale,i=this._currentScaleValue,s=parseFloat(i)===e?Math.round(1e4*e)/100:i,n=t.id,o=this.container,h=this._pages[n-1].getPagePoint(o.scrollLeft-t.x,o.scrollTop-t.y),c=Math.round(h[0]),d=Math.round(h[1]);let u=`#page=${n}`;this.isInPresentationMode||(u+=`&zoom=${s},${c},${d}`),this._location={pageNumber:n,scale:s,top:d,left:c,rotation:this._pagesRotation,pdfOpenParams:u}}update(){const t=this._getVisiblePages(),e=t.views,i=e.length;if(0===i)return;const s=Math.max(10,2*i+1);r(this,En).resize(s,t.ids),this.renderingQueue.renderHighestPriority(t);const n=this._spreadMode===$t.NONE&&(this._scrollMode===Z.PAGE||this._scrollMode===Z.VERTICAL),a=this._currentPageNumber;let o=!1;for(const h of e){if(h.percent<100)break;if(h.id===a&&n){o=!0;break}}this._setCurrentPageNumber(o?a:e[0].id),this._updateLocation(t.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(t){return this.container.contains(t)}focus(){this.container.focus()}get _isContainerRtl(){return"rtl"===getComputedStyle(this.container).direction}get isInPresentationMode(){return 3===this.presentationModeState}get isChangingPresentationMode(){return 2===this.presentationModeState}get isHorizontalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const t=this._scrollMode===Z.PAGE?r(this,ya).pages:this._pages,e=this._scrollMode===Z.HORIZONTAL;return function Bx({scrollEl:l,views:t,sortByVisibility:e=!1,horizontal:i=!1,rtl:s=!1}){const n=l.scrollTop,a=n+l.clientHeight,o=l.scrollLeft,h=o+l.clientWidth,u=[],g=new Set,b=t.length;let _=Zl(t,i?function d(E){const x=E.div,C=x.offsetLeft+x.clientLeft;return s?C<h:C+x.clientWidth>o}:function c(E){const x=E.div;return x.offsetTop+x.clientTop+x.clientHeight>n});_>0&&_<b&&!i&&(_=function Nx(l,t,e){if(l<2)return l;let i=t[l].div,s=i.offsetTop+i.clientTop;s>=e&&(i=t[l-1].div,s=i.offsetTop+i.clientTop);for(let n=l-2;n>=0&&(i=t[n].div,!(i.offsetTop+i.clientTop+i.clientHeight<=s));--n)l=n;return l}(_,t,n));let A=i?h:-1;for(let E=_;E<b;E++){const x=t[E],C=x.div,S=C.offsetLeft+C.clientLeft,P=C.offsetTop+C.clientTop,L=C.clientWidth,k=C.clientHeight,w=S+L,T=P+k;if(-1===A)T>=a&&(A=T);else if((i?S:P)>A)break;if(T<=n||P>=a||w<=o||S>=h)continue;const D=Math.max(0,n-P)+Math.max(0,T-a),W=(L-(Math.max(0,o-S)+Math.max(0,w-h)))/L;u.push({id:x.id,x:S,y:P,view:x,percent:(k-D)/k*W*100|0,widthPercent:100*W|0}),g.add(x.id)}const v=u[0],y=u.at(-1);return e&&u.sort(function(E,x){const C=E.percent-x.percent;return Math.abs(C)>.001?-C:E.id-x.id}),{first:v,last:y,views:u,ids:g}}({scrollEl:this.container,views:t,sortByVisibility:!0,horizontal:e,rtl:e&&this._isContainerRtl})}cleanup(){for(const t of this._pages)t.renderingState!==ct.FINISHED&&t.reset()}_cancelRendering(){for(const t of this._pages)t.cancelRendering()}forceRendering(t){const e=t||this._getVisiblePages(),i=p(this,xg,U0).call(this,e),n=this.renderingQueue.getHighestPriority(e,this._pages,i,this._spreadMode!==$t.NONE&&this._scrollMode!==Z.HORIZONTAL);return!!n&&(p(this,Eg,j0).call(this,n).then(()=>{this.renderingQueue.renderView(n)}),!0)}get hasEqualPageSizes(){const t=this._pages[0];for(let e=1,i=this._pages.length;e<i;++e){const s=this._pages[e];if(s.width!==t.width||s.height!==t.height)return!1}return!0}getPagesOverview(){let t;return this._pages.map(e=>{const i=e.pdfPage.getViewport({scale:1}),s=QA(i);if(void 0===t)t=s;else if(this.enablePrintAutoRotate&&s!==t)return{width:i.height,height:i.width,rotation:(i.rotation-90)%360};return{width:i.width,height:i.height,rotation:i.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(t){if(!(t instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${t}`);!this.pdfDocument||!this._optionalContentConfigPromise||(this._optionalContentConfigPromise=t,this.refresh(!1,{optionalContentConfigPromise:t}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:t}))}get scrollMode(){return this._scrollMode}set scrollMode(t){if(this._scrollMode!==t){if(!function Vx(l){return Number.isInteger(l)&&Object.values(Z).includes(l)&&l!==Z.UNKNOWN}(t))throw new Error(`Invalid scroll mode: ${t}`);this.pagesCount>1e4||(this._previousScrollMode=this._scrollMode,this._scrollMode=t,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:t}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(t=null){const e=this._scrollMode,i=this.viewer;i.classList.toggle("scrollHorizontal",e===Z.HORIZONTAL),i.classList.toggle("scrollWrapped",e===Z.WRAPPED),this.pdfDocument&&t&&(e===Z.PAGE?p(this,va,Cu).call(this):this._previousScrollMode===Z.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&p(this,ki,Rn).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(t){if(this._spreadMode!==t){if(!function jx(l){return Number.isInteger(l)&&Object.values($t).includes(l)&&l!==$t.UNKNOWN}(t))throw new Error(`Invalid spread mode: ${t}`);this._spreadMode=t,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:t}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(t=null){if(!this.pdfDocument)return;const e=this.viewer,i=this._pages;if(this._scrollMode===Z.PAGE)p(this,va,Cu).call(this);else if(e.textContent="",this._spreadMode===$t.NONE)for(const s of this._pages)e.append(s.div);else{const s=this._spreadMode-1;let n=null;for(let a=0,o=i.length;a<o;++a)null===n?(n=document.createElement("div"),n.className="spread",e.append(n)):a%2===s&&(n=n.cloneNode(!1),e.append(n)),n.append(i[a].div)}!t||(this._currentScaleValue&&isNaN(this._currentScaleValue)&&p(this,ki,Rn).call(this,this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}_getPageAdvance(t,e=!1){switch(this._scrollMode){case Z.WRAPPED:{const{views:i}=this._getVisiblePages(),s=new Map;for(const{id:n,y:a,percent:o,widthPercent:h}of i){if(0===o||h<100)continue;let c=s.get(a);c||s.set(a,c||(c=[])),c.push(n)}for(const n of s.values()){const a=n.indexOf(t);if(-1===a)continue;const o=n.length;if(1===o)break;if(e)for(let h=a-1,c=0;h>=c;h--){const u=n[h+1]-1;if(n[h]<u)return t-u}else for(let h=a+1,c=o;h<c;h++){const u=n[h-1]+1;if(n[h]>u)return u-t}if(e){const h=n[0];if(h<t)return t-h+1}else{const h=n[o-1];if(h>t)return h-t+1}break}break}case Z.HORIZONTAL:break;case Z.PAGE:case Z.VERTICAL:{if(this._spreadMode===$t.NONE)break;const i=this._spreadMode-1;if(e&&t%2!==i)break;if(!e&&t%2===i)break;const{views:s}=this._getVisiblePages(),n=e?t-1:t+1;for(const{id:a,percent:o,widthPercent:h}of s)if(a===n){if(o>0&&100===h)return 2;break}break}}return 1}nextPage(){const t=this._currentPageNumber,e=this.pagesCount;if(t>=e)return!1;const i=this._getPageAdvance(t,!1)||1;return this.currentPageNumber=Math.min(t+i,e),!0}previousPage(){const t=this._currentPageNumber;if(t<=1)return!1;const e=this._getPageAdvance(t,!0)||1;return this.currentPageNumber=Math.max(t-e,1),!0}updateScale({drawingDelay:t,scaleFactor:e=null,steps:i=null,origin:s}){if(null===i&&null===e)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let n=this._currentScale;if(e>0&&1!==e)n=Math.round(n*e*100)/100;else if(i){const a=i>0?1.1:1/1.1,o=i>0?Math.ceil:Math.floor;i=Math.abs(i);do{n=o(10*(n*a).toFixed(2))/10}while(--i>0)}n=Math.max(.1,Math.min(10,n)),p(this,ki,Rn).call(this,n,{noScroll:!1,drawingDelay:t,origin:s})}increaseScale(t={}){this.updateScale({...t,steps:t.steps??1})}decreaseScale(t={}){this.updateScale({...t,steps:-(t.steps??1)})}get containerTopLeft(){return r(this,Zd)||m(this,Zd,[this.container.offsetTop,this.container.offsetLeft])}get annotationEditorMode(){return r(this,ye)?r(this,Li):ue.DISABLE}set annotationEditorMode({mode:t,editId:e=null,isFromKeyboard:i=!1}){if(!r(this,ye))throw new Error("The AnnotationEditor is not enabled.");if(r(this,Li)===t)return;if(!Oy(t))throw new Error(`Invalid AnnotationEditor mode: ${t}`);if(!this.pdfDocument)return;t===ue.STAMP&&r(this,_a)?.loadModel("altText");const{eventBus:s}=this,n=()=>{p(this,xl,fm).call(this),m(this,Li,t),r(this,ye).updateMode(t,e,i),s.dispatch("annotationeditormodechanged",{source:this,mode:t})};if(t===ue.NONE||r(this,Li)===ue.NONE){const a=t!==ue.NONE;a||this.pdfDocument.annotationStorage.resetModifiedIds();for(const h of this._pages)h.toggleEditingMode(a);const o=p(this,wg,V0).call(this);if(a&&o){p(this,xl,fm).call(this),m(this,Cn,({pageNumber:c})=>{o.delete(c),0===o.size&&m(this,Aa,setTimeout(n,0))});const{signal:h}=r(this,xn);return void s._on("pagerendered",r(this,Cn),{signal:h})}}n()}refresh(t=!1,e=Object.create(null)){if(this.pdfDocument){for(const i of this._pages)i.update(e);null!==r(this,Pn)&&(clearTimeout(r(this,Pn)),m(this,Pn,null)),t||this.update()}}}En=new WeakMap,Xd=new WeakMap,Yd=new WeakMap,Li=new WeakMap,ye=new WeakMap,ba=new WeakMap,Zd=new WeakMap,Jd=new WeakMap,Qd=new WeakMap,tu=new WeakMap,eu=new WeakMap,iu=new WeakMap,xn=new WeakMap,_a=new WeakMap,Cn=new WeakMap,Aa=new WeakMap,Al=new WeakMap,Sn=new WeakMap,yl=new WeakMap,su=new WeakMap,vl=new WeakMap,ya=new WeakMap,Pn=new WeakMap,wl=new WeakMap,bg=new WeakSet,O0=function(t){const e={annotationEditorMode:r(this,Li),annotationMode:r(this,ba),textLayerMode:r(this,wl)};return t&&(!t.includes(Qu.COPY)&&1===r(this,wl)&&(e.textLayerMode=2),t.includes(Qu.MODIFY_CONTENTS)||(e.annotationEditorMode=ue.DISABLE),!t.includes(Qu.MODIFY_ANNOTATIONS)&&!t.includes(Qu.FILL_INTERACTIVE_FORMS)&&r(this,ba)===Hi.ENABLE_FORMS&&(e.annotationMode=Hi.ENABLE)),e},_g=new WeakSet,F0=function(t){var e=this;return(0,I.Z)(function*(){if("hidden"===document.visibilityState||!e.container.offsetParent||0===e._getVisiblePages().views.length)return;const i=Promise.withResolvers();function s(){"hidden"===document.visibilityState&&i.resolve()}document.addEventListener("visibilitychange",s,{signal:t}),yield Promise.race([e._onePageRenderedCapability.promise,i.promise]),document.removeEventListener("visibilitychange",s)})()},Ag=new WeakSet,N0=function(t,e){const i=document.getSelection(),{focusNode:s,anchorNode:n}=i;if(n&&s&&i.containsNode(r(this,Sn))){if(r(this,Al)||2===t)return e.preventDefault(),void e.stopPropagation();m(this,Al,!0);const{classList:a}=this.viewer;a.add("copyAll");const o=new AbortController;window.addEventListener("keydown",h=>m(this,yl,"Escape"===h.key),{signal:o.signal}),this.getAllText().then(function(){var h=(0,I.Z)(function*(c){null!==c&&(yield navigator.clipboard.writeText(c))});return function(c){return h.apply(this,arguments)}}()).catch(h=>{console.warn(`Something goes wrong when extracting the text: ${h.message}`)}).finally(()=>{m(this,Al,!1),m(this,yl,!1),o.abort(),a.remove("copyAll")}),e.preventDefault(),e.stopPropagation()}},va=new WeakSet,Cu=function(){if(this._scrollMode!==Z.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const t=this._currentPageNumber,e=r(this,ya),i=this.viewer;if(i.textContent="",e.pages.length=0,this._spreadMode!==$t.NONE||this.isInPresentationMode){const s=new Set,n=this._spreadMode-1;-1===n?s.add(t-1):t%2!==n?(s.add(t-1),s.add(t)):(s.add(t-2),s.add(t-1));const a=document.createElement("div");if(a.className="spread",this.isInPresentationMode){const o=document.createElement("div");o.className="dummyPage",a.append(o)}for(const o of s){const h=this._pages[o];!h||(a.append(h.div),e.pages.push(h))}i.append(a)}else{const s=this._pages[t-1];i.append(s.div),e.pages.push(s)}e.scrollDown=t>=e.previousPageNumber,e.previousPageNumber=t},El=new WeakSet,um=function(t,e=null){const{div:i,id:s}=t;if(this._currentPageNumber!==s&&this._setCurrentPageNumber(s),this._scrollMode===Z.PAGE&&(p(this,va,Cu).call(this),this.update()),!e&&!this.isInPresentationMode){const n=i.offsetLeft+i.clientLeft,a=n+i.clientWidth,{scrollLeft:o,clientWidth:h}=this.container;(this._scrollMode===Z.HORIZONTAL||n<o||a>o+h)&&(e={left:0,top:0})}XA(i,e),!this._currentScaleValue&&this._location&&(this._location=null)},yg=new WeakSet,B0=function(t){return t===this._currentScale||Math.abs(t-this._currentScale)<1e-15},nu=new WeakSet,N_=function(t,e,{noScroll:i=!1,preset:s=!1,drawingDelay:n=-1,origin:a=null}){if(this._currentScaleValue=e.toString(),p(this,yg,B0).call(this,t))return void(s&&this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:e}));this.viewer.style.setProperty("--scale-factor",t*Vi.PDF_TO_CSS_UNITS);const o=n>=0&&n<1e3;this.refresh(!0,{scale:t,drawingDelay:o?n:-1}),o&&m(this,Pn,setTimeout(()=>{m(this,Pn,null),this.refresh()},n));const h=this._currentScale;if(this._currentScale=t,!i){let d,c=this._currentPageNumber;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(c=this._location.pageNumber,d=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:c,destArray:d,allowNegativeOffset:!0}),Array.isArray(a)){const u=t/h-1,[g,b]=this.containerTopLeft;this.container.scrollLeft+=(a[0]-b)*u,this.container.scrollTop+=(a[1]-g)*u}}this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:s?e:void 0}),this.defaultRenderingQueue&&this.update()},vg=new WeakSet,H0=function(){return this._spreadMode!==$t.NONE&&this._scrollMode!==Z.HORIZONTAL?2:1},ki=new WeakSet,Rn=function(t,e){let i=parseFloat(t);if(i>0)e.preset=!1,p(this,nu,N_).call(this,i,t,e);else{const s=this._pages[this._currentPageNumber-1];if(!s)return;let n=40,a=5;this.isInPresentationMode?(n=a=4,this._spreadMode!==$t.NONE&&(n*=2)):this.removePageBorders?n=a=0:this._scrollMode===Z.HORIZONTAL&&([n,a]=[a,n]);const o=(this.container.clientWidth-n)/s.width*s.scale/r(this,vg,H0),h=(this.container.clientHeight-a)/s.height*s.scale;switch(t){case"page-actual":i=1;break;case"page-width":i=o;break;case"page-height":i=h;break;case"page-fit":i=Math.min(o,h);break;case"auto":const c=QA(s)?o:Math.min(h,o);i=Math.min(1.25,c);break;default:return void console.error(`#setScale: "${t}" is an unknown zoom value.`)}e.preset=!0,p(this,nu,N_).call(this,i,t,e)}},ru=new WeakSet,B_=function(){const t=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&p(this,ki,Rn).call(this,this._currentScaleValue,{noScroll:!0}),p(this,El,um).call(this,t)},wg=new WeakSet,V0=function(){const t=this._getVisiblePages(),e=[],{ids:i,views:s}=t;for(const n of s){const{view:a}=n;a.hasEditableAnnotations()?e.push(n):i.delete(a.id)}return 0===e.length?null:(this.renderingQueue.renderHighestPriority({first:e[0],last:e.at(-1),views:e,ids:i}),i)},Eg=new WeakSet,j0=function(t){var e=this;return(0,I.Z)(function*(){if(t.pdfPage)return t.pdfPage;try{const i=yield e.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(i),i}catch(i){return console.error("Unable to get page for page view",i),null}})()},xg=new WeakSet,U0=function(t){if(1===t.first?.id)return!0;if(t.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case Z.PAGE:return r(this,ya).scrollDown;case Z.HORIZONTAL:return this.scroll.right}return this.scroll.down},au=new WeakSet,H_=function(t=this.container.clientHeight){t!==r(this,su)&&(m(this,su,t),Ux.setProperty("--viewer-container-height",`${t}px`))},Cg=new WeakSet,z0=function(t){for(const e of t)if(e.target===this.container){p(this,au,H_).call(this,Math.floor(e.borderBoxSize[0].blockSize)),m(this,Zd,null);break}},xl=new WeakSet,fm=function(){r(this,Cn)&&(this.eventBus._off("pagerendered",r(this,Cn)),m(this,Cn,null)),null!==r(this,Aa)&&(clearTimeout(r(this,Aa)),m(this,Aa,null))};class NS extends Fy{_resetView(){super._resetView(),this._scrollMode=Z.PAGE,this._spreadMode=$t.NONE}set scrollMode(t){}_updateScrollMode(){}set spreadMode(t){}_updateSpreadMode(){}}var BS=lt.AnnotationLayerBuilder,HS=lt.DownloadManager,VS=lt.EventBus,jS=lt.FindState,Ny=lt.GenericL10n,ka=lt.LinkTarget,By=lt.PDFFindController,US=lt.PDFHistory,Hy=lt.PDFLinkService,zS=lt.PDFPageView,WS=lt.PDFScriptingManager,Vy=lt.PDFSinglePageViewer,jy=lt.PDFViewer,GS=lt.ProgressBar,$S=lt.RenderingStates,qS=lt.ScrollMode,KS=lt.SimpleLinkService,XS=lt.SpreadMode,YS=lt.StructTreeLayerBuilder,ZS=lt.TextLayerBuilder,JS=lt.XfaLayerBuilder,QS=lt.parseQueryString;const tP=["pdfViewerContainer"];function sb(l,t,e){l[t]=e}function sh(){return typeof window>"u"}sh()||sb(q,"verbosity",VA.INFOS),typeof Promise.withResolvers>"u"&&window&&(window.Promise.withResolvers=()=>{let l,t;return{promise:new Promise((i,s)=>{l=i,t=s}),resolve:l,reject:t}});var nh=(()=>{return(l=nh||(nh={}))[l.DISABLED=0]="DISABLED",l[l.ENABLED=1]="ENABLED",l[l.ENHANCED=2]="ENHANCED",nh;var l})();const Tn=class{constructor(t,e){if(R(this,"element"),R(this,"ngZone"),R(this,"pdfViewerContainer"),R(this,"eventBus"),R(this,"pdfLinkService"),R(this,"pdfFindController"),R(this,"pdfViewer"),R(this,"isVisible",!1),R(this,"_cMapsUrl",typeof q<"u"?`https://unpkg.com/pdfjs-dist@${qu}/cmaps/`:null),R(this,"_imageResourcesPath",typeof q<"u"?`https://unpkg.com/pdfjs-dist@${qu}/web/images/`:void 0),R(this,"_renderText",!0),R(this,"_renderTextMode",nh.ENABLED),R(this,"_stickToPage",!1),R(this,"_originalSize",!0),R(this,"_pdf"),R(this,"_page",1),R(this,"_zoom",1),R(this,"_zoomScale","page-width"),R(this,"_rotation",0),R(this,"_showAll",!0),R(this,"_canAutoResize",!0),R(this,"_fitToPage",!1),R(this,"_externalLinkTarget","blank"),R(this,"_showBorders",!1),R(this,"lastLoaded"),R(this,"_latestScrolledPage"),R(this,"pageScrollTimeout",null),R(this,"isInitialized",!1),R(this,"loadingTask"),R(this,"destroy$",new ti.x),R(this,"afterLoadComplete",new nt.vpe),R(this,"pageRendered",new nt.vpe),R(this,"pageInitialized",new nt.vpe),R(this,"textLayerRendered",new nt.vpe),R(this,"onError",new nt.vpe),R(this,"onProgress",new nt.vpe),R(this,"pageChange",new nt.vpe(!0)),R(this,"src"),this.element=t,this.ngZone=e,sh())return;let i;const s=qu;i=window[`pdfWorkerSrc${s}`]||(window.hasOwnProperty("pdfWorkerSrc")&&"string"==typeof window.pdfWorkerSrc&&window.pdfWorkerSrc?window.pdfWorkerSrc:`https://cdn.jsdelivr.net/npm/pdfjs-dist@${s}/legacy/build/pdf.worker.min.mjs`),sb(HA,"workerSrc",i)}set cMapsUrl(t){this._cMapsUrl=t}set page(t){const e=t=parseInt(t,10)||1;this._pdf&&(t=this.getValidPageNumber(t)),this._page=t,e!==t&&this.pageChange.emit(t)}set renderText(t){this._renderText=t}set renderTextMode(t){this._renderTextMode=t}set originalSize(t){this._originalSize=t}set showAll(t){this._showAll=t}set stickToPage(t){this._stickToPage=t}set zoom(t){t<=0||(this._zoom=t)}get zoom(){return this._zoom}set zoomScale(t){this._zoomScale=t}get zoomScale(){return this._zoomScale}set rotation(t){"number"==typeof t&&t%90==0?this._rotation=t:console.warn("Invalid pages rotation angle.")}set externalLinkTarget(t){this._externalLinkTarget=t}set autoresize(t){this._canAutoResize=Boolean(t)}set fitToPage(t){this._fitToPage=Boolean(t)}set showBorders(t){this._showBorders=Boolean(t)}static getLinkTarget(t){switch(t){case"blank":return ka.BLANK;case"none":return ka.NONE;case"self":return ka.SELF;case"parent":return ka.PARENT;case"top":return ka.TOP}return null}ngAfterViewChecked(){if(this.isInitialized)return;const t=this.pdfViewerContainer.nativeElement.offsetParent;!0!==this.isVisible||null!=t?!1===this.isVisible&&null!=t&&(this.isVisible=!0,setTimeout(()=>{this.initialize(),this.ngOnChanges({src:this.src})})):this.isVisible=!1}ngOnInit(){this.initialize(),this.setupResizeListener()}ngOnDestroy(){this.clear(),this.destroy$.next(),this.loadingTask=null}ngOnChanges(t){if(!sh()&&this.isVisible)if("src"in t)this.loadPDF();else if(this._pdf){if(("renderText"in t||"showAll"in t)&&(this.setupViewer(),this.resetPdfDocument()),"page"in t){const{page:e}=t;if(e.currentValue===this._latestScrolledPage)return;this.pdfViewer.scrollPageIntoView({pageNumber:this._page})}this.update()}}updateSize(){(0,ei.D)(this._pdf.getPage(this.pdfViewer.currentPageNumber)).pipe((0,st.R)(this.destroy$)).subscribe({next:t=>{const e=this._rotation+t.rotate,i=t.getViewport({scale:this._zoom,rotation:e}).width*Tn.CSS_UNITS;let s=this._zoom,n=!0;if(!this._originalSize||this._fitToPage&&i>this.pdfViewerContainer.nativeElement.clientWidth){const a=t.getViewport({scale:1,rotation:e});s=this.getScale(a.width,a.height),n=!this._stickToPage}this.pdfViewer.pagesPromise?.then(()=>{this.pdfViewer.currentScale=s,n&&this.pdfViewer.scrollPageIntoView({pageNumber:t.pageNumber,ignoreDestinationZoom:!0})})}})}clear(){this.loadingTask&&!this.loadingTask.destroyed&&this.loadingTask.destroy(),this._pdf&&(this._latestScrolledPage=0,this._pdf.destroy(),this._pdf=void 0),this.pdfViewer&&this.pdfViewer.setDocument(null),this.pdfLinkService&&this.pdfLinkService.setDocument(null,null),this.pdfFindController&&this.pdfFindController.setDocument(null)}getPDFLinkServiceConfig(){const t=Tn.getLinkTarget(this._externalLinkTarget);return t?{externalLinkTarget:t}:{}}initEventBus(){this.eventBus=function eP(l,t){const e=new l.EventBus;return function iP(l,t){(0,rt.R)(l,"documentload").pipe((0,st.R)(t)).subscribe(()=>{const e=document.createEvent("CustomEvent");e.initCustomEvent("documentload",!0,!0,{}),window.dispatchEvent(e)}),(0,rt.R)(l,"pagerendered").pipe((0,st.R)(t)).subscribe(({pageNumber:e,cssTransform:i,source:s})=>{const n=document.createEvent("CustomEvent");n.initCustomEvent("pagerendered",!0,!0,{pageNumber:e,cssTransform:i}),s.div.dispatchEvent(n)}),(0,rt.R)(l,"textlayerrendered").pipe((0,st.R)(t)).subscribe(({pageNumber:e,source:i})=>{const s=document.createEvent("CustomEvent");s.initCustomEvent("textlayerrendered",!0,!0,{pageNumber:e}),i.textLayerDiv?.dispatchEvent(s)}),(0,rt.R)(l,"pagechanging").pipe((0,st.R)(t)).subscribe(({pageNumber:e,source:i})=>{const s=document.createEvent("UIEvents");s.initEvent("pagechanging",!0,!0),s.pageNumber=e,i.container.dispatchEvent(s)}),(0,rt.R)(l,"pagesinit").pipe((0,st.R)(t)).subscribe(({source:e})=>{const i=document.createEvent("CustomEvent");i.initCustomEvent("pagesinit",!0,!0,null),e.container.dispatchEvent(i)}),(0,rt.R)(l,"pagesloaded").pipe((0,st.R)(t)).subscribe(({pagesCount:e,source:i})=>{const s=document.createEvent("CustomEvent");s.initCustomEvent("pagesloaded",!0,!0,{pagesCount:e}),i.container.dispatchEvent(s)}),(0,rt.R)(l,"scalechange").pipe((0,st.R)(t)).subscribe(({scale:e,presetValue:i,source:s})=>{const n=document.createEvent("UIEvents");n.initEvent("scalechange",!0,!0),n.scale=e,n.presetValue=i,s.container.dispatchEvent(n)}),(0,rt.R)(l,"updateviewarea").pipe((0,st.R)(t)).subscribe(({location:e,source:i})=>{const s=document.createEvent("UIEvents");s.initEvent("updateviewarea",!0,!0),s.location=e,i.container.dispatchEvent(s)}),(0,rt.R)(l,"find").pipe((0,st.R)(t)).subscribe(({source:e,type:i,query:s,phraseSearch:n,caseSensitive:a,highlightAll:o,findPrevious:h})=>{if(e===window)return;const c=document.createEvent("CustomEvent");c.initCustomEvent("find"+i,!0,!0,{query:s,phraseSearch:n,caseSensitive:a,highlightAll:o,findPrevious:h}),window.dispatchEvent(c)}),(0,rt.R)(l,"attachmentsloaded").pipe((0,st.R)(t)).subscribe(({attachmentsCount:e,source:i})=>{const s=document.createEvent("CustomEvent");s.initCustomEvent("attachmentsloaded",!0,!0,{attachmentsCount:e}),i.container.dispatchEvent(s)}),(0,rt.R)(l,"sidebarviewchanged").pipe((0,st.R)(t)).subscribe(({view:e,source:i})=>{const s=document.createEvent("CustomEvent");s.initCustomEvent("sidebarviewchanged",!0,!0,{view:e}),i.outerContainer.dispatchEvent(s)}),(0,rt.R)(l,"pagemode").pipe((0,st.R)(t)).subscribe(({mode:e,source:i})=>{const s=document.createEvent("CustomEvent");s.initCustomEvent("pagemode",!0,!0,{mode:e}),i.pdfViewer.container.dispatchEvent(s)}),(0,rt.R)(l,"namedaction").pipe((0,st.R)(t)).subscribe(({action:e,source:i})=>{const s=document.createEvent("CustomEvent");s.initCustomEvent("namedaction",!0,!0,{action:e}),i.pdfViewer.container.dispatchEvent(s)}),(0,rt.R)(l,"presentationmodechanged").pipe((0,st.R)(t)).subscribe(({active:e,switchInProgress:i})=>{const s=document.createEvent("CustomEvent");s.initCustomEvent("presentationmodechanged",!0,!0,{active:e,switchInProgress:i}),window.dispatchEvent(s)}),(0,rt.R)(l,"outlineloaded").pipe((0,st.R)(t)).subscribe(({outlineCount:e,source:i})=>{const s=document.createEvent("CustomEvent");s.initCustomEvent("outlineloaded",!0,!0,{outlineCount:e}),i.container.dispatchEvent(s)})}(e,t),e}(Ri,this.destroy$),(0,rt.R)(this.eventBus,"pagerendered").pipe((0,st.R)(this.destroy$)).subscribe(t=>{this.pageRendered.emit(t)}),(0,rt.R)(this.eventBus,"pagesinit").pipe((0,st.R)(this.destroy$)).subscribe(t=>{this.pageInitialized.emit(t)}),(0,rt.R)(this.eventBus,"pagechanging").pipe((0,st.R)(this.destroy$)).subscribe(({pageNumber:t})=>{this.pageScrollTimeout&&clearTimeout(this.pageScrollTimeout),this.pageScrollTimeout=window.setTimeout(()=>{this._latestScrolledPage=t,this.pageChange.emit(t)},100)}),(0,rt.R)(this.eventBus,"textlayerrendered").pipe((0,st.R)(this.destroy$)).subscribe(t=>{this.textLayerRendered.emit(t)})}initPDFServices(){this.pdfLinkService=new Hy({eventBus:this.eventBus,...this.getPDFLinkServiceConfig()}),this.pdfFindController=new By({eventBus:this.eventBus,linkService:this.pdfLinkService})}getPDFOptions(){return{eventBus:this.eventBus,container:this.element.nativeElement.querySelector("div"),removePageBorders:!this._showBorders,linkService:this.pdfLinkService,textLayerMode:this._renderText?this._renderTextMode:nh.DISABLED,findController:this.pdfFindController,l10n:new Ny("en"),imageResourcesPath:this._imageResourcesPath,annotationEditorMode:BA.DISABLE}}setupViewer(){this.pdfViewer&&this.pdfViewer.setDocument(null),sb(q,"disableTextLayer",!this._renderText),this.initPDFServices(),this.pdfViewer=this._showAll?new jy(this.getPDFOptions()):new Vy(this.getPDFOptions()),this.pdfLinkService.setViewer(this.pdfViewer),this.pdfViewer._currentPageNumber=this._page}getValidPageNumber(t){return t<1?1:t>this._pdf.numPages?this._pdf.numPages:t}getDocumentParams(){const t=typeof this.src;if(!this._cMapsUrl)return this.src;const e={cMapUrl:this._cMapsUrl,cMapPacked:!0,enableXfa:!0,isEvalSupported:!1};return"string"===t?e.url=this.src:"object"===t&&(void 0!==this.src.byteLength?e.data=this.src:Object.assign(e,this.src)),e}loadPDF(){if(!this.src)return;if(this.lastLoaded===this.src)return void this.update();this.clear(),this.setupViewer(),this.loadingTask=jA(this.getDocumentParams()),this.loadingTask.onProgress=e=>{this.onProgress.emit(e)};const t=this.src;(0,ei.D)(this.loadingTask.promise).pipe((0,st.R)(this.destroy$)).subscribe({next:e=>{this._pdf=e,this.lastLoaded=t,this.afterLoadComplete.emit(e),this.resetPdfDocument(),this.update()},error:e=>{this.lastLoaded=null,this.onError.emit(e)}})}update(){this.page=this._page,this.render()}render(){this._page=this.getValidPageNumber(this._page),(0!==this._rotation||this.pdfViewer.pagesRotation!==this._rotation)&&this.pdfViewer.firstPagePromise?.then(()=>this.pdfViewer.pagesRotation=this._rotation),this._stickToPage&&setTimeout(()=>{this.pdfViewer.currentPageNumber=this._page}),this.updateSize()}getScale(t,e){const i=this._showBorders?2*Tn.BORDER_WIDTH:0,s=this.pdfViewerContainer.nativeElement.clientWidth-i,n=this.pdfViewerContainer.nativeElement.clientHeight-i;if(0===n||0===e||0===s||0===t)return 1;let a=1;switch(this._zoomScale){case"page-fit":a=Math.min(n/e,s/t);break;case"page-height":a=n/e;break;default:a=s/t}return this._zoom*a/Tn.CSS_UNITS}resetPdfDocument(){this.pdfLinkService.setDocument(this._pdf,null),this.pdfFindController.setDocument(this._pdf),this.pdfViewer.setDocument(this._pdf)}initialize(){sh()||!this.isVisible||(this.isInitialized=!0,this.initEventBus(),this.setupViewer())}setupResizeListener(){sh()||this.ngZone.runOutsideAngular(()=>{(0,rt.R)(window,"resize").pipe(function W0(l,t=vs.z){return(0,ws.e)((e,i)=>{let s=null,n=null,a=null;const o=()=>{if(s){s.unsubscribe(),s=null;const c=n;n=null,i.next(c)}};function h(){const c=a+l,d=t.now();if(d<c)return s=this.schedule(void 0,c-d),void i.add(s);o()}e.subscribe((0,V_.x)(i,c=>{n=c,a=t.now(),s||(s=t.schedule(h,l),i.add(s))},()=>{o(),i.complete()},void 0,()=>{n=s=null}))})}(100),(0,G0.h)(()=>this._canAutoResize&&!!this._pdf),(0,st.R)(this.destroy$)).subscribe(()=>{this.updateSize()})})}};let jn=Tn;R(jn,"CSS_UNITS",96/72),R(jn,"BORDER_WIDTH",9),R(jn,"\u0275fac",function(e){return new(e||Tn)(nt.Y36(nt.SBq),nt.Y36(nt.R0b))}),R(jn,"\u0275cmp",nt.Xpm({type:Tn,selectors:[["pdf-viewer"]],viewQuery:function(e,i){if(1&e&&nt.Gf(tP,5),2&e){let s;nt.iGM(s=nt.CRH())&&(i.pdfViewerContainer=s.first)}},inputs:{src:"src",cMapsUrl:["c-maps-url","cMapsUrl"],page:"page",renderText:["render-text","renderText"],renderTextMode:["render-text-mode","renderTextMode"],originalSize:["original-size","originalSize"],showAll:["show-all","showAll"],stickToPage:["stick-to-page","stickToPage"],zoom:"zoom",zoomScale:["zoom-scale","zoomScale"],rotation:"rotation",externalLinkTarget:["external-link-target","externalLinkTarget"],autoresize:"autoresize",fitToPage:["fit-to-page","fitToPage"],showBorders:["show-borders","showBorders"]},outputs:{afterLoadComplete:"after-load-complete",pageRendered:"page-rendered",pageInitialized:"pages-initialized",textLayerRendered:"text-layer-rendered",onError:"error",onProgress:"on-progress",pageChange:"pageChange"},features:[nt.TTD],decls:3,vars:0,consts:[[1,"ng2-pdf-viewer-container"],["pdfViewerContainer",""],[1,"pdfViewer"]],template:function(e,i){1&e&&(nt.TgZ(0,"div",0,1),nt._UZ(2,"div",2),nt.qZA())},styles:['.ng2-pdf-viewer-container[_ngcontent-%COMP%]{overflow-x:auto;position:absolute;height:100%;width:100%;-webkit-overflow-scrolling:touch}[_nghost-%COMP%]{display:block;position:relative}[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 0;--page-margin: 1px auto -8px;--page-border: 9px solid transparent;--spreadHorizontalWrapped-margin-LR: -3.5px;--viewer-container-height: 0;--annotation-unfocused-field-background: url("data:image/svg+xml;charset=UTF-8,<svg width=\'1px\' height=\'1px\' xmlns=\'http://www.w3.org/2000/svg\'><rect width=\'100%\' height=\'100%\' style=\'fill:rgba(0, 54, 255, 0.13);\'/></svg>");--xfa-unfocused-field-background: var( --annotation-unfocused-field-background );--page-border-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAA1ElEQVQ4jbWUWw6EIAxFy2NFs/8NzR4UJhpqLsdi5mOmSSMUOfYWqv3S0gMr4XlYH/64gZa/gN3ANYA7KAXALt4ktoQ5MI9YxqaG8bWmsIysMuT6piSQCa4whZThCu8CM4zP9YJaKci9jicPq3NcBWYoPMGUlhG7ivtkB+gVyFY75wXghOvh8t5mto1Mdim6e+MBqH6XsY+YAwjpq3vGF7weTWQptLEDVCZvPTMl5JZZsdh47FHW6qFMyvLYqjcnmdFfY9Xk/KDOlzCusX2mi/ofM7MPkzBcSp4Q1/wAAAAASUVORK5CYII=) 9 9 repeat;--scale-factor: 1;--focus-outline: solid 2px blue;--hover-outline: dashed 2px blue;--freetext-line-height: 1.35;--freetext-padding: 2px;--editorInk-editing-cursor: pointer}@media screen and (forced-colors: active){[_nghost-%COMP%]    {--pdfViewer-padding-bottom: 9px;--page-margin: 8px auto -1px;--page-border: 1px solid CanvasText;--page-border-image: none;--spreadHorizontalWrapped-margin-LR: 3.5px}}@media (forced-colors: active){[_nghost-%COMP%]    {--focus-outline: solid 3px ButtonText;--hover-outline: dashed 3px ButtonText}}[_nghost-%COMP%]     .textLayer{position:absolute;text-align:initial;inset:0;overflow:hidden;opacity:.2;line-height:1;-webkit-text-size-adjust:none;text-size-adjust:none;forced-color-adjust:none;transform-origin:0 0}[_nghost-%COMP%]     .textLayer span, [_nghost-%COMP%]     .textLayer br{color:transparent;position:absolute;white-space:pre;cursor:text;transform-origin:0% 0%}[_nghost-%COMP%]     .textLayer span.markedContent{top:0;height:0}[_nghost-%COMP%]     .textLayer .highlight{margin:-1px;padding:1px;background-color:#b400aa;border-radius:4px}[_nghost-%COMP%]     .textLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .textLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .textLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .textLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .textLayer .highlight.selected{background-color:#006400}[_nghost-%COMP%]     .textLayer ::selection{background:rgb(0,0,255)}[_nghost-%COMP%]     .textLayer br::selection{background:transparent}[_nghost-%COMP%]     .textLayer .endOfContent{display:block;position:absolute;inset:100% 0 0;z-index:-1;cursor:default;-webkit-user-select:none;user-select:none}[_nghost-%COMP%]     .textLayer .endOfContent.active{top:0}@media (forced-colors: active){[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:required, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:required, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:required{outline:1.5px solid selectedItem}}[_nghost-%COMP%]     .annotationLayer{position:absolute;top:0;left:0;pointer-events:none;transform-origin:0 0}[_nghost-%COMP%]     .annotationLayer section{position:absolute;text-align:initial;pointer-events:auto;box-sizing:border-box;transform-origin:0 0}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a{position:absolute;font-size:1em;top:0;left:0;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>canvas{width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .linkAnnotation>a:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.pushButton>a:hover{opacity:.2;background:rgb(255,255,0);box-shadow:0 2px 10px #ff0}[_nghost-%COMP%]     .annotationLayer .textAnnotation img{position:absolute;cursor:pointer;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{background-image:var(--annotation-unfocused-field-background);border:1px solid transparent;box-sizing:border-box;font:calc(9px * var(--scale-factor)) sans-serif;height:100%;margin:0;vertical-align:top;width:100%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:required, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:required, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:required, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:required{outline:1.5px solid red}[_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select option{padding:0}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{border-radius:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea{resize:none}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input[disabled], [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea[disabled], [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input[disabled], [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input[disabled]{background:none;border:1px solid transparent;cursor:not-allowed}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:hover, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:hover, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:hover, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:hover{border:1px solid rgb(0,0,0)}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input:focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea:focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select:focus{background:none;border:1px solid transparent}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input :focus, [_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation textarea :focus, [_nghost-%COMP%]     .annotationLayer .choiceWidgetAnnotation select :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox :focus, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton :focus{background-image:none;background-color:transparent;outline:auto}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{background-color:CanvasText;content:"";display:block;position:absolute}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{height:80%;left:45%;width:1px}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:before{transform:rotate(45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input:checked:after{transform:rotate(-45deg)}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input:checked:before{border-radius:50%;height:50%;left:30%;top:20%;width:50%}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb{font-family:monospace;padding-left:2px;padding-right:0}[_nghost-%COMP%]     .annotationLayer .textWidgetAnnotation input.comb:focus{width:103%}[_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.checkBox input, [_nghost-%COMP%]     .annotationLayer .buttonWidgetAnnotation.radioButton input{-webkit-appearance:none;appearance:none}[_nghost-%COMP%]     .annotationLayer .popupTriggerArea{height:100%;width:100%}[_nghost-%COMP%]     .annotationLayer .popupWrapper{position:absolute;font-size:calc(9px * var(--scale-factor));width:100%;min-width:calc(180px * var(--scale-factor));pointer-events:none}[_nghost-%COMP%]     .annotationLayer .popup{position:absolute;max-width:calc(180px * var(--scale-factor));background-color:#ff9;box-shadow:0 calc(2px * var(--scale-factor)) calc(5px * var(--scale-factor)) #888;border-radius:calc(2px * var(--scale-factor));padding:calc(6px * var(--scale-factor));margin-left:calc(5px * var(--scale-factor));cursor:pointer;font:message-box;white-space:normal;word-wrap:break-word;pointer-events:auto}[_nghost-%COMP%]     .annotationLayer .popup>*{font-size:calc(9px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .popup h1{display:inline-block}[_nghost-%COMP%]     .annotationLayer .popupDate{display:inline-block;margin-left:calc(5px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .popupContent{border-top:1px solid rgb(51,51,51);margin-top:calc(2px * var(--scale-factor));padding-top:calc(2px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .richText>*{white-space:pre-wrap;font-size:calc(9px * var(--scale-factor))}[_nghost-%COMP%]     .annotationLayer .highlightAnnotation, [_nghost-%COMP%]     .annotationLayer .underlineAnnotation, [_nghost-%COMP%]     .annotationLayer .squigglyAnnotation, [_nghost-%COMP%]     .annotationLayer .strikeoutAnnotation, [_nghost-%COMP%]     .annotationLayer .freeTextAnnotation, [_nghost-%COMP%]     .annotationLayer .lineAnnotation svg line, [_nghost-%COMP%]     .annotationLayer .squareAnnotation svg rect, [_nghost-%COMP%]     .annotationLayer .circleAnnotation svg ellipse, [_nghost-%COMP%]     .annotationLayer .polylineAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .polygonAnnotation svg polygon, [_nghost-%COMP%]     .annotationLayer .caretAnnotation, [_nghost-%COMP%]     .annotationLayer .inkAnnotation svg polyline, [_nghost-%COMP%]     .annotationLayer .stampAnnotation, [_nghost-%COMP%]     .annotationLayer .fileAttachmentAnnotation{cursor:pointer}[_nghost-%COMP%]     .annotationLayer section svg{position:absolute;width:100%;height:100%}[_nghost-%COMP%]     .annotationLayer .annotationTextContent{position:absolute;width:100%;height:100%;opacity:0;color:transparent;-webkit-user-select:none;user-select:none;pointer-events:none}[_nghost-%COMP%]     .annotationLayer .annotationTextContent span{width:100%;display:inline-block}@media (forced-colors: active){[_nghost-%COMP%]     .xfaLayer *:required{outline:1.5px solid selectedItem}}[_nghost-%COMP%]     .xfaLayer .highlight{margin:-1px;padding:1px;background-color:#efcbed;border-radius:4px}[_nghost-%COMP%]     .xfaLayer .highlight.appended{position:initial}[_nghost-%COMP%]     .xfaLayer .highlight.begin{border-radius:4px 0 0 4px}[_nghost-%COMP%]     .xfaLayer .highlight.end{border-radius:0 4px 4px 0}[_nghost-%COMP%]     .xfaLayer .highlight.middle{border-radius:0}[_nghost-%COMP%]     .xfaLayer .highlight.selected{background-color:#cbdfcb}[_nghost-%COMP%]     .xfaLayer ::selection{background:rgb(0,0,255)}[_nghost-%COMP%]     .xfaPage{overflow:hidden;position:relative}[_nghost-%COMP%]     .xfaContentarea{position:absolute}[_nghost-%COMP%]     .xfaPrintOnly{display:none}[_nghost-%COMP%]     .xfaLayer{position:absolute;text-align:initial;top:0;left:0;transform-origin:0 0;line-height:1.2}[_nghost-%COMP%]     .xfaLayer *{color:inherit;font:inherit;font-style:inherit;font-weight:inherit;font-kerning:inherit;letter-spacing:-.01px;text-align:inherit;text-decoration:inherit;box-sizing:border-box;background-color:transparent;padding:0;margin:0;pointer-events:auto;line-height:inherit}[_nghost-%COMP%]     .xfaLayer *:required{outline:1.5px solid red}[_nghost-%COMP%]     .xfaLayer div{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg{pointer-events:none}[_nghost-%COMP%]     .xfaLayer svg *{pointer-events:none}[_nghost-%COMP%]     .xfaLayer a{color:#00f}[_nghost-%COMP%]     .xfaRich li{margin-left:3em}[_nghost-%COMP%]     .xfaFont{color:#000;font-weight:400;font-kerning:none;font-size:10px;font-style:normal;letter-spacing:0;text-decoration:none;vertical-align:0}[_nghost-%COMP%]     .xfaCaption{overflow:hidden;flex:0 0 auto}[_nghost-%COMP%]     .xfaCaptionForCheckButton{overflow:hidden;flex:1 1 auto}[_nghost-%COMP%]     .xfaLabel{height:100%;width:100%}[_nghost-%COMP%]     .xfaLeft{display:flex;flex-direction:row;align-items:center}[_nghost-%COMP%]     .xfaRight{display:flex;flex-direction:row-reverse;align-items:center}[_nghost-%COMP%]     .xfaLeft>.xfaCaption, [_nghost-%COMP%]     .xfaLeft>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaRight>.xfaCaption, [_nghost-%COMP%]     .xfaRight>.xfaCaptionForCheckButton{max-height:100%}[_nghost-%COMP%]     .xfaTop{display:flex;flex-direction:column;align-items:flex-start}[_nghost-%COMP%]     .xfaBottom{display:flex;flex-direction:column-reverse;align-items:flex-start}[_nghost-%COMP%]     .xfaTop>.xfaCaption, [_nghost-%COMP%]     .xfaTop>.xfaCaptionForCheckButton, [_nghost-%COMP%]     .xfaBottom>.xfaCaption, [_nghost-%COMP%]     .xfaBottom>.xfaCaptionForCheckButton{width:100%}[_nghost-%COMP%]     .xfaBorder{background-color:transparent;position:absolute;pointer-events:none}[_nghost-%COMP%]     .xfaWrapped{width:100%;height:100%}[_nghost-%COMP%]     .xfaTextfield:focus, [_nghost-%COMP%]     .xfaSelect:focus{background-image:none;background-color:transparent;outline:auto;outline-offset:-1px}[_nghost-%COMP%]     .xfaCheckbox:focus, [_nghost-%COMP%]     .xfaRadio:focus{outline:auto}[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{height:100%;width:100%;flex:1 1 auto;border:none;resize:none;background-image:var(--xfa-unfocused-field-background)}[_nghost-%COMP%]     .xfaTop>.xfaTextfield, [_nghost-%COMP%]     .xfaTop>.xfaSelect, [_nghost-%COMP%]     .xfaBottom>.xfaTextfield, [_nghost-%COMP%]     .xfaBottom>.xfaSelect{flex:0 1 auto}[_nghost-%COMP%]     .xfaButton{cursor:pointer;width:100%;height:100%;border:none;text-align:center}[_nghost-%COMP%]     .xfaLink{width:100%;height:100%;position:absolute;top:0;left:0}[_nghost-%COMP%]     .xfaCheckbox, [_nghost-%COMP%]     .xfaRadio{width:100%;height:100%;flex:0 0 auto;border:none}[_nghost-%COMP%]     .xfaRich{white-space:pre-wrap;width:100%;height:100%}[_nghost-%COMP%]     .xfaImage{object-position:left top;object-fit:contain;width:100%;height:100%}[_nghost-%COMP%]     .xfaLrTb, [_nghost-%COMP%]     .xfaRlTb, [_nghost-%COMP%]     .xfaTb{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaLr{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaRl{display:flex;flex-direction:row-reverse;align-items:stretch}[_nghost-%COMP%]     .xfaTb>div{justify-content:left}[_nghost-%COMP%]     .xfaPosition{position:relative}[_nghost-%COMP%]     .xfaArea{position:relative}[_nghost-%COMP%]     .xfaValignMiddle{display:flex;align-items:center}[_nghost-%COMP%]     .xfaTable{display:flex;flex-direction:column;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRow{display:flex;flex-direction:row;align-items:stretch}[_nghost-%COMP%]     .xfaTable .xfaRlRow{display:flex;flex-direction:row-reverse;align-items:stretch;flex:1}[_nghost-%COMP%]     .xfaTable .xfaRlRow>div{flex:1}[_nghost-%COMP%]     .xfaNonInteractive input, [_nghost-%COMP%]     .xfaNonInteractive textarea, [_nghost-%COMP%]     .xfaDisabled input, [_nghost-%COMP%]     .xfaDisabled textarea, [_nghost-%COMP%]     .xfaReadOnly input, [_nghost-%COMP%]     .xfaReadOnly textarea{background:initial}@media print{[_nghost-%COMP%]     .xfaTextfield, [_nghost-%COMP%]     .xfaSelect{background:transparent}[_nghost-%COMP%]     .xfaSelect{-webkit-appearance:none;appearance:none;text-indent:1px;text-overflow:""}}[_nghost-%COMP%]     [data-editor-rotation="90"]{transform:rotate(90deg)}[_nghost-%COMP%]     [data-editor-rotation="180"]{transform:rotate(180deg)}[_nghost-%COMP%]     [data-editor-rotation="270"]{transform:rotate(270deg)}[_nghost-%COMP%]     .annotationEditorLayer{background:transparent;position:absolute;top:0;left:0;font-size:calc(100px * var(--scale-factor));transform-origin:0 0}[_nghost-%COMP%]     .annotationEditorLayer .selectedEditor{outline:var(--focus-outline);resize:none}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor{position:absolute;background:transparent;border-radius:3px;padding:calc(var(--freetext-padding) * var(--scale-factor));resize:none;width:auto;height:auto;z-index:1;transform-origin:0 0;touch-action:none}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal{background:transparent;border:none;top:0;left:0;overflow:visible;white-space:nowrap;resize:none;font:10px sans-serif;line-height:var(--freetext-line-height)}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .overlay{position:absolute;display:none;background:transparent;top:0;left:0;width:100%;height:100%}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .overlay.enabled{display:block}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal:empty:before{content:attr(default-content);color:gray}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor .internal:focus{outline:none}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.disabled{resize:none}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.disabled.selectedEditor{resize:horizontal}[_nghost-%COMP%]     .annotationEditorLayer .freeTextEditor:hover:not(.selectedEditor), [_nghost-%COMP%]     .annotationEditorLayer .inkEditor:hover:not(.selectedEditor){outline:var(--hover-outline)}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor{position:absolute;background:transparent;border-radius:3px;overflow:auto;width:100%;height:100%;z-index:1;transform-origin:0 0;cursor:auto}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor.editing{resize:none;cursor:var(--editorInk-editing-cursor),pointer}[_nghost-%COMP%]     .annotationEditorLayer .inkEditor .inkEditorCanvas{position:absolute;top:0;left:0;width:100%;height:100%;touch-action:none}[_nghost-%COMP%]     [data-main-rotation="90"]{transform:rotate(90deg) translateY(-100%)}[_nghost-%COMP%]     [data-main-rotation="180"]{transform:rotate(180deg) translate(-100%,-100%)}[_nghost-%COMP%]     [data-main-rotation="270"]{transform:rotate(270deg) translate(-100%)}[_nghost-%COMP%]     .pdfViewer{padding-bottom:var(--pdfViewer-padding-bottom)}[_nghost-%COMP%]     .pdfViewer .canvasWrapper{overflow:hidden}[_nghost-%COMP%]     .pdfViewer .page{direction:ltr;width:816px;height:1056px;margin:var(--page-margin);position:relative;overflow:visible;border:var(--page-border);border-image:var(--page-border-image);background-clip:content-box;background-color:#fff}[_nghost-%COMP%]     .pdfViewer .dummyPage{position:relative;width:0;height:var(--viewer-container-height)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .page{margin:0 auto 10px;border:none}[_nghost-%COMP%]     .pdfViewer.singlePageView{display:inline-block}[_nghost-%COMP%]     .pdfViewer.singlePageView .page{margin:0;border:none}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .pdfViewer.scrollWrapped, [_nghost-%COMP%]     .spread{margin-left:3.5px;margin-right:3.5px;text-align:center}[_nghost-%COMP%]     .pdfViewer.scrollHorizontal, [_nghost-%COMP%]     .spread{white-space:nowrap}[_nghost-%COMP%]     .pdfViewer.removePageBorders, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{margin-left:0;margin-right:0}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .spread .dummyPage, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .spread, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .spread{display:inline-block;vertical-align:middle}[_nghost-%COMP%]     .spread .page, [_nghost-%COMP%]     .pdfViewer.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.scrollWrapped .page{margin-left:var(--spreadHorizontalWrapped-margin-LR);margin-right:var(--spreadHorizontalWrapped-margin-LR)}[_nghost-%COMP%]     .pdfViewer.removePageBorders .spread .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollHorizontal .page, [_nghost-%COMP%]     .pdfViewer.removePageBorders.scrollWrapped .page{margin-left:5px;margin-right:5px}[_nghost-%COMP%]     .pdfViewer .page canvas{margin:0;display:block}[_nghost-%COMP%]     .pdfViewer .page canvas[hidden]{display:none}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon{position:absolute;display:block;inset:0;background:url(data:image/gif;base64,R0lGODlhGAAYAPQQAM7Ozvr6+uDg4LCwsOjo6I6OjsjIyJycnNjY2KioqMDAwPLy8nZ2doaGhri4uGhoaP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/ilPcHRpbWl6ZWQgd2l0aCBodHRwczovL2V6Z2lmLmNvbS9vcHRpbWl6ZQAh+QQJBwAQACwAAAAAGAAYAAAFmiAkjiTkOGVaBgjZNGSgkgKjjM8zLoI8iy+BKCdiCX8iBeMAhEEIPRXLxViYUE9CbCQoFAzFhHY3zkaT3oPvBz1zE4UBsr1eWZH4vAowOBwGAHk8AoQLfH6Agm0Ed3qOAXWOIgQKiWyFJQgDgJEpdG+WEACNEFNFmKVlVzJQk6qdkwqBoi1mebJ3ALNGeIZHtGSwNDS1RZKueCEAIfkECQcAEAAsAAAAABgAGAAABZcgJI4kpChlWgYCWRQkEKgjURgjw4zOg9CjVwuiEyEeO6CxkBC9nA+HiuUqLEyoBZI0Mx4SAFFgQCDZuguBoGv6Dtg0gvpqdhxQQDkBzuUr/4A1JwMKP39pc2mDhYCIc4GQYn6QCwCMeY91l0p6dBAEJ0OfcFRimZ91Mwt0alxxAIZyRmuAsKxDLKKvZbM1tJxmvGKRpn8hACH5BAkHABAALAAAAAAYABgAAAWhICSOJGQYZVoGAnkcJBKoI3EAY1GMCtPSosSBINKJBIwGkHdwBGGQA0OhYpEGQxNqkYzNIITBACEKKBaxxNfBeOCO4vMy0Hg8nDHFeCktkKtfNAtoS4UqAicKBj9zBAKPC4iKi4aRkISGmWWBmjUIAIyHkCUEAKCVo2WmREecVqoCgZhgP4NHrGWCj7e3szSpuxAsoVWxnp6cVV4kyZW+KSEAIfkECQcAEAAsAAAAABgAGAAABZkgJI4kBABlWgYEOQykEKgjMSDjcYxG0dKi108nEhQKQN4rCIMkCgbawjWYnSCLY2yGVSgEooBhWqsGGwxc0RtNBgoMhmJ1QgETjANYFeBKyUmBKQQIdT9JDmgPDQ6EhoKJD4sOgpWWgiwChyqEBH5hmptSoSOZgJ4kLKWkYTF7C2SaqaM/hEWygay4mYG8t6uffFuzl1iANCEAIfkECQcAEAAsAAAAABgAGAAABZ0gJI4khCBlmhKkopBCoI6LIozDMAIHO4uuBVBnOiR+I4FrCDwAZsKdQnaCLIwwmRUA8JmioprWUCjcwlwUMnAoG0qL03k2KCS8cC0UjOzDCQKBfHQFDAwFU4CCfgqFhy9+kZJWgzSKSAcPZn+BfQENDw8OljGWJAFeDoZPYTBnC1GdSXqnsoBolSulX2GyP6hgvnG0KrS3NJNhuSQhACH5BAkHABAALAAAAAAYABgAAAWaICSOJCQIZZoupGGQRKCOC0CMijIiwz2LABtQZxoMfjQhxAXszWQ7gOwECRhh0MCJJRJARTUoIHFAgbfI6uBwAJS01J/i4PClVYHvfV8lbLlIBmwFbQt+aGmChG18jXeGT4dICQxlb4g/AQUMDER9XjR6BAdiDQwINDBmkAsPDVh4cX4imw53iLKuaVqAcUsPqEiidkt6j4AzIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiREEGWaBiSCtCoZCMsIAKOg1LEo0KKbaKFQ9EYLoOkFuQlirNxzCQkUW9GZ0hQd4nyDAWr4G/esYSbyZFYZwu3jqiuvr8u8I2BwOAwASXh1e31/doeHC3klWnElfAlTd46MfQUGk2stCVEGBQWSdCciDg5VDAVYKoEiDQ0iBwxGcj9RDw8+qHIzebc2DJJQJK6qiKVyIQAh+QQJBwAQACwAAAAAGAAYAAAFmSAkjiS0LGWaBiRBtCoZCKgoCCMB1DF0sz6cCQDo5W62l28XAyZFpyECBv3lnCbhUqHMIo0Qg4Jbmn1jRCa4iV27TzfXGjEecOFWMN1OdvvfPGUuXSoKBw6EXokrAwcHRVU0UAeEBANAAAmUI1gNDyhjJgUHLW0iDg8FIqOnBQZrDA9TELE2rEYIDw4jta2LMpCrqld/YQpgIQAh+QQJBwAQACwAAAAAGAAYAAAFmyAkjiS0LGWaBiRBkKw6BgIqCsJcyyMe4yJajhcEml5H26o1PN2QQd3uFiv2AADlAgflIbDdZLgkABOJgep5LfWty4p4zeU+w+XsvJWXliEKDwdEBgMKYQ4PDw1qK3EDCCMAiQ5BCV0LCj+FSDQkgCgGBiYHAy2MIgoMghAHqw4HAGsNDEMFBTekdgwKI7aRB2MwkL2rVHoQoWchACH5BAkHABAALAAAAAAYABgAAAWWICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkfbqjU83ZBB3e4WK0qrCxyU55peid0qcUwuixyNx6PhILsAcAJazXYj4lvz2MkLiFsHDAlEcABKZwwMBX8pBgoKQxAIigpBA1sLBj+PSDQkB4uSACYDlTMyBgWDEKVnl2QFBUigN61gBQYjtLV5JZ4jtlR6omMhACH5BAkHABAALAAAAAAYABgAAAWaICSOJLQsZZoGJEGQrDoGAioKwlzLIx7jIlqOFwSaXkdbidYanm7I4AjwYDh6saJuJ3JUG1mZi9srPA7EcRimJLrfJYWZUVC8TziXnEG3u/E+cIJaPAFrPQl1aQAIbRAGBZGHJQiMUQKRBkEKbQsAPZaEXQcslSYKmjMyAAdXj34ACkNEiUgDA5t+PAQHn6Ogjkuzry2DNwhuIQAh+QQFBwAQACwAAAAAGAAYAAAFnCAkjiS0LGVaBgBJEGSguo8zCsK4CPIsMg+ECCcKEH0ix6MwhJl4KiOp8UCdmrEbo6EoHpxF8A6aBBZ6vhf5dmAkkGr0CoWs21WGQ2FvsI9xC3l7B311fy93iWGKJQQOhHCAJQB6A3IqcWwJLU90i2FkUiMKlhBELEI6MwgDXRAGhQgAYD6tTqRFAJxpA6mvrqazSKJJhUWMpjlIIQA7) center no-repeat}[_nghost-%COMP%]     .pdfViewer .page .loadingIcon.notVisible{background:none}[_nghost-%COMP%]     .pdfViewer.enablePermissions .textLayer span{-webkit-user-select:none!important;user-select:none!important;cursor:not-allowed}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer{padding-bottom:0}[_nghost-%COMP%]     .pdfPresentationMode .spread{margin:0}[_nghost-%COMP%]     .pdfPresentationMode .pdfViewer .page{margin:0 auto;border:2px solid transparent}']}));const Sg=class{};let Ra=Sg;R(Ra,"\u0275fac",function(e){return new(e||Sg)}),R(Ra,"\u0275mod",nt.oAB({type:Sg})),R(Ra,"\u0275inj",nt.cJS({}))}}]);